(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,67034,(e,t,r)=>{var n={675:function(e,t){"use strict";t.byteLength=function(e){var t=l(e),r=t[0],n=t[1];return(r+n)*3/4-n},t.toByteArray=function(e){var t,r,s=l(e),a=s[0],o=s[1],u=new i((a+o)*3/4-o),h=0,c=o>0?a-4:a;for(r=0;r<c;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],u[h++]=t>>16&255,u[h++]=t>>8&255,u[h++]=255&t;return 2===o&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,u[h++]=255&t),1===o&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,u[h++]=t>>8&255,u[h++]=255&t),u},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,s=[],a=0,o=n-i;a<o;a+=16383)s.push(function(e,t,n){for(var i,s=[],a=t;a<n;a+=3)i=(e[a]<<16&0xff0000)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(r[i>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return s.join("")}(e,a,a+16383>o?o:a+16383));return 1===i?s.push(r[(t=e[n-1])>>2]+r[t<<4&63]+"=="):2===i&&s.push(r[(t=(e[n-2]<<8)+e[n-1])>>10]+r[t>>4&63]+r[t<<2&63]+"="),s.join("")};for(var r=[],n=[],i="u">typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,o=s.length;a<o;++a)r[a]=s[a],n[s.charCodeAt(a)]=a;function l(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");-1===r&&(r=t);var n=r===t?0:4-r%4;return[r,n]}n[45]=62,n[95]=63},72:function(e,t,r){"use strict";var n=r(675),i=r(783),s="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function a(e){if(e>0x7fffffff)throw RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,o.prototype),t}function o(e,t,r){if("number"==typeof e){if("string"==typeof t)throw TypeError('The "string" argument must be of type string. Received type number');return h(e)}return l(e,t,r)}function l(e,t,r){if("string"==typeof e){var n=e,i=t;if(("string"!=typeof i||""===i)&&(i="utf8"),!o.isEncoding(i))throw TypeError("Unknown encoding: "+i);var s=0|f(n,i),l=a(s),u=l.write(n,i);return u!==s&&(l=l.slice(0,u)),l}if(ArrayBuffer.isView(e))return c(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(A(e,ArrayBuffer)||e&&A(e.buffer,ArrayBuffer)||"u">typeof SharedArrayBuffer&&(A(e,SharedArrayBuffer)||e&&A(e.buffer,SharedArrayBuffer)))return function(e,t,r){var n;if(t<0||e.byteLength<t)throw RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),o.prototype),n}(e,t,r);if("number"==typeof e)throw TypeError('The "value" argument must not be of type number. Received type number');var h=e.valueOf&&e.valueOf();if(null!=h&&h!==e)return o.from(h,t,r);var p=function(e){if(o.isBuffer(e)){var t=0|d(e.length),r=a(t);return 0===r.length||e.copy(r,0,0,t),r}return void 0!==e.length?"number"!=typeof e.length||function(e){return e!=e}(e.length)?a(0):c(e):"Buffer"===e.type&&Array.isArray(e.data)?c(e.data):void 0}(e);if(p)return p;if("u">typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return o.from(e[Symbol.toPrimitive]("string"),t,r);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function u(e){if("number"!=typeof e)throw TypeError('"size" argument must be of type number');if(e<0)throw RangeError('The value "'+e+'" is invalid for option "size"')}function h(e){return u(e),a(e<0?0:0|d(e))}function c(e){for(var t=e.length<0?0:0|d(e.length),r=a(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}t.Buffer=o,t.SlowBuffer=function(e){return+e!=e&&(e=0),o.alloc(+e)},t.INSPECT_MAX_BYTES=50,t.kMaxLength=0x7fffffff,o.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),!o.TYPED_ARRAY_SUPPORT&&"u">typeof console&&"function"==typeof console.error&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}}),o.poolSize=8192,o.from=function(e,t,r){return l(e,t,r)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array),o.alloc=function(e,t,r){return(u(e),e<=0)?a(e):void 0!==t?"string"==typeof r?a(e).fill(t,r):a(e).fill(t):a(e)},o.allocUnsafe=function(e){return h(e)},o.allocUnsafeSlow=function(e){return h(e)};function d(e){if(e>=0x7fffffff)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|e}function f(e,t){if(o.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||A(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return S(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return k(e).length;default:if(i)return n?-1:S(e).length;t=(""+t).toLowerCase(),i=!0}}function p(e,t,r){var i,s,a,o=!1;if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===r||r>this.length)&&(r=this.length),r<=0||(r>>>=0)<=(t>>>=0)))return"";for(e||(e="utf8");;)switch(e){case"hex":return function(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",s=t;s<r;++s)i+=D[e[s]];return i}(this,t,r);case"utf8":case"utf-8":return v(this,t,r);case"ascii":return function(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}(this,t,r);case"latin1":case"binary":return function(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}(this,t,r);case"base64":return i=this,s=t,a=r,0===s&&a===i.length?n.fromByteArray(i):n.fromByteArray(i.slice(s,a));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,t,r){for(var n=e.slice(t,r),i="",s=0;s<n.length;s+=2)i+=String.fromCharCode(n[s]+256*n[s+1]);return i}(this,t,r);default:if(o)throw TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),o=!0}}function m(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function g(e,t,r,n,i){var s;if(0===e.length)return -1;if("string"==typeof r?(n=r,r=0):r>0x7fffffff?r=0x7fffffff:r<-0x80000000&&(r=-0x80000000),(s=r*=1)!=s&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length)if(i)return -1;else r=e.length-1;else if(r<0)if(!i)return -1;else r=0;if("string"==typeof t&&(t=o.from(t,n)),o.isBuffer(t))return 0===t.length?-1:y(e,t,r,n,i);if("number"==typeof t){if(t&=255,"function"==typeof Uint8Array.prototype.indexOf)if(i)return Uint8Array.prototype.indexOf.call(e,t,r);else return Uint8Array.prototype.lastIndexOf.call(e,t,r);return y(e,[t],r,n,i)}throw TypeError("val must be string, number or Buffer")}function y(e,t,r,n,i){var s,a=1,o=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return -1;a=2,o/=2,l/=2,r/=2}function u(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var h=-1;for(s=r;s<o;s++)if(u(e,s)===u(t,-1===h?0:s-h)){if(-1===h&&(h=s),s-h+1===l)return h*a}else -1!==h&&(s-=s-h),h=-1}else for(r+l>o&&(r=o-l),s=r;s>=0;s--){for(var c=!0,d=0;d<l;d++)if(u(e,s+d)!==u(t,d)){c=!1;break}if(c)return s}return -1}o.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==o.prototype},o.compare=function(e,t){if(A(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),A(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),!o.isBuffer(e)||!o.isBuffer(t))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,n=t.length,i=0,s=Math.min(r,n);i<s;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:+(n<r)},o.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(e,t){if(!Array.isArray(e))throw TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return o.alloc(0);if(void 0===t)for(r=0,t=0;r<e.length;++r)t+=e[r].length;var r,n=o.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var s=e[r];if(A(s,Uint8Array)&&(s=o.from(s)),!o.isBuffer(s))throw TypeError('"list" argument must be an Array of Buffers');s.copy(n,i),i+=s.length}return n},o.byteLength=f,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},o.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},o.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},o.prototype.toString=function(){var e=this.length;return 0===e?"":0==arguments.length?v(this,0,e):p.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(e){if(!o.isBuffer(e))throw TypeError("Argument must be a Buffer");return this===e||0===o.compare(this,e)},o.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},s&&(o.prototype[s]=o.prototype.inspect),o.prototype.compare=function(e,t,r,n,i){if(A(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),!o.isBuffer(e))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return -1;if(t>=r)return 1;if(t>>>=0,r>>>=0,n>>>=0,i>>>=0,this===e)return 0;for(var s=i-n,a=r-t,l=Math.min(s,a),u=this.slice(n,i),h=e.slice(t,r),c=0;c<l;++c)if(u[c]!==h[c]){s=u[c],a=h[c];break}return s<a?-1:+(a<s)},o.prototype.includes=function(e,t,r){return -1!==this.indexOf(e,t,r)},o.prototype.indexOf=function(e,t,r){return g(this,e,t,r,!0)},o.prototype.lastIndexOf=function(e,t,r){return g(this,e,t,r,!1)};function v(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var s,a,o,l,u=e[i],h=null,c=u>239?4:u>223?3:u>191?2:1;if(i+c<=r)switch(c){case 1:u<128&&(h=u);break;case 2:(192&(s=e[i+1]))==128&&(l=(31&u)<<6|63&s)>127&&(h=l);break;case 3:s=e[i+1],a=e[i+2],(192&s)==128&&(192&a)==128&&(l=(15&u)<<12|(63&s)<<6|63&a)>2047&&(l<55296||l>57343)&&(h=l);break;case 4:s=e[i+1],a=e[i+2],o=e[i+3],(192&s)==128&&(192&a)==128&&(192&o)==128&&(l=(15&u)<<18|(63&s)<<12|(63&a)<<6|63&o)>65535&&l<1114112&&(h=l)}null===h?(h=65533,c=1):h>65535&&(h-=65536,n.push(h>>>10&1023|55296),h=56320|1023&h),n.push(h),i+=c}var d=n,f=d.length;if(f<=4096)return String.fromCharCode.apply(String,d);for(var p="",m=0;m<f;)p+=String.fromCharCode.apply(String,d.slice(m,m+=4096));return p}function w(e,t,r){if(e%1!=0||e<0)throw RangeError("offset is not uint");if(e+t>r)throw RangeError("Trying to access beyond buffer length")}function b(e,t,r,n,i,s){if(!o.isBuffer(e))throw TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<s)throw RangeError('"value" argument is out of bounds');if(r+n>e.length)throw RangeError("Index out of range")}function x(e,t,r,n,i,s){if(r+n>e.length||r<0)throw RangeError("Index out of range")}function I(e,t,r,n,s){return t*=1,r>>>=0,s||x(e,t,r,4,34028234663852886e22,-34028234663852886e22),i.write(e,t,r,n,23,4),r+4}function T(e,t,r,n,s){return t*=1,r>>>=0,s||x(e,t,r,8,17976931348623157e292,-17976931348623157e292),i.write(e,t,r,n,52,8),r+8}o.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else if(isFinite(t))t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var i,s,a,o,l,u,h,c,d=this.length-t;if((void 0===r||r>d)&&(r=d),e.length>0&&(r<0||t<0)||t>this.length)throw RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var f=!1;;)switch(n){case"hex":return function(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var s=t.length;n>s/2&&(n=s/2);for(var a=0;a<n;++a){var o,l=parseInt(t.substr(2*a,2),16);if((o=l)!=o)break;e[r+a]=l}return a}(this,e,t,r);case"utf8":case"utf-8":return i=t,s=r,C(S(e,this.length-i),this,i,s);case"ascii":return a=t,o=r,C(_(e),this,a,o);case"latin1":case"binary":return function(e,t,r,n){return C(_(t),e,r,n)}(this,e,t,r);case"base64":return l=t,u=r,C(k(e),this,l,u);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return h=t,c=r,C(function(e,t){for(var r,n,i=[],s=0;s<e.length&&!((t-=2)<0);++s)n=(r=e.charCodeAt(s))>>8,i.push(r%256),i.push(n);return i}(e,this.length-h),this,h,c);default:if(f)throw TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),f=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},o.prototype.slice=function(e,t){var r=this.length;e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n=this.subarray(e,t);return Object.setPrototypeOf(n,o.prototype),n},o.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||w(e,t,this.length);for(var n=this[e],i=1,s=0;++s<t&&(i*=256);)n+=this[e+s]*i;return n},o.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||w(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},o.prototype.readUInt8=function(e,t){return e>>>=0,t||w(e,1,this.length),this[e]},o.prototype.readUInt16LE=function(e,t){return e>>>=0,t||w(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUInt16BE=function(e,t){return e>>>=0,t||w(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUInt32LE=function(e,t){return e>>>=0,t||w(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+0x1000000*this[e+3]},o.prototype.readUInt32BE=function(e,t){return e>>>=0,t||w(e,4,this.length),0x1000000*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||w(e,t,this.length);for(var n=this[e],i=1,s=0;++s<t&&(i*=256);)n+=this[e+s]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},o.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||w(e,t,this.length);for(var n=t,i=1,s=this[e+--n];n>0&&(i*=256);)s+=this[e+--n]*i;return s>=(i*=128)&&(s-=Math.pow(2,8*t)),s},o.prototype.readInt8=function(e,t){return(e>>>=0,t||w(e,1,this.length),128&this[e])?-((255-this[e]+1)*1):this[e]},o.prototype.readInt16LE=function(e,t){e>>>=0,t||w(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?0xffff0000|r:r},o.prototype.readInt16BE=function(e,t){e>>>=0,t||w(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?0xffff0000|r:r},o.prototype.readInt32LE=function(e,t){return e>>>=0,t||w(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return e>>>=0,t||w(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readFloatLE=function(e,t){return e>>>=0,t||w(e,4,this.length),i.read(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return e>>>=0,t||w(e,4,this.length),i.read(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return e>>>=0,t||w(e,8,this.length),i.read(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return e>>>=0,t||w(e,8,this.length),i.read(this,e,!1,52,8)},o.prototype.writeUIntLE=function(e,t,r,n){if(e*=1,t>>>=0,r>>>=0,!n){var i=Math.pow(2,8*r)-1;b(this,e,t,r,i,0)}var s=1,a=0;for(this[t]=255&e;++a<r&&(s*=256);)this[t+a]=e/s&255;return t+r},o.prototype.writeUIntBE=function(e,t,r,n){if(e*=1,t>>>=0,r>>>=0,!n){var i=Math.pow(2,8*r)-1;b(this,e,t,r,i,0)}var s=r-1,a=1;for(this[t+s]=255&e;--s>=0&&(a*=256);)this[t+s]=e/a&255;return t+r},o.prototype.writeUInt8=function(e,t,r){return e*=1,t>>>=0,r||b(this,e,t,1,255,0),this[t]=255&e,t+1},o.prototype.writeUInt16LE=function(e,t,r){return e*=1,t>>>=0,r||b(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},o.prototype.writeUInt16BE=function(e,t,r){return e*=1,t>>>=0,r||b(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},o.prototype.writeUInt32LE=function(e,t,r){return e*=1,t>>>=0,r||b(this,e,t,4,0xffffffff,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},o.prototype.writeUInt32BE=function(e,t,r){return e*=1,t>>>=0,r||b(this,e,t,4,0xffffffff,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},o.prototype.writeIntLE=function(e,t,r,n){if(e*=1,t>>>=0,!n){var i=Math.pow(2,8*r-1);b(this,e,t,r,i-1,-i)}var s=0,a=1,o=0;for(this[t]=255&e;++s<r&&(a*=256);)e<0&&0===o&&0!==this[t+s-1]&&(o=1),this[t+s]=(e/a|0)-o&255;return t+r},o.prototype.writeIntBE=function(e,t,r,n){if(e*=1,t>>>=0,!n){var i=Math.pow(2,8*r-1);b(this,e,t,r,i-1,-i)}var s=r-1,a=1,o=0;for(this[t+s]=255&e;--s>=0&&(a*=256);)e<0&&0===o&&0!==this[t+s+1]&&(o=1),this[t+s]=(e/a|0)-o&255;return t+r},o.prototype.writeInt8=function(e,t,r){return e*=1,t>>>=0,r||b(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},o.prototype.writeInt16LE=function(e,t,r){return e*=1,t>>>=0,r||b(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},o.prototype.writeInt16BE=function(e,t,r){return e*=1,t>>>=0,r||b(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},o.prototype.writeInt32LE=function(e,t,r){return e*=1,t>>>=0,r||b(this,e,t,4,0x7fffffff,-0x80000000),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},o.prototype.writeInt32BE=function(e,t,r){return e*=1,t>>>=0,r||b(this,e,t,4,0x7fffffff,-0x80000000),e<0&&(e=0xffffffff+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},o.prototype.writeFloatLE=function(e,t,r){return I(this,e,t,!0,r)},o.prototype.writeFloatBE=function(e,t,r){return I(this,e,t,!1,r)},o.prototype.writeDoubleLE=function(e,t,r){return T(this,e,t,!0,r)},o.prototype.writeDoubleBE=function(e,t,r){return T(this,e,t,!1,r)},o.prototype.copy=function(e,t,r,n){if(!o.isBuffer(e))throw TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r||0===e.length||0===this.length)return 0;if(t<0)throw RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw RangeError("Index out of range");if(n<0)throw RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i=n-r;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,r,n);else if(this===e&&r<t&&t<n)for(var s=i-1;s>=0;--s)e[s+t]=this[s+r];else Uint8Array.prototype.set.call(e,this.subarray(r,n),t);return i},o.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw TypeError("encoding must be a string");if("string"==typeof n&&!o.isEncoding(n))throw TypeError("Unknown encoding: "+n);if(1===e.length){var i,s=e.charCodeAt(0);("utf8"===n&&s<128||"latin1"===n)&&(e=s)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw RangeError("Out of range index");if(r<=t)return this;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{var a=o.isBuffer(e)?e:o.from(e,n),l=a.length;if(0===l)throw TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-t;++i)this[i+t]=a[i%l]}return this};var E=/[^+/0-9A-Za-z-_]/g;function S(e,t){t=t||1/0;for(var r,n=e.length,i=null,s=[],a=0;a<n;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!i){if(r>56319||a+1===n){(t-=3)>-1&&s.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&s.push(239,191,189),i=r;continue}r=(i-55296<<10|r-56320)+65536}else i&&(t-=3)>-1&&s.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;s.push(r)}else if(r<2048){if((t-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else if(r<1114112){if((t-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}else throw Error("Invalid code point")}return s}function _(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}function k(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(E,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function C(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length)&&!(i>=e.length);++i)t[i+r]=e[i];return i}function A(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}var D=function(){for(var e="0123456789abcdef",t=Array(256),r=0;r<16;++r)for(var n=16*r,i=0;i<16;++i)t[n+i]=e[r]+e[i];return t}()},783:function(e,t){t.read=function(e,t,r,n,i){var s,a,o=8*i-n-1,l=(1<<o)-1,u=l>>1,h=-7,c=r?i-1:0,d=r?-1:1,f=e[t+c];for(c+=d,s=f&(1<<-h)-1,f>>=-h,h+=o;h>0;s=256*s+e[t+c],c+=d,h-=8);for(a=s&(1<<-h)-1,s>>=-h,h+=n;h>0;a=256*a+e[t+c],c+=d,h-=8);if(0===s)s=1-u;else{if(s===l)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,n),s-=u}return(f?-1:1)*a*Math.pow(2,s-n)},t.write=function(e,t,r,n,i,s){var a,o,l,u=8*s-i-1,h=(1<<u)-1,c=h>>1,d=5960464477539062e-23*(23===i),f=n?0:s-1,p=n?1:-1,m=+(t<0||0===t&&1/t<0);for(isNaN(t=Math.abs(t))||t===1/0?(o=+!!isNaN(t),a=h):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),a+c>=1?t+=d/l:t+=d*Math.pow(2,1-c),t*l>=2&&(a++,l/=2),a+c>=h?(o=0,a=h):a+c>=1?(o=(t*l-1)*Math.pow(2,i),a+=c):(o=t*Math.pow(2,c-1)*Math.pow(2,i),a=0));i>=8;e[r+f]=255&o,f+=p,o/=256,i-=8);for(a=a<<i|o,u+=i;u>0;e[r+f]=255&a,f+=p,a/=256,u-=8);e[r+f-p]|=128*m}}},i={};function s(e){var t=i[e];if(void 0!==t)return t.exports;var r=i[e]={exports:{}},a=!0;try{n[e](r,r.exports,s),a=!1}finally{a&&delete i[e]}return r.exports}s.ab="/ROOT/node_modules/next/dist/compiled/buffer/",t.exports=s(72)},52683,e=>{"use strict";let t,r,n,i,s,a,o,l,u,h;var c,d,f,p,m,g,y,v,w,b,x,I,T,E,S,_,k,C,A=e.i(43476),D=e.i(71645),N=e.i(47167);let P=(0,D.createContext)({});function R(e){let t=(0,D.useRef)(null);return null===t.current&&(t.current=e()),t.current}let M="u">typeof window,O=M?D.useLayoutEffect:D.useEffect,L=(0,D.createContext)(null);function V(e){return"object"==typeof e&&null!==e}function F(e){return V(e)&&"offsetHeight"in e}var j=D;let U=(0,D.createContext)({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});function B(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}class z extends j.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=t.offsetParent,r=F(e)&&e.offsetWidth||0,n=F(e)&&e.offsetHeight||0,i=this.props.sizeRef.current;i.height=t.offsetHeight||0,i.width=t.offsetWidth||0,i.top=t.offsetTop,i.left=t.offsetLeft,i.right=r-i.width-i.left,i.bottom=n-i.height-i.top}return null}componentDidUpdate(){}render(){return this.props.children}}function q({children:e,isPresent:t,anchorX:r,anchorY:n,root:i}){let s=(0,j.useId)(),a=(0,j.useRef)(null),o=(0,j.useRef)({width:0,height:0,top:0,left:0,right:0,bottom:0}),{nonce:l}=(0,j.useContext)(U),u=function(...e){return D.useCallback(function(...e){return t=>{let r=!1,n=e.map(e=>{let n=B(e,t);return r||"function"!=typeof n||(r=!0),n});if(r)return()=>{for(let t=0;t<n.length;t++){let r=n[t];"function"==typeof r?r():B(e[t],null)}}}}(...e),e)}(a,e.props?.ref??e?.ref);return(0,j.useInsertionEffect)(()=>{let{width:e,height:u,top:h,left:c,right:d,bottom:f}=o.current;if(t||!a.current||!e||!u)return;let p="left"===r?`left: ${c}`:`right: ${d}`,m="bottom"===n?`bottom: ${f}`:`top: ${h}`;a.current.dataset.motionPopId=s;let g=document.createElement("style");l&&(g.nonce=l);let y=i??document.head;return y.appendChild(g),g.sheet&&g.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${u}px !important;
            ${p}px !important;
            ${m}px !important;
          }
        `),()=>{y.contains(g)&&y.removeChild(g)}},[t]),(0,A.jsx)(z,{isPresent:t,childRef:a,sizeRef:o,children:j.cloneElement(e,{ref:u})})}let $=({children:e,initial:t,isPresent:r,onExitComplete:n,custom:i,presenceAffectsLayout:s,mode:a,anchorX:o,anchorY:l,root:u})=>{let h=R(G),c=(0,D.useId)(),d=!0,f=(0,D.useMemo)(()=>(d=!1,{id:c,initial:t,isPresent:r,custom:i,onExitComplete:e=>{for(let t of(h.set(e,!0),h.values()))if(!t)return;n&&n()},register:e=>(h.set(e,!1),()=>h.delete(e))}),[r,h,n]);return s&&d&&(f={...f}),(0,D.useMemo)(()=>{h.forEach((e,t)=>h.set(t,!1))},[r]),D.useEffect(()=>{r||h.size||!n||n()},[r]),"popLayout"===a&&(e=(0,A.jsx)(q,{isPresent:r,anchorX:o,anchorY:l,root:u,children:e})),(0,A.jsx)(L.Provider,{value:f,children:e})};function G(){return new Map}function K(e=!0){let t=(0,D.useContext)(L);if(null===t)return[!0,null];let{isPresent:r,onExitComplete:n,register:i}=t,s=(0,D.useId)();(0,D.useEffect)(()=>{if(e)return i(s)},[e]);let a=(0,D.useCallback)(()=>e&&n&&n(s),[s,n,e]);return!r&&n?[!1,a]:[!0]}let H=e=>e.key||"";function W(e){let t=[];return D.Children.forEach(e,e=>{(0,D.isValidElement)(e)&&t.push(e)}),t}let Q=({children:e,custom:t,initial:r=!0,onExitComplete:n,presenceAffectsLayout:i=!0,mode:s="sync",propagate:a=!1,anchorX:o="left",anchorY:l="top",root:u})=>{let[h,c]=K(a),d=(0,D.useMemo)(()=>W(e),[e]),f=a&&!h?[]:d.map(H),p=(0,D.useRef)(!0),m=(0,D.useRef)(d),g=R(()=>new Map),y=(0,D.useRef)(new Set),[v,w]=(0,D.useState)(d),[b,x]=(0,D.useState)(d);O(()=>{p.current=!1,m.current=d;for(let e=0;e<b.length;e++){let t=H(b[e]);f.includes(t)?(g.delete(t),y.current.delete(t)):!0!==g.get(t)&&g.set(t,!1)}},[b,f.length,f.join("-")]);let I=[];if(d!==v){let e=[...d];for(let t=0;t<b.length;t++){let r=b[t],n=H(r);f.includes(n)||(e.splice(t,0,r),I.push(r))}return"wait"===s&&I.length&&(e=I),x(W(e)),w(d),null}let{forceRender:T}=(0,D.useContext)(P);return(0,A.jsx)(A.Fragment,{children:b.map(e=>{let v=H(e),w=(!a||!!h)&&(d===b||f.includes(v));return(0,A.jsx)($,{isPresent:w,initial:(!p.current||!!r)&&void 0,custom:t,presenceAffectsLayout:i,mode:s,root:u,onExitComplete:w?void 0:()=>{if(y.current.has(v)||(y.current.add(v),!g.has(v)))return;g.set(v,!0);let e=!0;g.forEach(t=>{t||(e=!1)}),e&&(T?.(),x(m.current),a&&c?.(),n&&n())},anchorX:o,anchorY:l,children:e},v)})})},J=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Y=new Set(J),X=(e,t,r)=>r>t?t:r<e?e:r,Z={test:e=>"number"==typeof e,parse:parseFloat,transform:e=>e},ee={...Z,transform:e=>X(0,1,e)},et={...Z,default:1},er=e=>Math.round(1e5*e)/1e5,en=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu,ei=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,es=(e,t)=>r=>!!("string"==typeof r&&ei.test(r)&&r.startsWith(e)||t&&null!=r&&Object.prototype.hasOwnProperty.call(r,t)),ea=(e,t,r)=>n=>{if("string"!=typeof n)return n;let[i,s,a,o]=n.match(en);return{[e]:parseFloat(i),[t]:parseFloat(s),[r]:parseFloat(a),alpha:void 0!==o?parseFloat(o):1}},eo={...Z,transform:e=>Math.round(X(0,255,e))},el={test:es("rgb","red"),parse:ea("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:n=1})=>"rgba("+eo.transform(e)+", "+eo.transform(t)+", "+eo.transform(r)+", "+er(ee.transform(n))+")"},eu={test:es("#"),parse:function(e){let t="",r="",n="",i="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),n=e.substring(5,7),i=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),n=e.substring(3,4),i=e.substring(4,5),t+=t,r+=r,n+=n,i+=i),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:i?parseInt(i,16)/255:1}},transform:el.transform},eh=e=>({test:t=>"string"==typeof t&&t.endsWith(e)&&1===t.split(" ").length,parse:parseFloat,transform:t=>`${t}${e}`}),ec=eh("deg"),ed=eh("%"),ef=eh("px"),ep=eh("vh"),em=eh("vw"),eg={...ed,parse:e=>ed.parse(e)/100,transform:e=>ed.transform(100*e)},ey={test:es("hsl","hue"),parse:ea("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:n=1})=>"hsla("+Math.round(e)+", "+ed.transform(er(t))+", "+ed.transform(er(r))+", "+er(ee.transform(n))+")"},ev={test:e=>el.test(e)||eu.test(e)||ey.test(e),parse:e=>el.test(e)?el.parse(e):ey.test(e)?ey.parse(e):eu.parse(e),transform:e=>"string"==typeof e?e:e.hasOwnProperty("red")?el.transform(e):ey.transform(e),getAnimatableNone:e=>{let t=ev.parse(e);return t.alpha=0,ev.transform(t)}},ew=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu,eb="number",ex="color",eI=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function eT(e){let t=e.toString(),r=[],n={color:[],number:[],var:[]},i=[],s=0,a=t.replace(eI,e=>(ev.test(e)?(n.color.push(s),i.push(ex),r.push(ev.parse(e))):e.startsWith("var(")?(n.var.push(s),i.push("var"),r.push(e)):(n.number.push(s),i.push(eb),r.push(parseFloat(e))),++s,"${}")).split("${}");return{values:r,split:a,indexes:n,types:i}}function eE(e){return eT(e).values}function eS(e){let{split:t,types:r}=eT(e),n=t.length;return e=>{let i="";for(let s=0;s<n;s++)if(i+=t[s],void 0!==e[s]){let t=r[s];t===eb?i+=er(e[s]):t===ex?i+=ev.transform(e[s]):i+=e[s]}return i}}let e_=e=>"number"==typeof e?0:ev.test(e)?ev.getAnimatableNone(e):e,ek={test:function(e){return isNaN(e)&&"string"==typeof e&&(e.match(en)?.length||0)+(e.match(ew)?.length||0)>0},parse:eE,createTransformer:eS,getAnimatableNone:function(e){let t=eE(e);return eS(e)(t.map(e_))}},eC=new Set(["brightness","contrast","saturate","opacity"]);function eA(e){let[t,r]=e.slice(0,-1).split("(");if("drop-shadow"===t)return e;let[n]=r.match(en)||[];if(!n)return e;let i=r.replace(n,""),s=+!!eC.has(t);return n!==r&&(s*=100),t+"("+s+i+")"}let eD=/\b([a-z-]*)\(.*?\)/gu,eN={...ek,getAnimatableNone:e=>{let t=e.match(eD);return t?t.map(eA).join(" "):e}},eP={...Z,transform:Math.round},eR={borderWidth:ef,borderTopWidth:ef,borderRightWidth:ef,borderBottomWidth:ef,borderLeftWidth:ef,borderRadius:ef,borderTopLeftRadius:ef,borderTopRightRadius:ef,borderBottomRightRadius:ef,borderBottomLeftRadius:ef,width:ef,maxWidth:ef,height:ef,maxHeight:ef,top:ef,right:ef,bottom:ef,left:ef,inset:ef,insetBlock:ef,insetBlockStart:ef,insetBlockEnd:ef,insetInline:ef,insetInlineStart:ef,insetInlineEnd:ef,padding:ef,paddingTop:ef,paddingRight:ef,paddingBottom:ef,paddingLeft:ef,paddingBlock:ef,paddingBlockStart:ef,paddingBlockEnd:ef,paddingInline:ef,paddingInlineStart:ef,paddingInlineEnd:ef,margin:ef,marginTop:ef,marginRight:ef,marginBottom:ef,marginLeft:ef,marginBlock:ef,marginBlockStart:ef,marginBlockEnd:ef,marginInline:ef,marginInlineStart:ef,marginInlineEnd:ef,fontSize:ef,backgroundPositionX:ef,backgroundPositionY:ef,rotate:ec,rotateX:ec,rotateY:ec,rotateZ:ec,scale:et,scaleX:et,scaleY:et,scaleZ:et,skew:ec,skewX:ec,skewY:ec,distance:ef,translateX:ef,translateY:ef,translateZ:ef,x:ef,y:ef,z:ef,perspective:ef,transformPerspective:ef,opacity:ee,originX:eg,originY:eg,originZ:ef,zIndex:eP,fillOpacity:ee,strokeOpacity:ee,numOctaves:eP},eM={...eR,color:ev,backgroundColor:ev,outlineColor:ev,fill:ev,stroke:ev,borderColor:ev,borderTopColor:ev,borderRightColor:ev,borderBottomColor:ev,borderLeftColor:ev,filter:eN,WebkitFilter:eN},eO=e=>eM[e],eL=()=>({translate:0,scale:1,origin:0,originPoint:0}),eV=()=>({x:eL(),y:eL()}),eF=()=>({min:0,max:0}),ej=()=>({x:eF(),y:eF()}),eU=e=>!!(e&&e.getVelocity),eB=new Set(["width","height","top","left","right","bottom",...J]),ez=e=>t=>t.test(e),eq=[Z,ef,ed,ec,em,ep,{test:e=>"auto"===e,parse:e=>e}],e$=e=>eq.find(ez(e)),eG=()=>{},eK=()=>{};N.default;let eH=e=>t=>"string"==typeof t&&t.startsWith(e),eW=eH("--"),eQ=eH("var(--"),eJ=e=>!!eQ(e)&&eY.test(e.split("/*")[0].trim()),eY=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu;function eX(e){return"string"==typeof e&&e.split("/*")[0].includes("var(--")}let eZ=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u,e0=e=>180*e/Math.PI,e1=e=>e5(e0(Math.atan2(e[1],e[0]))),e2={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:e1,rotateZ:e1,skewX:e=>e0(Math.atan(e[1])),skewY:e=>e0(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},e5=e=>((e%=360)<0&&(e+=360),e),e6=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),e3=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),e4={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:e6,scaleY:e3,scale:e=>(e6(e)+e3(e))/2,rotateX:e=>e5(e0(Math.atan2(e[6],e[5]))),rotateY:e=>e5(e0(Math.atan2(-e[2],e[0]))),rotateZ:e1,rotate:e1,skewX:e=>e0(Math.atan(e[4])),skewY:e=>e0(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function e8(e){return+!!e.includes("scale")}function e7(e,t){let r,n;if(!e||"none"===e)return e8(t);let i=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);if(i)r=e4,n=i;else{let t=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=e2,n=t}if(!n)return e8(t);let s=r[t],a=n[1].split(",").map(e9);return"function"==typeof s?s(a):a[s]}function e9(e){return parseFloat(e.trim())}let te=e=>e===Z||e===ef,tt=new Set(["x","y","z"]),tr=J.filter(e=>!tt.has(e)),tn={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>e7(t,"x"),y:(e,{transform:t})=>e7(t,"y")};tn.translateX=tn.x,tn.translateY=tn.y;let ti=e=>e,ts={},ta=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function to(e,t){let r=!1,n=!0,i={delta:0,timestamp:0,isProcessing:!1},s=()=>r=!0,a=ta.reduce((e,r)=>(e[r]=function(e,t){let r=new Set,n=new Set,i=!1,s=!1,a=new WeakSet,o={delta:0,timestamp:0,isProcessing:!1},l=0;function u(t){a.has(t)&&(h.schedule(t),e()),l++,t(o)}let h={schedule:(e,t=!1,s=!1)=>{let o=s&&i?r:n;return t&&a.add(e),o.has(e)||o.add(e),e},cancel:e=>{n.delete(e),a.delete(e)},process:e=>{if(o=e,i){s=!0;return}i=!0,[r,n]=[n,r],r.forEach(u),t,l=0,r.clear(),i=!1,s&&(s=!1,h.process(e))}};return h}(s,t?r:void 0),e),{}),{setup:o,read:l,resolveKeyframes:u,preUpdate:h,update:c,preRender:d,render:f,postRender:p}=a,m=()=>{let s=ts.useManualTiming?i.timestamp:performance.now();r=!1,ts.useManualTiming||(i.delta=n?1e3/60:Math.max(Math.min(s-i.timestamp,40),1)),i.timestamp=s,i.isProcessing=!0,o.process(i),l.process(i),u.process(i),h.process(i),c.process(i),d.process(i),f.process(i),p.process(i),i.isProcessing=!1,r&&t&&(n=!1,e(m))};return{schedule:ta.reduce((t,s)=>{let o=a[s];return t[s]=(t,s=!1,a=!1)=>(!r&&(r=!0,n=!0,i.isProcessing||e(m)),o.schedule(t,s,a)),t},{}),cancel:e=>{for(let t=0;t<ta.length;t++)a[ta[t]].cancel(e)},state:i,steps:a}}let{schedule:tl,cancel:tu,state:th,steps:tc}=to("u">typeof requestAnimationFrame?requestAnimationFrame:ti,!0),td=new Set,tf=!1,tp=!1,tm=!1;function tg(){if(tp){let e=Array.from(td).filter(e=>e.needsMeasurement),t=new Set(e.map(e=>e.element)),r=new Map;t.forEach(e=>{let t,n=(t=[],tr.forEach(r=>{let n=e.getValue(r);void 0!==n&&(t.push([r,n.get()]),n.set(+!!r.startsWith("scale")))}),t);n.length&&(r.set(e,n),e.render())}),e.forEach(e=>e.measureInitialState()),t.forEach(e=>{e.render();let t=r.get(e);t&&t.forEach(([t,r])=>{e.getValue(t)?.set(r)})}),e.forEach(e=>e.measureEndState()),e.forEach(e=>{void 0!==e.suspendedScrollY&&window.scrollTo(0,e.suspendedScrollY)})}tp=!1,tf=!1,td.forEach(e=>e.complete(tm)),td.clear()}function ty(){td.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(tp=!0)})}class tv{constructor(e,t,r,n,i,s=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=r,this.motionValue=n,this.element=i,this.isAsync=s}scheduleResolve(){this.state="scheduled",this.isAsync?(td.add(this),tf||(tf=!0,tl.read(ty),tl.resolveKeyframes(tg))):(this.readKeyframes(),this.complete())}readKeyframes(){let{unresolvedKeyframes:e,name:t,element:r,motionValue:n}=this;if(null===e[0]){let i=n?.get(),s=e[e.length-1];if(void 0!==i)e[0]=i;else if(r&&t){let n=r.readValue(t,s);null!=n&&(e[0]=n)}void 0===e[0]&&(e[0]=s),n&&void 0===i&&n.set(e[0])}for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),td.delete(this)}cancel(){"scheduled"===this.state&&(td.delete(this),this.state="pending")}resume(){"pending"===this.state&&this.scheduleResolve()}}function tw(e,t){let r=eO(e);return r!==eN&&(r=ek),r.getAnimatableNone?r.getAnimatableNone(t):void 0}let tb=new Set(["auto","none","0"]);class tx extends tv{constructor(e,t,r,n,i){super(e,t,r,n,i,!0)}readKeyframes(){let{unresolvedKeyframes:e,element:t,name:r}=this;if(!t||!t.current)return;super.readKeyframes();for(let r=0;r<e.length;r++){let n=e[r];if("string"==typeof n&&eJ(n=n.trim())){let i=function e(t,r,n=1){eK(n<=4,`Max CSS variable fallback depth detected in property "${t}". This may indicate a circular fallback dependency.`,"max-css-var-depth");let[i,s]=function(e){let t=eZ.exec(e);if(!t)return[,];let[,r,n,i]=t;return[`--${r??n}`,i]}(t);if(!i)return;let a=window.getComputedStyle(r).getPropertyValue(i);if(a){let e=a.trim();return/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e)?parseFloat(e):e}return eJ(s)?e(s,r,n+1):s}(n,t.current);void 0!==i&&(e[r]=i),r===e.length-1&&(this.finalKeyframe=n)}}if(this.resolveNoneKeyframes(),!eB.has(r)||2!==e.length)return;let[n,i]=e,s=e$(n),a=e$(i);if(eX(n)!==eX(i)&&tn[r]){this.needsMeasurement=!0;return}if(s!==a)if(te(s)&&te(a))for(let t=0;t<e.length;t++){let r=e[t];"string"==typeof r&&(e[t]=parseFloat(r))}else tn[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){let{unresolvedKeyframes:e,name:t}=this,r=[];for(let t=0;t<e.length;t++)(null===e[t]||function(e){if("number"==typeof e)return 0===e;if(null===e)return!0;return"none"===e||"0"===e||/^0[^.\s]+$/u.test(e)}(e[t]))&&r.push(t);r.length&&function(e,t,r){let n,i=0;for(;i<e.length&&!n;){let t=e[i];"string"==typeof t&&!tb.has(t)&&eT(t).values.length&&(n=e[i]),i++}if(n&&r)for(let i of t)e[i]=tw(r,n)}(e,r,t)}measureInitialState(){let{element:e,unresolvedKeyframes:t,name:r}=this;if(!e||!e.current)return;"height"===r&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=tn[r](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;let n=t[t.length-1];void 0!==n&&e.getValue(r,n).jump(n,!1)}measureEndState(){let{element:e,name:t,unresolvedKeyframes:r}=this;if(!e||!e.current)return;let n=e.getValue(t);n&&n.jump(this.measuredOrigin,!1);let i=r.length-1,s=r[i];r[i]=tn[t](e.measureViewportBox(),window.getComputedStyle(e.current)),null!==s&&void 0===this.finalKeyframe&&(this.finalKeyframe=s),this.removedTransforms?.length&&this.removedTransforms.forEach(([t,r])=>{e.getValue(t).set(r)}),this.resolveNoneKeyframes()}}function tI(e,t){-1===e.indexOf(t)&&e.push(t)}function tT(e,t){let r=e.indexOf(t);r>-1&&e.splice(r,1)}class tE{constructor(){this.subscriptions=[]}add(e){return tI(this.subscriptions,e),()=>tT(this.subscriptions,e)}notify(e,t,r){let n=this.subscriptions.length;if(n)if(1===n)this.subscriptions[0](e,t,r);else for(let i=0;i<n;i++){let n=this.subscriptions[i];n&&n(e,t,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}let{schedule:tS}=to(queueMicrotask,!1);function t_(){t=void 0}let tk={now:()=>(void 0===t&&tk.set(th.isProcessing||ts.useManualTiming?th.timestamp:performance.now()),t),set:e=>{t=e,queueMicrotask(t_)}};class tC{constructor(e,t={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=e=>{let t=tk.now();if(this.updatedAt!==t&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(e),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(let e of this.dependents)e.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=tk.now(),null===this.canTrackVelocity&&void 0!==e&&(this.canTrackVelocity=!isNaN(parseFloat(this.current)))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new tE);let r=this.events[e].add(t);return"change"===e?()=>{r(),tl.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(let e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,t,r){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return u&&u.push(this),this.current}getPrevious(){return this.prev}getVelocity(){var e;let t=tk.now();if(!this.canTrackVelocity||void 0===this.prevFrameValue||t-this.updatedAt>30)return 0;let r=Math.min(this.updatedAt-this.prevUpdatedAt,30);return e=parseFloat(this.current)-parseFloat(this.prevFrameValue),r?1e3/r*e:0}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function tA(e,t){return new tC(e,t)}let tD=[...eq,ev,ek],tN={current:null},tP={current:!1},tR="u">typeof window,tM=new WeakMap;function tO(e){return null!==e&&"object"==typeof e&&"function"==typeof e.start}function tL(e){return"string"==typeof e||Array.isArray(e)}let tV=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],tF=["initial",...tV];function tj(e){return tO(e.animate)||tF.some(t=>tL(e[t]))}function tU(e){return!!(tj(e)||e.variants)}function tB(e){let t=[{},{}];return e?.values.forEach((e,r)=>{t[0][r]=e.get(),t[1][r]=e.getVelocity()}),t}function tz(e,t,r,n){if("function"==typeof t){let[i,s]=tB(n);t=t(void 0!==r?r:e.custom,i,s)}if("string"==typeof t&&(t=e.variants&&e.variants[t]),"function"==typeof t){let[i,s]=tB(n);t=t(void 0!==r?r:e.custom,i,s)}return t}let tq=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],t$={};class tG{scrapeMotionValuesFromProps(e,t,r){return{}}constructor({parent:e,props:t,presenceContext:r,reducedMotionConfig:n,blockInitialAnimation:i,visualState:s},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=tv,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{let e=tk.now();this.renderScheduledAt<e&&(this.renderScheduledAt=e,tl.render(this.render,!1,!0))};const{latestValues:o,renderState:l}=s;this.latestValues=o,this.baseTarget={...o},this.initialValues=t.initial?{...o}:{},this.renderState=l,this.parent=e,this.props=t,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=n,this.options=a,this.blockInitialAnimation=!!i,this.isControllingVariants=tj(t),this.isVariantNode=tU(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:u,...h}=this.scrapeMotionValuesFromProps(t,{},this);for(const e in h){const t=h[e];void 0!==o[e]&&eU(t)&&t.set(o[e])}}mount(e){this.current=e,tM.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((e,t)=>this.bindToMotionValue(t,e)),"never"===this.reducedMotionConfig?this.shouldReduceMotion=!1:"always"===this.reducedMotionConfig?this.shouldReduceMotion=!0:(tP.current||function(){if(tP.current=!0,tR)if(window.matchMedia){let e=window.matchMedia("(prefers-reduced-motion)"),t=()=>tN.current=e.matches;e.addEventListener("change",t),t()}else tN.current=!1}(),this.shouldReduceMotion=tN.current),this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){for(let e in this.projection&&this.projection.unmount(),tu(this.notifyUpdate),tu(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this),this.events)this.events[e].clear();for(let e in this.features){let t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,t){let r;this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();let n=Y.has(e);n&&this.onBindTransform&&this.onBindTransform();let i=t.on("change",t=>{this.latestValues[e]=t,this.props.onUpdate&&tl.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});"u">typeof window&&window.MotionCheckAppearSync&&(r=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{i(),r&&r(),t.owner&&t.stop()})}sortNodePosition(e){return this.current&&this.sortInstanceNodePosition&&this.type===e.type?this.sortInstanceNodePosition(this.current,e.current):0}updateFeatures(){let e="animation";for(e in t$){let t=t$[e];if(!t)continue;let{isEnabled:r,Feature:n}=t;if(!this.features[e]&&n&&r(this.props)&&(this.features[e]=new n(this)),this.features[e]){let t=this.features[e];t.isMounted?t.update():(t.mount(),t.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):ej()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let t=0;t<tq.length;t++){let r=tq[t];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);let n=e["on"+r];n&&(this.propEventSubscriptions[r]=this.on(r,n))}this.prevMotionValues=function(e,t,r){for(let n in t){let i=t[n],s=r[n];if(eU(i))e.addValue(n,i);else if(eU(s))e.addValue(n,tA(i,{owner:e}));else if(s!==i)if(e.hasValue(n)){let t=e.getValue(n);!0===t.liveStyle?t.jump(i):t.hasAnimated||t.set(i)}else{let t=e.getStaticValue(n);e.addValue(n,tA(void 0!==t?t:i,{owner:e}))}}for(let n in r)void 0===t[n]&&e.removeValue(n);return t}(this,this.scrapeMotionValuesFromProps(e,this.prevProps||{},this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){let t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){let r=this.values.get(e);t!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);let t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return void 0===r&&void 0!==t&&(r=tA(null===t?void 0:t,{owner:this}),this.addValue(e,r)),r}readValue(e,t){let r=void 0===this.latestValues[e]&&this.current?this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options):this.latestValues[e];if(null!=r){let n,i;if("string"==typeof r&&(n=r,/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n)||(i=r,/^0[^.\s]+$/u.test(i))))r=parseFloat(r);else{let n;n=r,!tD.find(ez(n))&&ek.test(t)&&(r=tw(e,t))}this.setBaseTarget(e,eU(r)?r.get():r)}return eU(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){let t,{initial:r}=this.props;if("string"==typeof r||"object"==typeof r){let n=tz(this.props,r,this.presenceContext?.custom);n&&(t=n[e])}if(r&&void 0!==t)return t;let n=this.getBaseTargetFromProps(this.props,e);return void 0===n||eU(n)?void 0!==this.initialValues[e]&&void 0===t?void 0:this.baseTarget[e]:n}on(e,t){return this.events[e]||(this.events[e]=new tE),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}scheduleRenderMicrotask(){tS.render(this.render)}}class tK extends tG{constructor(){super(...arguments),this.KeyframeResolver=tx}sortInstanceNodePosition(e,t){return 2&e.compareDocumentPosition(t)?1:-1}getBaseTargetFromProps(e,t){let r=e.style;return r?r[t]:void 0}removeValueFromRenderState(e,{vars:t,style:r}){delete t[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);let{children:e}=this.props;eU(e)&&(this.childSubscription=e.on("change",e=>{this.current&&(this.current.textContent=`${e}`)}))}}function tH(e){return e.replace(/([A-Z])/g,e=>`-${e.toLowerCase()}`)}let tW=(e,t)=>t&&"number"==typeof e?t.transform(e):e,tQ={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},tJ=J.length;function tY(e,t,r){let{style:n,vars:i,transformOrigin:s}=e,a=!1,o=!1;for(let e in t){let r=t[e];if(Y.has(e)){a=!0;continue}if(eW(e)){i[e]=r;continue}{let t=tW(r,eR[e]);e.startsWith("origin")?(o=!0,s[e]=t):n[e]=t}}if(!t.transform&&(a||r?n.transform=function(e,t,r){let n="",i=!0;for(let s=0;s<tJ;s++){let a=J[s],o=e[a];if(void 0===o)continue;let l=!0;if("number"==typeof o)l=o===+!!a.startsWith("scale");else{let e=parseFloat(o);l=a.startsWith("scale")?1===e:0===e}if(!l||r){let e=tW(o,eR[a]);if(!l){i=!1;let t=tQ[a]||a;n+=`${t}(${e}) `}r&&(t[a]=e)}}return n=n.trim(),r?n=r(t,i?"":n):i&&(n="none"),n}(t,e.transform,r):n.transform&&(n.transform="none")),o){let{originX:e="50%",originY:t="50%",originZ:r=0}=s;n.transformOrigin=`${e} ${t} ${r}`}}let tX={offset:"stroke-dashoffset",array:"stroke-dasharray"},tZ={offset:"strokeDashoffset",array:"strokeDasharray"},t0=["offsetDistance","offsetPath","offsetRotate","offsetAnchor"];function t1(e,{attrX:t,attrY:r,attrScale:n,pathLength:i,pathSpacing:s=1,pathOffset:a=0,...o},l,u,h){if(tY(e,o,u),l){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};let{attrs:c,style:d}=e;for(let e of(c.transform&&(d.transform=c.transform,delete c.transform),(d.transform||c.transformOrigin)&&(d.transformOrigin=c.transformOrigin??"50% 50%",delete c.transformOrigin),d.transform&&(d.transformBox=h?.transformBox??"fill-box",delete c.transformBox),t0))void 0!==c[e]&&(d[e]=c[e],delete c[e]);void 0!==t&&(c.x=t),void 0!==r&&(c.y=r),void 0!==n&&(c.scale=n),void 0!==i&&function(e,t,r=1,n=0,i=!0){e.pathLength=1;let s=i?tX:tZ;e[s.offset]=`${-n}`,e[s.array]=`${t} ${r}`}(c,i,s,a,!1)}let t2=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]),t5=e=>"string"==typeof e&&"svg"===e.toLowerCase();function t6(e,{style:t,vars:r},n,i){let s,a=e.style;for(s in t)a[s]=t[s];for(s in i?.applyProjectionStyles(a,n),r)a.setProperty(s,r[s])}function t3(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}let t4={correct:(e,t)=>{if(!t.target)return e;if("string"==typeof e)if(!ef.test(e))return e;else e=parseFloat(e);let r=t3(e,t.target.x),n=t3(e,t.target.y);return`${r}% ${n}%`}},t8=(e,t,r)=>e+(t-e)*r,t7={borderRadius:{...t4,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:t4,borderTopRightRadius:t4,borderBottomLeftRadius:t4,borderBottomRightRadius:t4,boxShadow:{correct:(e,{treeScale:t,projectionDelta:r})=>{let n=ek.parse(e);if(n.length>5)return e;let i=ek.createTransformer(e),s=+("number"!=typeof n[0]),a=r.x.scale*t.x,o=r.y.scale*t.y;n[0+s]/=a,n[1+s]/=o;let l=t8(a,o,.5);return"number"==typeof n[2+s]&&(n[2+s]/=l),"number"==typeof n[3+s]&&(n[3+s]/=l),i(n)}}};function t9(e,{layout:t,layoutId:r}){return Y.has(e)||e.startsWith("origin")||(t||void 0!==r)&&(!!t7[e]||"opacity"===e)}function re(e,t,r){let n=e.style,i=t?.style,s={};if(!n)return s;for(let t in n)(eU(n[t])||i&&eU(i[t])||t9(t,e)||r?.getValue(t)?.liveStyle!==void 0)&&(s[t]=n[t]);return s}function rt(e,t,r){let n=re(e,t,r);for(let r in e)(eU(e[r])||eU(t[r]))&&(n[-1!==J.indexOf(r)?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r]=e[r]);return n}class rr extends tK{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=ej}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(Y.has(t)){let e=eO(t);return e&&e.default||0}return t=t2.has(t)?t:tH(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,r){return rt(e,t,r)}build(e,t,r){t1(e,t,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(e,t,r,n){for(let r in t6(e,t,void 0,n),t.attrs)e.setAttribute(t2.has(r)?r:tH(r),t.attrs[r])}mount(e){this.isSVGTag=t5(e.tagName),super.mount(e)}}function rn({top:e,left:t,right:r,bottom:n}){return{x:{min:t,max:r},y:{min:e,max:n}}}function ri(e){return void 0===e||1===e}function rs({scale:e,scaleX:t,scaleY:r}){return!ri(e)||!ri(t)||!ri(r)}function ra(e){return rs(e)||ro(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function ro(e){var t,r;return(t=e.x)&&"0%"!==t||(r=e.y)&&"0%"!==r}function rl(e,t,r,n,i){return void 0!==i&&(e=n+i*(e-n)),n+r*(e-n)+t}function ru(e,t=0,r=1,n,i){e.min=rl(e.min,t,r,n,i),e.max=rl(e.max,t,r,n,i)}function rh(e,{x:t,y:r}){ru(e.x,t.translate,t.scale,t.originPoint),ru(e.y,r.translate,r.scale,r.originPoint)}function rc(e,t){e.min=e.min+t,e.max=e.max+t}function rd(e,t,r,n,i=.5){let s=t8(e.min,e.max,i);ru(e,t,r,s,n)}function rf(e,t){rd(e.x,t.x,t.scaleX,t.scale,t.originX),rd(e.y,t.y,t.scaleY,t.scale,t.originY)}function rp(e,t){return rn(function(e,t){if(!t)return e;let r=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}(e.getBoundingClientRect(),t))}class rm extends tK{constructor(){super(...arguments),this.type="html",this.renderInstance=t6}readValueFromInstance(e,t){if(Y.has(t))return this.projection?.isProjecting?e8(t):((e,t)=>{let{transform:r="none"}=getComputedStyle(e);return e7(r,t)})(e,t);{let r=window.getComputedStyle(e),n=(eW(t)?r.getPropertyValue(t):r[t])||0;return"string"==typeof n?n.trim():n}}measureInstanceViewportBox(e,{transformPagePoint:t}){return rp(e,t)}build(e,t,r){tY(e,t,r.transformTemplate)}scrapeMotionValuesFromProps(e,t,r){return re(e,t,r)}}let rg=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function ry(e){if("string"!=typeof e||e.includes("-"));else if(rg.indexOf(e)>-1||/[A-Z]/u.test(e))return!0;return!1}let rv=(0,D.createContext)({strict:!1}),rw=(0,D.createContext)({});function rb(e){return Array.isArray(e)?e.join(" "):e}let rx=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function rI(e,t,r){for(let n in t)eU(t[n])||t9(n,r)||(e[n]=t[n])}let rT=()=>({...rx(),attrs:{}}),rE=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function rS(e){return e.startsWith("while")||e.startsWith("drag")&&"draggable"!==e||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||rE.has(e)}let r_=e=>!rS(e);try{c=(()=>{let e=Error("Cannot find module '@emotion/is-prop-valid'");throw e.code="MODULE_NOT_FOUND",e})().default,"function"==typeof c&&(r_=e=>e.startsWith("on")?!rS(e):c(e))}catch{}function rk(e){return eU(e)?e.get():e}let rC=e=>(t,r)=>{let n=(0,D.useContext)(rw),i=(0,D.useContext)(L),s=()=>(function({scrapeMotionValuesFromProps:e,createRenderState:t},r,n,i){return{latestValues:function(e,t,r,n){let i={},s=n(e,{});for(let e in s)i[e]=rk(s[e]);let{initial:a,animate:o}=e,l=tj(e),u=tU(e);t&&u&&!l&&!1!==e.inherit&&(void 0===a&&(a=t.initial),void 0===o&&(o=t.animate));let h=!!r&&!1===r.initial,c=(h=h||!1===a)?o:a;if(c&&"boolean"!=typeof c&&!tO(c)){let t=Array.isArray(c)?c:[c];for(let r=0;r<t.length;r++){let n=tz(e,t[r]);if(n){let{transitionEnd:e,transition:t,...r}=n;for(let e in r){let t=r[e];if(Array.isArray(t)){let e=h?t.length-1:0;t=t[e]}null!==t&&(i[e]=t)}for(let t in e)i[t]=e[t]}}}return i}(r,n,i,e),renderState:t()}})(e,t,n,i);return r?s():R(s)},rA=rC({scrapeMotionValuesFromProps:re,createRenderState:rx}),rD=rC({scrapeMotionValuesFromProps:rt,createRenderState:rT}),rN={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},rP=!1;function rR(){return!function(){if(rP)return;let e={};for(let t in rN)e[t]={isEnabled:e=>rN[t].some(t=>!!e[t])};t$=e,rP=!0}(),t$}let rM=Symbol.for("motionComponentSymbol"),rO="data-"+tH("framerAppearId"),rL=(0,D.createContext)({});function rV(e){return e&&"object"==typeof e&&Object.prototype.hasOwnProperty.call(e,"current")}function rF(e,{forwardMotionProps:t=!1,type:r}={},n,i){n&&function(e){let t=rR();for(let r in e)t[r]={...t[r],...e[r]};t$=t}(n);let s=r?"svg"===r:ry(e),a=s?rD:rA;function o(r,n){var o;let l,u,h,c={...(0,D.useContext)(U),...r,layoutId:function({layoutId:e}){let t=(0,D.useContext)(P).id;return t&&void 0!==e?t+"-"+e:e}(r)},{isStatic:d}=c,f=function(e){let{initial:t,animate:r}=function(e,t){if(tj(e)){let{initial:t,animate:r}=e;return{initial:!1===t||tL(t)?t:void 0,animate:tL(r)?r:void 0}}return!1!==e.inherit?t:{}}(e,(0,D.useContext)(rw));return(0,D.useMemo)(()=>({initial:t,animate:r}),[rb(t),rb(r)])}(r),p=a(r,d);if(!d&&M){(0,D.useContext)(rv).strict;let t=function(e){let{drag:t,layout:r}=rR();if(!t&&!r)return{};let n={...t,...r};return{MeasureLayout:t?.isEnabled(e)||r?.isEnabled(e)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}(c);l=t.MeasureLayout,f.visualElement=function(e,t,r,n,i,s){let{visualElement:a}=(0,D.useContext)(rw),o=(0,D.useContext)(rv),l=(0,D.useContext)(L),u=(0,D.useContext)(U).reducedMotion,h=(0,D.useRef)(null),c=(0,D.useRef)(!1);n=n||o.renderer,!h.current&&n&&(h.current=n(e,{visualState:t,parent:a,props:r,presenceContext:l,blockInitialAnimation:!!l&&!1===l.initial,reducedMotionConfig:u,isSVG:s}),c.current&&h.current&&(h.current.manuallyAnimateOnMount=!0));let d=h.current,f=(0,D.useContext)(rL);d&&!d.projection&&i&&("html"===d.type||"svg"===d.type)&&function(e,t,r,n){let{layoutId:i,layout:s,drag:a,dragConstraints:o,layoutScroll:l,layoutRoot:u,layoutCrossfade:h}=t;e.projection=new r(e.latestValues,t["data-framer-portal-id"]?void 0:function e(t){if(t)return!1!==t.options.allowProjection?t.projection:e(t.parent)}(e.parent)),e.projection.setOptions({layoutId:i,layout:s,alwaysMeasureLayout:!!a||o&&rV(o),visualElement:e,animationType:"string"==typeof s?s:"both",initialPromotionConfig:n,crossfade:h,layoutScroll:l,layoutRoot:u})}(h.current,r,i,f);let p=(0,D.useRef)(!1);(0,D.useInsertionEffect)(()=>{d&&p.current&&d.update(r,l)});let m=r[rO],g=(0,D.useRef)(!!m&&!window.MotionHandoffIsComplete?.(m)&&window.MotionHasOptimisedAnimation?.(m));return O(()=>{c.current=!0,d&&(p.current=!0,window.MotionIsMounted=!0,d.updateFeatures(),d.scheduleRenderMicrotask(),g.current&&d.animationState&&d.animationState.animateChanges())}),(0,D.useEffect)(()=>{d&&(!g.current&&d.animationState&&d.animationState.animateChanges(),g.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(m)}),g.current=!1),d.enteringChildren=void 0)}),d}(e,p,c,i,t.ProjectionNode,s)}return(0,A.jsxs)(rw.Provider,{value:f,children:[l&&f.visualElement?(0,A.jsx)(l,{visualElement:f.visualElement,...c}):null,function(e,t,r,{latestValues:n},i,s=!1,a){let o=(a??ry(e)?function(e,t,r,n){let i=(0,D.useMemo)(()=>{let r=rT();return t1(r,t,t5(n),e.transformTemplate,e.style),{...r.attrs,style:{...r.style}}},[t]);if(e.style){let t={};rI(t,e.style,e),i.style={...t,...i.style}}return i}:function(e,t){let r,n,i={},s=(r=e.style||{},rI(n={},r,e),Object.assign(n,function({transformTemplate:e},t){return(0,D.useMemo)(()=>{let r=rx();return tY(r,t,e),Object.assign({},r.vars,r.style)},[t])}(e,t)),n);return e.drag&&!1!==e.dragListener&&(i.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=!0===e.drag?"none":`pan-${"x"===e.drag?"y":"x"}`),void 0===e.tabIndex&&(e.onTap||e.onTapStart||e.whileTap)&&(i.tabIndex=0),i.style=s,i})(t,n,i,e),l=function(e,t,r){let n={};for(let i in e)("values"!==i||"object"!=typeof e.values)&&(r_(i)||!0===r&&rS(i)||!t&&!rS(i)||e.draggable&&i.startsWith("onDrag"))&&(n[i]=e[i]);return n}(t,"string"==typeof e,s),u=e!==D.Fragment?{...l,...o,ref:r}:{},{children:h}=t,c=(0,D.useMemo)(()=>eU(h)?h.get():h,[h]);return(0,D.createElement)(e,{...u,children:c})}(e,r,(o=f.visualElement,u=(0,D.useRef)(n),(0,D.useInsertionEffect)(()=>{u.current=n}),h=(0,D.useRef)(null),(0,D.useCallback)(e=>{e&&p.onMount?.(e),o&&(e?o.mount(e):o.unmount());let t=u.current;if("function"==typeof t)if(e){let r=t(e);"function"==typeof r&&(h.current=r)}else h.current?(h.current(),h.current=null):t(e);else t&&(t.current=e)},[o])),p,d,t,s)]})}o.displayName=`motion.${"string"==typeof e?e:`create(${e.displayName??e.name??""})`}`;let l=(0,D.forwardRef)(o);return l[rM]=e,l}class rj{constructor(e){this.isMounted=!1,this.node=e}update(){}}function rU(e,t,r){let n=e.getProps();return tz(n,t,void 0!==r?r:n.custom,e)}function rB(e,t){return e?.[t]??e?.default??e}let rz=e=>Array.isArray(e);function rq(e,t){let r=e.getValue("willChange");if(eU(r)&&r.add)return r.add(t);if(!r&&ts.WillChange){let r=new ts.WillChange("auto");e.addValue("willChange",r),r.add(t)}}let r$=e=>1e3*e,rG=(e,t)=>r=>t(e(r)),rK=(...e)=>e.reduce(rG),rH={layout:0,mainThread:0,waapi:0};function rW(e,t,r){return(r<0&&(r+=1),r>1&&(r-=1),r<1/6)?e+(t-e)*6*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function rQ(e,t){return r=>r>0?t:e}let rJ=(e,t,r)=>{let n=e*e,i=r*(t*t-n)+n;return i<0?0:Math.sqrt(i)},rY=[eu,el,ey];function rX(e){let t=rY.find(t=>t.test(e));if(eG(!!t,`'${e}' is not an animatable color. Use the equivalent color code instead.`,"color-not-animatable"),!t)return!1;let r=t.parse(e);return t===ey&&(r=function({hue:e,saturation:t,lightness:r,alpha:n}){e/=360,r/=100;let i=0,s=0,a=0;if(t/=100){let n=r<.5?r*(1+t):r+t-r*t,o=2*r-n;i=rW(o,n,e+1/3),s=rW(o,n,e),a=rW(o,n,e-1/3)}else i=s=a=r;return{red:Math.round(255*i),green:Math.round(255*s),blue:Math.round(255*a),alpha:n}}(r)),r}let rZ=(e,t)=>{let r=rX(e),n=rX(t);if(!r||!n)return rQ(e,t);let i={...r};return e=>(i.red=rJ(r.red,n.red,e),i.green=rJ(r.green,n.green,e),i.blue=rJ(r.blue,n.blue,e),i.alpha=t8(r.alpha,n.alpha,e),el.transform(i))},r0=new Set(["none","hidden"]);function r1(e,t){return r=>t8(e,t,r)}function r2(e){return"number"==typeof e?r1:"string"==typeof e?eJ(e)?rQ:ev.test(e)?rZ:r3:Array.isArray(e)?r5:"object"==typeof e?ev.test(e)?rZ:r6:rQ}function r5(e,t){let r=[...e],n=r.length,i=e.map((e,r)=>r2(e)(e,t[r]));return e=>{for(let t=0;t<n;t++)r[t]=i[t](e);return r}}function r6(e,t){let r={...e,...t},n={};for(let i in r)void 0!==e[i]&&void 0!==t[i]&&(n[i]=r2(e[i])(e[i],t[i]));return e=>{for(let t in n)r[t]=n[t](e);return r}}let r3=(e,t)=>{let r=ek.createTransformer(t),n=eT(e),i=eT(t);if(!(n.indexes.var.length===i.indexes.var.length&&n.indexes.color.length===i.indexes.color.length&&n.indexes.number.length>=i.indexes.number.length))return eG(!0,`Complex values '${e}' and '${t}' too different to mix. Ensure all colors are of the same type, and that each contains the same quantity of number and color values. Falling back to instant transition.`,"complex-values-different"),rQ(e,t);if(r0.has(e)&&!i.values.length||r0.has(t)&&!n.values.length)return r0.has(e)?r=>r<=0?e:t:r=>r>=1?t:e;return rK(r5(function(e,t){let r=[],n={color:0,var:0,number:0};for(let i=0;i<t.values.length;i++){let s=t.types[i],a=e.indexes[s][n[s]],o=e.values[a]??0;r[i]=o,n[s]++}return r}(n,i),i.values),r)};function r4(e,t,r){return"number"==typeof e&&"number"==typeof t&&"number"==typeof r?t8(e,t,r):r2(e)(e,t)}let r8=e=>{let t=({timestamp:t})=>e(t);return{start:(e=!0)=>tl.update(t,e),stop:()=>tu(t),now:()=>th.isProcessing?th.timestamp:tk.now()}},r7=(e,t,r=10)=>{let n="",i=Math.max(Math.round(t/r),2);for(let t=0;t<i;t++)n+=Math.round(1e4*e(t/(i-1)))/1e4+", ";return`linear(${n.substring(0,n.length-2)})`};function r9(e){let t=0,r=e.next(t);for(;!r.done&&t<2e4;)t+=50,r=e.next(t);return t>=2e4?1/0:t}function ne(e,t,r){var n,i;let s=Math.max(t-5,0);return n=r-e(s),(i=t-s)?1e3/i*n:0}let nt=.01,nr=2,nn=.005,ni=.5;function ns(e,t){return e*Math.sqrt(1-t*t)}let na=["duration","bounce"],no=["stiffness","damping","mass"];function nl(e,t){return t.some(t=>void 0!==e[t])}function nu(e=.3,t=.3){let r,n="object"!=typeof e?{visualDuration:e,keyframes:[0,1],bounce:t}:e,{restSpeed:i,restDelta:s}=n,a=n.keyframes[0],o=n.keyframes[n.keyframes.length-1],l={done:!1,value:a},{stiffness:u,damping:h,mass:c,duration:d,velocity:f,isResolvedFromDuration:p}=function(e){let t={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!nl(e,no)&&nl(e,na))if(e.visualDuration){let r=2*Math.PI/(1.2*e.visualDuration),n=r*r,i=2*X(.05,1,1-(e.bounce||0))*Math.sqrt(n);t={...t,mass:1,stiffness:n,damping:i}}else{let r=function({duration:e=800,bounce:t=.3,velocity:r=0,mass:n=1}){let i,s;eG(e<=r$(10),"Spring duration must be 10 seconds or less","spring-duration-limit");let a=1-t;a=X(.05,1,a),e=X(.01,10,e/1e3),a<1?(i=t=>{let n=t*a,i=n*e;return .001-(n-r)/ns(t,a)*Math.exp(-i)},s=t=>{let n=t*a*e,s=Math.pow(a,2)*Math.pow(t,2)*e,o=Math.exp(-n),l=ns(Math.pow(t,2),a);return(n*r+r-s)*o*(-i(t)+.001>0?-1:1)/l}):(i=t=>-.001+Math.exp(-t*e)*((t-r)*e+1),s=t=>e*e*(r-t)*Math.exp(-t*e));let o=function(e,t,r){let n=r;for(let r=1;r<12;r++)n-=e(n)/t(n);return n}(i,s,5/e);if(e=r$(e),isNaN(o))return{stiffness:100,damping:10,duration:e};{let t=Math.pow(o,2)*n;return{stiffness:t,damping:2*a*Math.sqrt(n*t),duration:e}}}(e);(t={...t,...r,mass:1}).isResolvedFromDuration=!0}return t}({...n,velocity:-((n.velocity||0)/1e3)}),m=f||0,g=h/(2*Math.sqrt(u*c)),y=o-a,v=Math.sqrt(u/c)/1e3,w=5>Math.abs(y);if(i||(i=w?nt:nr),s||(s=w?nn:ni),g<1){let e=ns(v,g);r=t=>o-Math.exp(-g*v*t)*((m+g*v*y)/e*Math.sin(e*t)+y*Math.cos(e*t))}else if(1===g)r=e=>o-Math.exp(-v*e)*(y+(m+v*y)*e);else{let e=v*Math.sqrt(g*g-1);r=t=>{let r=Math.exp(-g*v*t),n=Math.min(e*t,300);return o-r*((m+g*v*y)*Math.sinh(n)+e*y*Math.cosh(n))/e}}let b={calculatedDuration:p&&d||null,next:e=>{let t=r(e);if(p)l.done=e>=d;else{let n=0===e?m:0;g<1&&(n=0===e?r$(m):ne(r,e,t));let a=Math.abs(o-t)<=s;l.done=Math.abs(n)<=i&&a}return l.value=l.done?o:t,l},toString:()=>{let e=Math.min(r9(b),2e4),t=r7(t=>b.next(e*t).value,e,30);return e+"ms "+t},toTransition:()=>{}};return b}function nh({keyframes:e,velocity:t=0,power:r=.8,timeConstant:n=325,bounceDamping:i=10,bounceStiffness:s=500,modifyTarget:a,min:o,max:l,restDelta:u=.5,restSpeed:h}){let c,d,f=e[0],p={done:!1,value:f},m=r*t,g=f+m,y=void 0===a?g:a(g);y!==g&&(m=y-f);let v=e=>-m*Math.exp(-e/n),w=e=>y+v(e),b=e=>{let t=v(e),r=w(e);p.done=Math.abs(t)<=u,p.value=p.done?y:r},x=e=>{let t;if(t=p.value,void 0!==o&&t<o||void 0!==l&&t>l){var r;c=e,d=nu({keyframes:[p.value,(r=p.value,void 0===o?l:void 0===l||Math.abs(o-r)<Math.abs(l-r)?o:l)],velocity:ne(w,e,p.value),damping:i,stiffness:s,restDelta:u,restSpeed:h})}};return x(0),{calculatedDuration:null,next:e=>{let t=!1;return(d||void 0!==c||(t=!0,b(e),x(e)),void 0!==c&&e>=c)?d.next(e-c):(t||b(e),p)}}}nu.applyToOptions=e=>{let t=function(e,t=100,r){let n=r({...e,keyframes:[0,t]}),i=Math.min(r9(n),2e4);return{type:"keyframes",ease:e=>n.next(i*e).value/t,duration:i/1e3}}(e,100,nu);return e.ease=t.ease,e.duration=r$(t.duration),e.type="keyframes",e};let nc=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e;function nd(e,t,r,n){return e===t&&r===n?ti:i=>0===i||1===i?i:nc(function(e,t,r,n,i){let s,a,o=0;do(s=nc(a=t+(r-t)/2,n,i)-e)>0?r=a:t=a;while(Math.abs(s)>1e-7&&++o<12)return a}(i,0,1,e,r),t,n)}let nf=nd(.42,0,1,1),np=nd(0,0,.58,1),nm=nd(.42,0,.58,1),ng=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,ny=e=>t=>1-e(1-t),nv=nd(.33,1.53,.69,.99),nw=ny(nv),nb=ng(nw),nx=e=>(e*=2)<1?.5*nw(e):.5*(2-Math.pow(2,-10*(e-1))),nI=e=>1-Math.sin(Math.acos(e)),nT=ny(nI),nE=ng(nI),nS=e=>Array.isArray(e)&&"number"==typeof e[0],n_={linear:ti,easeIn:nf,easeInOut:nm,easeOut:np,circIn:nI,circInOut:nE,circOut:nT,backIn:nw,backInOut:nb,backOut:nv,anticipate:nx},nk=e=>{if(nS(e)){eK(4===e.length,"Cubic bezier arrays must contain four numerical values.","cubic-bezier-length");let[t,r,n,i]=e;return nd(t,r,n,i)}return"string"==typeof e?(eK(void 0!==n_[e],`Invalid easing type '${e}'`,"invalid-easing-type"),n_[e]):e},nC=(e,t,r)=>{let n=t-e;return 0===n?1:(r-e)/n};function nA({duration:e=300,keyframes:t,times:r,ease:n="easeInOut"}){var i;let s,a=Array.isArray(n)&&"number"!=typeof n[0]?n.map(nk):nk(n),o={done:!1,value:t[0]},l=function(e,t,{clamp:r=!0,ease:n,mixer:i}={}){let s=e.length;if(eK(s===t.length,"Both input and output ranges must be the same length","range-length"),1===s)return()=>t[0];if(2===s&&t[0]===t[1])return()=>t[1];let a=e[0]===e[1];e[0]>e[s-1]&&(e=[...e].reverse(),t=[...t].reverse());let o=function(e,t,r){let n=[],i=r||ts.mix||r4,s=e.length-1;for(let r=0;r<s;r++){let s=i(e[r],e[r+1]);t&&(s=rK(Array.isArray(t)?t[r]||ti:t,s)),n.push(s)}return n}(t,n,i),l=o.length,u=r=>{if(a&&r<e[0])return t[0];let n=0;if(l>1)for(;n<e.length-2&&!(r<e[n+1]);n++);let i=nC(e[n],e[n+1],r);return o[n](i)};return r?t=>u(X(e[0],e[s-1],t)):u}((i=r&&r.length===t.length?r:(!function(e,t){let r=e[e.length-1];for(let n=1;n<=t;n++){let i=nC(0,t,n);e.push(t8(r,1,i))}}(s=[0],t.length-1),s),i.map(t=>t*e)),t,{ease:Array.isArray(a)?a:t.map(()=>a||nm).splice(0,t.length-1)});return{calculatedDuration:e,next:t=>(o.value=l(t),o.done=t>=e,o)}}let nD=e=>null!==e;function nN(e,{repeat:t,repeatType:r="loop"},n,i=1){let s=e.filter(nD),a=i<0||t&&"loop"!==r&&t%2==1?0:s.length-1;return a&&void 0!==n?n:s[a]}let nP={decay:nh,inertia:nh,tween:nA,keyframes:nA,spring:nu};function nR(e){"string"==typeof e.type&&(e.type=nP[e.type])}class nM{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,t){return this.finished.then(e,t)}}let nO=e=>e/100;class nL extends nM{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{let{motionValue:e}=this.options;e&&e.updatedAt!==tk.now()&&this.tick(tk.now()),this.isStopped=!0,"idle"!==this.state&&(this.teardown(),this.options.onStop?.())},rH.mainThread++,this.options=e,this.initAnimation(),this.play(),!1===e.autoplay&&this.pause()}initAnimation(){let{options:e}=this;nR(e);let{type:t=nA,repeat:r=0,repeatDelay:n=0,repeatType:i,velocity:s=0}=e,{keyframes:a}=e,o=t||nA;o!==nA&&"number"!=typeof a[0]&&(this.mixKeyframes=rK(nO,r4(a[0],a[1])),a=[0,100]);let l=o({...e,keyframes:a});"mirror"===i&&(this.mirroredGenerator=o({...e,keyframes:[...a].reverse(),velocity:-s})),null===l.calculatedDuration&&(l.calculatedDuration=r9(l));let{calculatedDuration:u}=l;this.calculatedDuration=u,this.resolvedDuration=u+n,this.totalDuration=this.resolvedDuration*(r+1)-n,this.generator=l}updateTime(e){let t=Math.round(e-this.startTime)*this.playbackSpeed;null!==this.holdTime?this.currentTime=this.holdTime:this.currentTime=t}tick(e,t=!1){let{generator:r,totalDuration:n,mixKeyframes:i,mirroredGenerator:s,resolvedDuration:a,calculatedDuration:o}=this;if(null===this.startTime)return r.next(0);let{delay:l=0,keyframes:u,repeat:h,repeatType:c,repeatDelay:d,type:f,onUpdate:p,finalKeyframe:m}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-n/this.speed,this.startTime)),t?this.currentTime=e:this.updateTime(e);let g=this.currentTime-l*(this.playbackSpeed>=0?1:-1),y=this.playbackSpeed>=0?g<0:g>n;this.currentTime=Math.max(g,0),"finished"===this.state&&null===this.holdTime&&(this.currentTime=n);let v=this.currentTime,w=r;if(h){let e=Math.min(this.currentTime,n)/a,t=Math.floor(e),r=e%1;!r&&e>=1&&(r=1),1===r&&t--,(t=Math.min(t,h+1))%2&&("reverse"===c?(r=1-r,d&&(r-=d/a)):"mirror"===c&&(w=s)),v=X(0,1,r)*a}let b=y?{done:!1,value:u[0]}:w.next(v);i&&(b.value=i(b.value));let{done:x}=b;y||null===o||(x=this.playbackSpeed>=0?this.currentTime>=n:this.currentTime<=0);let I=null===this.holdTime&&("finished"===this.state||"running"===this.state&&x);return I&&f!==nh&&(b.value=nN(u,this.options,m,this.speed)),p&&p(b.value),I&&this.finish(),b}then(e,t){return this.finished.then(e,t)}get duration(){return this.calculatedDuration/1e3}get iterationDuration(){let{delay:e=0}=this.options||{};return this.duration+e/1e3}get time(){return this.currentTime/1e3}set time(e){e=r$(e),this.currentTime=e,null===this.startTime||null!==this.holdTime||0===this.playbackSpeed?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(tk.now());let t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=this.currentTime/1e3)}play(){if(this.isStopped)return;let{driver:e=r8,startTime:t}=this.options;this.driver||(this.driver=e(e=>this.tick(e))),this.options.onPlay?.();let r=this.driver.now();"finished"===this.state?(this.updateFinished(),this.startTime=r):null!==this.holdTime?this.startTime=r-this.holdTime:this.startTime||(this.startTime=t??r),"finished"===this.state&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(tk.now()),this.holdTime=this.currentTime}complete(){"running"!==this.state&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null,rH.mainThread--}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),e.observe(this)}}function nV(e){let t;return()=>(void 0===t&&(t=e()),t)}let nF=nV(()=>void 0!==window.ScrollTimeline),nj={},nU=(l=nV(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch(e){return!1}return!0}),()=>nj.linearEasing??l()),nB=([e,t,r,n])=>`cubic-bezier(${e}, ${t}, ${r}, ${n})`,nz={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:nB([0,.65,.55,1]),circOut:nB([.55,0,1,.45]),backIn:nB([.31,.01,.66,-.59]),backOut:nB([.33,1.53,.69,.99])};function nq(e){return"function"==typeof e&&"applyToOptions"in e}class n$ extends nM{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,this.manualStartTime=null,!e)return;const{element:t,name:r,keyframes:n,pseudoElement:i,allowFlatten:s=!1,finalKeyframe:a,onComplete:o}=e;this.isPseudoElement=!!i,this.allowFlatten=s,this.options=e,eK("string"!=typeof e.type,'Mini animate() doesn\'t support "type" as a string.',"mini-spring");const l=function({type:e,...t}){return nq(e)&&nU()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}(e);this.animation=function(e,t,r,{delay:n=0,duration:i=300,repeat:s=0,repeatType:a="loop",ease:o="easeOut",times:l}={},u){let h={[t]:r};l&&(h.offset=l);let c=function e(t,r){if(t)return"function"==typeof t?nU()?r7(t,r):"ease-out":nS(t)?nB(t):Array.isArray(t)?t.map(t=>e(t,r)||nz.easeOut):nz[t]}(o,i);Array.isArray(c)&&(h.easing=c);let d={delay:n,duration:i,easing:Array.isArray(c)?"linear":c,fill:"both",iterations:s+1,direction:"reverse"===a?"alternate":"normal"};u&&(d.pseudoElement=u);let f=e.animate(h,d);return f}(t,r,n,l,i),!1===l.autoplay&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!i){let e=nN(n,this.options,a,this.speed);this.updateMotionValue?this.updateMotionValue(e):r.startsWith("--")?t.style.setProperty(r,e):t.style[r]=e,this.animation.cancel()}o?.(),this.notifyFinished()}}play(){this.isStopped||(this.manualStartTime=null,this.animation.play(),"finished"===this.state&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch(e){}}stop(){if(this.isStopped)return;this.isStopped=!0;let{state:e}=this;"idle"!==e&&"finished"!==e&&(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){return Number(this.animation.effect?.getComputedTiming?.().duration||0)/1e3}get iterationDuration(){let{delay:e=0}=this.options||{};return this.duration+e/1e3}get time(){return(Number(this.animation.currentTime)||0)/1e3}set time(e){this.manualStartTime=null,this.finishedTime=null,this.animation.currentTime=r$(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return null!==this.finishedTime?"finished":this.animation.playState}get startTime(){return this.manualStartTime??Number(this.animation.startTime)}set startTime(e){this.manualStartTime=this.animation.startTime=e}attachTimeline({timeline:e,observe:t}){return(this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,e&&nF())?(this.animation.timeline=e,ti):t(this)}}let nG={anticipate:nx,backInOut:nb,circInOut:nE};class nK extends n${constructor(e){!function(e){"string"==typeof e.ease&&e.ease in nG&&(e.ease=nG[e.ease])}(e),nR(e),super(e),void 0!==e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){let{motionValue:t,onUpdate:r,onComplete:n,element:i,...s}=this.options;if(!t)return;if(void 0!==e)return void t.set(e);let a=new nL({...s,autoplay:!1}),o=Math.max(10,tk.now()-this.startTime),l=X(0,10,o-10);t.setWithVelocity(a.sample(Math.max(0,o-l)).value,a.sample(o).value,l),a.stop()}}let nH=(e,t)=>"zIndex"!==t&&!!("number"==typeof e||Array.isArray(e)||"string"==typeof e&&(ek.test(e)||"0"===e)&&!e.startsWith("url("));function nW(e){e.duration=0,e.type="keyframes"}let nQ=new Set(["opacity","clipPath","filter","transform"]),nJ=nV(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));class nY extends nM{constructor({autoplay:e=!0,delay:t=0,type:r="keyframes",repeat:n=0,repeatDelay:i=0,repeatType:s="loop",keyframes:a,name:o,motionValue:l,element:u,...h}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=tk.now();const c={autoplay:e,delay:t,type:r,repeat:n,repeatDelay:i,repeatType:s,name:o,motionValue:l,element:u,...h},d=u?.KeyframeResolver||tv;this.keyframeResolver=new d(a,(e,t,r)=>this.onKeyframesResolved(e,t,c,!r),o,l,u),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(e,t,r,n){this.keyframeResolver=void 0;let{name:i,type:s,velocity:a,delay:o,isHandoff:l,onUpdate:u}=r;this.resolvedAt=tk.now(),!function(e,t,r,n){let i=e[0];if(null===i)return!1;if("display"===t||"visibility"===t)return!0;let s=e[e.length-1],a=nH(i,t),o=nH(s,t);return eG(a===o,`You are trying to animate ${t} from "${i}" to "${s}". "${a?s:i}" is not an animatable value.`,"value-not-animatable"),!!a&&!!o&&(function(e){let t=e[0];if(1===e.length)return!0;for(let r=0;r<e.length;r++)if(e[r]!==t)return!0}(e)||("spring"===r||nq(r))&&n)}(e,i,s,a)&&((ts.instantAnimations||!o)&&u?.(nN(e,r,t)),e[0]=e[e.length-1],nW(r),r.repeat=0);let h={startTime:n?this.resolvedAt&&this.resolvedAt-this.createdAt>40?this.resolvedAt:this.createdAt:void 0,finalKeyframe:t,...r,keyframes:e},c=!l&&function(e){let{motionValue:t,name:r,repeatDelay:n,repeatType:i,damping:s,type:a}=e;if(!(t?.owner?.current instanceof HTMLElement))return!1;let{onUpdate:o,transformTemplate:l}=t.owner.getProps();return nJ()&&r&&nQ.has(r)&&("transform"!==r||!l)&&!o&&!n&&"mirror"!==i&&0!==s&&"inertia"!==a}(h),d=h.motionValue?.owner?.current,f=c?new nK({...h,element:d}):new nL(h);f.finished.then(()=>{this.notifyFinished()}).catch(ti),this.pendingTimeline&&(this.stopTimeline=f.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=f}get finished(){return this._animation?this.animation.finished:this._finished}then(e,t){return this.finished.finally(e).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),tm=!0,ty(),tg(),tm=!1),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}let nX={type:"spring",stiffness:500,damping:25,restSpeed:10},nZ={type:"keyframes",duration:.8},n0={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},n1=e=>null!==e,n2=(e,t,r,n={},i,s)=>a=>{let o=rB(n,e)||{},l=o.delay||n.delay||0,{elapsed:u=0}=n;u-=r$(l);let h={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:t.getVelocity(),...o,delay:-u,onUpdate:e=>{t.set(e),o.onUpdate&&o.onUpdate(e)},onComplete:()=>{a(),o.onComplete&&o.onComplete()},name:e,motionValue:t,element:s?void 0:i};!function({when:e,delay:t,delayChildren:r,staggerChildren:n,staggerDirection:i,repeat:s,repeatType:a,repeatDelay:o,from:l,elapsed:u,...h}){return!!Object.keys(h).length}(o)&&Object.assign(h,((e,{keyframes:t})=>t.length>2?nZ:Y.has(e)?e.startsWith("scale")?{type:"spring",stiffness:550,damping:0===t[1]?2*Math.sqrt(550):30,restSpeed:10}:nX:n0)(e,h)),h.duration&&(h.duration=r$(h.duration)),h.repeatDelay&&(h.repeatDelay=r$(h.repeatDelay)),void 0!==h.from&&(h.keyframes[0]=h.from);let c=!1;if(!1!==h.type&&(0!==h.duration||h.repeatDelay)||(nW(h),0===h.delay&&(c=!0)),(ts.instantAnimations||ts.skipAnimations)&&(c=!0,nW(h),h.delay=0),h.allowFlatten=!o.type&&!o.ease,c&&!s&&void 0!==t.get()){let e=function(e,{repeat:t,repeatType:r="loop"},n){let i=e.filter(n1),s=t&&"loop"!==r&&t%2==1?0:i.length-1;return i[s]}(h.keyframes,o);if(void 0!==e)return void tl.update(()=>{h.onUpdate(e),h.onComplete()})}return o.isSync?new nL(h):new nY(h)};function n5(e,t,{delay:r=0,transitionOverride:n,type:i}={}){let{transition:s=e.getDefaultTransition(),transitionEnd:a,...o}=t,l=s?.reduceMotion;n&&(s=n);let u=[],h=i&&e.animationState&&e.animationState.getState()[i];for(let t in o){let n=e.getValue(t,e.latestValues[t]??null),i=o[t];if(void 0===i||h&&function({protectedKeys:e,needsAnimating:t},r){let n=e.hasOwnProperty(r)&&!0!==t[r];return t[r]=!1,n}(h,t))continue;let a={delay:r,...rB(s||{},t)},c=n.get();if(void 0!==c&&!n.isAnimating&&!Array.isArray(i)&&i===c&&!a.velocity)continue;let d=!1;if(window.MotionHandoffAnimation){let r=e.props[rO];if(r){let e=window.MotionHandoffAnimation(r,t,tl);null!==e&&(a.startTime=e,d=!0)}}rq(e,t);let f=l??e.shouldReduceMotion;n.start(n2(t,n,i,f&&eB.has(t)?{type:!1}:a,e,d));let p=n.animation;p&&u.push(p)}return a&&Promise.all(u).then(()=>{tl.update(()=>{a&&function(e,t){let{transitionEnd:r={},transition:n={},...i}=rU(e,t)||{};for(let t in i={...i,...r}){var s;let r=rz(s=i[t])?s[s.length-1]||0:s;e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,tA(r))}}(e,a)})}),u}function n6(e,t,r,n=0,i=1){let s=Array.from(e).sort((e,t)=>e.sortNodePosition(t)).indexOf(t),a=e.size,o=(a-1)*n;return"function"==typeof r?r(s,a):1===i?s*n:o-s*n}function n3(e,t,r={}){let n=rU(e,t,"exit"===r.type?e.presenceContext?.custom:void 0),{transition:i=e.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(i=r.transitionOverride);let s=n?()=>Promise.all(n5(e,n,r)):()=>Promise.resolve(),a=e.variantChildren&&e.variantChildren.size?(n=0)=>{let{delayChildren:s=0,staggerChildren:a,staggerDirection:o}=i;return function(e,t,r=0,n=0,i=0,s=1,a){let o=[];for(let l of e.variantChildren)l.notify("AnimationStart",t),o.push(n3(l,t,{...a,delay:r+("function"==typeof n?0:n)+n6(e.variantChildren,l,n,i,s)}).then(()=>l.notify("AnimationComplete",t)));return Promise.all(o)}(e,t,n,s,a,o,r)}:()=>Promise.resolve(),{when:o}=i;if(!o)return Promise.all([s(),a(r.delay)]);{let[e,t]="beforeChildren"===o?[s,a]:[a,s];return e().then(()=>t())}}let n4=tF.length;function n8(e,t){if(!Array.isArray(t))return!1;let r=t.length;if(r!==e.length)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}let n7=[...tV].reverse(),n9=tV.length;function ie(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function it(){return{animate:ie(!0),whileInView:ie(),whileHover:ie(),whileTap:ie(),whileDrag:ie(),whileFocus:ie(),exit:ie()}}let ir=0;function ii(e){return[e("x"),e("y")]}let is=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function ia(e){return is.has(e.tagName)||!0===e.isContentEditable}function io(e,t,r,n={passive:!0}){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r)}let il={x:!1,y:!1};function iu(e){return e.max-e.min}function ih(e,t,r,n=.5){e.origin=n,e.originPoint=t8(t.min,t.max,e.origin),e.scale=iu(r)/iu(t),e.translate=t8(r.min,r.max,e.origin)-e.originPoint,(e.scale>=.9999&&e.scale<=1.0001||isNaN(e.scale))&&(e.scale=1),(e.translate>=-.01&&e.translate<=.01||isNaN(e.translate))&&(e.translate=0)}function ic(e,t,r,n){ih(e.x,t.x,r.x,n?n.originX:void 0),ih(e.y,t.y,r.y,n?n.originY:void 0)}function id(e,t,r){e.min=r.min+t.min,e.max=e.min+iu(t)}function ip(e,t,r){e.min=t.min-r.min,e.max=e.min+iu(t)}function im(e,t,r){ip(e.x,t.x,r.x),ip(e.y,t.y,r.y)}let ig=e=>"mouse"===e.pointerType?"number"!=typeof e.button||e.button<=0:!1!==e.isPrimary;function iy(e){return{point:{x:e.pageX,y:e.pageY}}}function iv(e,t,r,n){return io(e,t,e=>ig(e)&&r(e,iy(e)),n)}let iw=({current:e})=>e?e.ownerDocument.defaultView:null,ib=(e,t)=>Math.abs(e-t),ix=new Set(["auto","scroll"]);class iI{constructor(e,t,{transformPagePoint:r,contextWindow:n=window,dragSnapToOrigin:i=!1,distanceThreshold:s=3,element:a}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.scrollPositions=new Map,this.removeScrollListeners=null,this.onElementScroll=e=>{this.handleScroll(e.target)},this.onWindowScroll=()=>{this.handleScroll(window)},this.updatePoint=()=>{var e,t;if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;let r=iS(this.lastMoveEventInfo,this.history),n=null!==this.startEvent,i=(e=r.offset,t={x:0,y:0},Math.sqrt(ib(e.x,t.x)**2+ib(e.y,t.y)**2)>=this.distanceThreshold);if(!n&&!i)return;let{point:s}=r,{timestamp:a}=th;this.history.push({...s,timestamp:a});let{onStart:o,onMove:l}=this.handlers;n||(o&&o(this.lastMoveEvent,r),this.startEvent=this.lastMoveEvent),l&&l(this.lastMoveEvent,r)},this.handlePointerMove=(e,t)=>{this.lastMoveEvent=e,this.lastMoveEventInfo=iT(t,this.transformPagePoint),tl.update(this.updatePoint,!0)},this.handlePointerUp=(e,t)=>{this.end();let{onEnd:r,onSessionEnd:n,resumeAnimation:i}=this.handlers;if((this.dragSnapToOrigin||!this.startEvent)&&i&&i(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;let s=iS("pointercancel"===e.type?this.lastMoveEventInfo:iT(t,this.transformPagePoint),this.history);this.startEvent&&r&&r(e,s),n&&n(e,s)},!ig(e))return;this.dragSnapToOrigin=i,this.handlers=t,this.transformPagePoint=r,this.distanceThreshold=s,this.contextWindow=n||window;const o=iT(iy(e),this.transformPagePoint),{point:l}=o,{timestamp:u}=th;this.history=[{...l,timestamp:u}];const{onSessionStart:h}=t;h&&h(e,iS(o,this.history)),this.removeListeners=rK(iv(this.contextWindow,"pointermove",this.handlePointerMove),iv(this.contextWindow,"pointerup",this.handlePointerUp),iv(this.contextWindow,"pointercancel",this.handlePointerUp)),a&&this.startScrollTracking(a)}startScrollTracking(e){let t=e.parentElement;for(;t;){let e=getComputedStyle(t);(ix.has(e.overflowX)||ix.has(e.overflowY))&&this.scrollPositions.set(t,{x:t.scrollLeft,y:t.scrollTop}),t=t.parentElement}this.scrollPositions.set(window,{x:window.scrollX,y:window.scrollY}),window.addEventListener("scroll",this.onElementScroll,{capture:!0,passive:!0}),window.addEventListener("scroll",this.onWindowScroll,{passive:!0}),this.removeScrollListeners=()=>{window.removeEventListener("scroll",this.onElementScroll,{capture:!0}),window.removeEventListener("scroll",this.onWindowScroll)}}handleScroll(e){let t=this.scrollPositions.get(e);if(!t)return;let r=e===window,n=r?{x:window.scrollX,y:window.scrollY}:{x:e.scrollLeft,y:e.scrollTop},i={x:n.x-t.x,y:n.y-t.y};(0!==i.x||0!==i.y)&&(r?this.lastMoveEventInfo&&(this.lastMoveEventInfo.point.x+=i.x,this.lastMoveEventInfo.point.y+=i.y):this.history.length>0&&(this.history[0].x-=i.x,this.history[0].y-=i.y),this.scrollPositions.set(e,n),tl.update(this.updatePoint,!0))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),this.removeScrollListeners&&this.removeScrollListeners(),this.scrollPositions.clear(),tu(this.updatePoint)}}function iT(e,t){return t?{point:t(e.point)}:e}function iE(e,t){return{x:e.x-t.x,y:e.y-t.y}}function iS({point:e},t){return{point:e,delta:iE(e,i_(t)),offset:iE(e,t[0]),velocity:function(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,n=null,i=i_(e);for(;r>=0&&(n=e[r],!(i.timestamp-n.timestamp>r$(.1)));)r--;if(!n)return{x:0,y:0};let s=(i.timestamp-n.timestamp)/1e3;if(0===s)return{x:0,y:0};let a={x:(i.x-n.x)/s,y:(i.y-n.y)/s};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}(t,.1)}}function i_(e){return e[e.length-1]}function ik(e,t,r){return{min:void 0!==t?e.min+t:void 0,max:void 0!==r?e.max+r-(e.max-e.min):void 0}}function iC(e,t){let r=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,n]=[n,r]),{min:r,max:n}}function iA(e,t,r){return{min:iD(e,t),max:iD(e,r)}}function iD(e,t){return"number"==typeof e?e:e[t]||0}let iN=new WeakMap;class iP{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=ej(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:t=!1,distanceThreshold:r}={}){let{presenceContext:n}=this.visualElement;if(n&&!1===n.isPresent)return;let i=e=>{t?(this.stopAnimation(),this.snapToCursor(iy(e).point)):this.pauseAnimation()},s=(e,t)=>{this.stopAnimation();let{drag:r,dragPropagation:n,onDragStart:i}=this.getProps();if(r&&!n&&(this.openDragLock&&this.openDragLock(),this.openDragLock=function(e){if("x"===e||"y"===e)if(il[e])return null;else return il[e]=!0,()=>{il[e]=!1};return il.x||il.y?null:(il.x=il.y=!0,()=>{il.x=il.y=!1})}(r),!this.openDragLock))return;this.latestPointerEvent=e,this.latestPanInfo=t,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),ii(e=>{let t=this.getAxisMotionValue(e).get()||0;if(ed.test(t)){let{projection:r}=this.visualElement;if(r&&r.layout){let n=r.layout.layoutBox[e];n&&(t=iu(n)*(parseFloat(t)/100))}}this.originPoint[e]=t}),i&&tl.postRender(()=>i(e,t)),rq(this.visualElement,"transform");let{animationState:s}=this.visualElement;s&&s.setActive("whileDrag",!0)},a=(e,t)=>{this.latestPointerEvent=e,this.latestPanInfo=t;let{dragPropagation:r,dragDirectionLock:n,onDirectionLock:i,onDrag:s}=this.getProps();if(!r&&!this.openDragLock)return;let{offset:a}=t;if(n&&null===this.currentDirection){this.currentDirection=function(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}(a),null!==this.currentDirection&&i&&i(this.currentDirection);return}this.updateAxis("x",t.point,a),this.updateAxis("y",t.point,a),this.visualElement.render(),s&&s(e,t)},o=(e,t)=>{this.latestPointerEvent=e,this.latestPanInfo=t,this.stop(e,t),this.latestPointerEvent=null,this.latestPanInfo=null},l=()=>ii(e=>"paused"===this.getAnimationState(e)&&this.getAxisMotionValue(e).animation?.play()),{dragSnapToOrigin:u}=this.getProps();this.panSession=new iI(e,{onSessionStart:i,onStart:s,onMove:a,onSessionEnd:o,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,distanceThreshold:r,contextWindow:iw(this.visualElement),element:this.visualElement.current})}stop(e,t){let r=e||this.latestPointerEvent,n=t||this.latestPanInfo,i=this.isDragging;if(this.cancel(),!i||!n||!r)return;let{velocity:s}=n;this.startAnimation(s);let{onDragEnd:a}=this.getProps();a&&tl.postRender(()=>a(r,n))}cancel(){this.isDragging=!1;let{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.endPanSession();let{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}endPanSession(){this.panSession&&this.panSession.end(),this.panSession=void 0}updateAxis(e,t,r){let{drag:n}=this.getProps();if(!r||!iR(e,n,this.currentDirection))return;let i=this.getAxisMotionValue(e),s=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(s=function(e,{min:t,max:r},n){return void 0!==t&&e<t?e=n?t8(t,e,n.min):Math.max(e,t):void 0!==r&&e>r&&(e=n?t8(r,e,n.max):Math.min(e,r)),e}(s,this.constraints[e],this.elastic[e])),i.set(s)}resolveConstraints(){let{dragConstraints:e,dragElastic:t}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,n=this.constraints;e&&rV(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&r?this.constraints=function(e,{top:t,left:r,bottom:n,right:i}){return{x:ik(e.x,r,i),y:ik(e.y,t,n)}}(r.layoutBox,e):this.constraints=!1,this.elastic=function(e=.35){return!1===e?e=0:!0===e&&(e=.35),{x:iA(e,"left","right"),y:iA(e,"top","bottom")}}(t),n!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&ii(e=>{var t,n;let i;!1!==this.constraints&&this.getAxisMotionValue(e)&&(this.constraints[e]=(t=r.layoutBox[e],n=this.constraints[e],i={},void 0!==n.min&&(i.min=n.min-t.min),void 0!==n.max&&(i.max=n.max-t.min),i))})}resolveRefConstraints(){var e;let{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!rV(t))return!1;let n=t.current;eK(null!==n,"If `dragConstraints` is set as a React ref, that ref must be passed to another component's `ref` prop.","drag-constraints-ref");let{projection:i}=this.visualElement;if(!i||!i.layout)return!1;let s=function(e,t,r){let n=rp(e,r),{scroll:i}=t;return i&&(rc(n.x,i.offset.x),rc(n.y,i.offset.y)),n}(n,i.root,this.visualElement.getTransformPagePoint()),a=(e=i.layout.layoutBox,{x:iC(e.x,s.x),y:iC(e.y,s.y)});if(r){let e=r(function({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}(a));this.hasMutatedConstraints=!!e,e&&(a=rn(e))}return a}startAnimation(e){let{drag:t,dragMomentum:r,dragElastic:n,dragTransition:i,dragSnapToOrigin:s,onDragTransitionEnd:a}=this.getProps(),o=this.constraints||{};return Promise.all(ii(a=>{if(!iR(a,t,this.currentDirection))return;let l=o&&o[a]||{};s&&(l={min:0,max:0});let u={type:"inertia",velocity:r?e[a]:0,bounceStiffness:n?200:1e6,bounceDamping:n?40:1e7,timeConstant:750,restDelta:1,restSpeed:10,...i,...l};return this.startAxisValueAnimation(a,u)})).then(a)}startAxisValueAnimation(e,t){let r=this.getAxisMotionValue(e);return rq(this.visualElement,e),r.start(n2(e,r,0,t,this.visualElement,!1))}stopAnimation(){ii(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){ii(e=>this.getAxisMotionValue(e).animation?.pause())}getAnimationState(e){return this.getAxisMotionValue(e).animation?.state}getAxisMotionValue(e){let t=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps();return r[t]||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){ii(t=>{let{drag:r}=this.getProps();if(!iR(t,r,this.currentDirection))return;let{projection:n}=this.visualElement,i=this.getAxisMotionValue(t);if(n&&n.layout){let{min:r,max:s}=n.layout.layoutBox[t],a=i.get()||0;i.set(e[t]-t8(r,s,.5)+a)}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;let{drag:e,dragConstraints:t}=this.getProps(),{projection:r}=this.visualElement;if(!rV(t)||!r||!this.constraints)return;this.stopAnimation();let n={x:0,y:0};ii(e=>{let t=this.getAxisMotionValue(e);if(t&&!1!==this.constraints){var r,i;let s,a,o,l=t.get();n[e]=(r={min:l,max:l},i=this.constraints[e],s=.5,a=iu(r),(o=iu(i))>a?s=nC(i.min,i.max-a,r.min):a>o&&(s=nC(r.min,r.max-o,i.min)),X(0,1,s))}});let{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),ii(t=>{if(!iR(t,e,null))return;let r=this.getAxisMotionValue(t),{min:i,max:s}=this.constraints[t];r.set(t8(i,s,n[t]))})}addListeners(){if(!this.visualElement.current)return;iN.set(this.visualElement,this);let e=this.visualElement.current,t=iv(e,"pointerdown",t=>{let{drag:r,dragListener:n=!0}=this.getProps(),i=t.target,s=i!==e&&ia(i);r&&n&&!s&&this.start(t)}),r=()=>{let{dragConstraints:e}=this.getProps();rV(e)&&e.current&&(this.constraints=this.resolveRefConstraints())},{projection:n}=this.visualElement,i=n.addEventListener("measure",r);n&&!n.layout&&(n.root&&n.root.updateScroll(),n.updateLayout()),tl.read(r);let s=io(window,"resize",()=>this.scalePositionWithinConstraints()),a=n.addEventListener("didUpdate",({delta:e,hasLayoutChanged:t})=>{this.isDragging&&t&&(ii(t=>{let r=this.getAxisMotionValue(t);r&&(this.originPoint[t]+=e[t].translate,r.set(r.get()+e[t].translate))}),this.visualElement.render())});return()=>{s(),t(),i(),a&&a()}}getProps(){let e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:r=!1,dragPropagation:n=!1,dragConstraints:i=!1,dragElastic:s=.35,dragMomentum:a=!0}=e;return{...e,drag:t,dragDirectionLock:r,dragPropagation:n,dragConstraints:i,dragElastic:s,dragMomentum:a}}}function iR(e,t,r){return(!0===t||t===e)&&(null===r||r===e)}let iM=e=>(t,r)=>{e&&tl.postRender(()=>e(t,r))},iO={hasAnimatedSinceResize:!0,hasEverUpdated:!1};var iL=D;let iV=!1;class iF extends iL.Component{componentDidMount(){let{visualElement:e,layoutGroup:t,switchLayoutGroup:r,layoutId:n}=this.props,{projection:i}=e;i&&(t.group&&t.group.add(i),r&&r.register&&n&&r.register(i),iV&&i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,layoutDependency:this.props.layoutDependency,onExitComplete:()=>this.safeToRemove()})),iO.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){let{layoutDependency:t,visualElement:r,drag:n,isPresent:i}=this.props,{projection:s}=r;return s&&(s.isPresent=i,e.layoutDependency!==t&&s.setOptions({...s.options,layoutDependency:t}),iV=!0,n||e.layoutDependency!==t||void 0===t||e.isPresent!==i?s.willUpdate():this.safeToRemove(),e.isPresent!==i&&(i?s.promote():s.relegate()||tl.postRender(()=>{let e=s.getStack();e&&e.members.length||this.safeToRemove()}))),null}componentDidUpdate(){let{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),tS.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){let{visualElement:e,layoutGroup:t,switchLayoutGroup:r}=this.props,{projection:n}=e;iV=!0,n&&(n.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(n),r&&r.deregister&&r.deregister(n))}safeToRemove(){let{safeToRemove:e}=this.props;e&&e()}render(){return null}}function ij(e){let[t,r]=K(),n=(0,iL.useContext)(P);return(0,A.jsx)(iF,{...e,layoutGroup:n,switchLayoutGroup:(0,iL.useContext)(rL),isPresent:t,safeToRemove:r})}function iU(e){return V(e)&&"ownerSVGElement"in e}let iB=["TopLeft","TopRight","BottomLeft","BottomRight"],iz=iB.length,iq=e=>"string"==typeof e?parseFloat(e):e,i$=e=>"number"==typeof e||ef.test(e);function iG(e,t){return void 0!==e[t]?e[t]:e.borderRadius}let iK=iW(0,.5,nT),iH=iW(.5,.95,ti);function iW(e,t,r){return n=>n<e?0:n>t?1:r(nC(e,t,n))}function iQ(e,t){e.min=t.min,e.max=t.max}function iJ(e,t){iQ(e.x,t.x),iQ(e.y,t.y)}function iY(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function iX(e,t,r,n,i){return e-=t,e=n+1/r*(e-n),void 0!==i&&(e=n+1/i*(e-n)),e}function iZ(e,t,[r,n,i],s,a){!function(e,t=0,r=1,n=.5,i,s=e,a=e){if(ed.test(t)&&(t=parseFloat(t),t=t8(a.min,a.max,t/100)-a.min),"number"!=typeof t)return;let o=t8(s.min,s.max,n);e===s&&(o-=t),e.min=iX(e.min,t,r,o,i),e.max=iX(e.max,t,r,o,i)}(e,t[r],t[n],t[i],t.scale,s,a)}let i0=["x","scaleX","originX"],i1=["y","scaleY","originY"];function i2(e,t,r,n){iZ(e.x,t,i0,r?r.x:void 0,n?n.x:void 0),iZ(e.y,t,i1,r?r.y:void 0,n?n.y:void 0)}function i5(e){return 0===e.translate&&1===e.scale}function i6(e){return i5(e.x)&&i5(e.y)}function i3(e,t){return e.min===t.min&&e.max===t.max}function i4(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function i8(e,t){return i4(e.x,t.x)&&i4(e.y,t.y)}function i7(e){return iu(e.x)/iu(e.y)}function i9(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class se{constructor(){this.members=[]}add(e){tI(this.members,e),e.scheduleRender()}remove(e){if(tT(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){let e=this.members[this.members.length-1];e&&this.promote(e)}}relegate(e){let t,r=this.members.findIndex(t=>e===t);if(0===r)return!1;for(let e=r;e>=0;e--){let r=this.members[e];if(!1!==r.isPresent){t=r;break}}return!!t&&(this.promote(t),!0)}promote(e,t){let r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender();let n=r.options.layoutDependency,i=e.options.layoutDependency;(void 0===n||void 0===i||n!==i)&&(e.resumeFrom=r,t&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0));let{crossfade:s}=e.options;!1===s&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{let{options:t,resumingFrom:r}=e;t.onExitComplete&&t.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}let st=(e,t)=>e.depth-t.depth;class sr{constructor(){this.children=[],this.isDirty=!1}add(e){tI(this.children,e),this.isDirty=!0}remove(e){tT(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(st),this.isDirty=!1,this.children.forEach(e)}}let sn=["","X","Y","Z"],si=0;function ss(e,t,r,n){let{latestValues:i}=t;i[e]&&(r[e]=i[e],t.setStaticValue(e,0),n&&(n[e]=0))}function sa({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:n,resetTransform:i}){return class{constructor(e={},r=t?.()){this.id=si++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(su),this.nodes.forEach(sg),this.nodes.forEach(sy),this.nodes.forEach(sh)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=e,this.root=r?r.root||r:this,this.path=r?[...r.path,r]:[],this.parent=r,this.depth=r?r.depth+1:0;for(let e=0;e<this.path.length;e++)this.path[e].shouldResetTransform=!0;this.root===this&&(this.nodes=new sr)}addEventListener(e,t){return this.eventHandlers.has(e)||this.eventHandlers.set(e,new tE),this.eventHandlers.get(e).add(t)}notifyListeners(e,...t){let r=this.eventHandlers.get(e);r&&r.notify(...t)}hasListeners(e){return this.eventHandlers.has(e)}mount(t){if(this.instance)return;this.isSVG=iU(t)&&!(iU(t)&&"svg"===t.tagName),this.instance=t;let{layoutId:r,layout:n,visualElement:i}=this.options;if(i&&!i.current&&i.mount(t),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(n||r)&&(this.isLayoutDirty=!0),e){let r,n=0,i=()=>this.root.updateBlockedByResize=!1;tl.read(()=>{n=window.innerWidth}),e(t,()=>{let e=window.innerWidth;if(e!==n){let t,s;n=e,this.root.updateBlockedByResize=!0,r&&r(),t=tk.now(),s=({timestamp:e})=>{let r=e-t;r>=250&&(tu(s),i(r-250))},tl.setup(s,!0),r=()=>tu(s),iO.hasAnimatedSinceResize&&(iO.hasAnimatedSinceResize=!1,this.nodes.forEach(sm))}})}r&&this.root.registerSharedNode(r,this),!1!==this.options.animate&&i&&(r||n)&&this.addEventListener("didUpdate",({delta:e,hasLayoutChanged:t,hasRelativeLayoutChanged:r,layout:n})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}let s=this.options.transition||i.getDefaultTransition()||sT,{onLayoutAnimationStart:a,onLayoutAnimationComplete:o}=i.getProps(),l=!this.targetLayout||!i8(this.targetLayout,n),u=!t&&r;if(this.options.layoutRoot||this.resumeFrom||u||t&&(l||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);let t={...rB(s,"layout"),onPlay:a,onComplete:o};(i.shouldReduceMotion||this.options.layoutRoot)&&(t.delay=0,t.type=!1),this.startAnimation(t),this.setAnimationOrigin(e,u)}else t||sm(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=n})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);let e=this.getStack();e&&e.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),tu(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){!this.isUpdateBlocked()&&(this.isUpdating=!0,this.nodes&&this.nodes.forEach(sv),this.animationId++)}getTransformTemplate(){let{visualElement:e}=this.options;return e&&e.getProps().transformTemplate}willUpdate(e=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&function e(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;let{visualElement:r}=t.options;if(!r)return;let n=r.props[rO];if(window.MotionHasOptimisedAnimation(n,"transform")){let{layout:e,layoutId:r}=t.options;window.MotionCancelOptimisedAnimation(n,"transform",tl,!(e||r))}let{parent:i}=t;i&&!i.hasCheckedOptimisedAppear&&e(i)}(this),this.root.isUpdating||this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let e=0;e<this.path.length;e++){let t=this.path[e];t.shouldResetTransform=!0,t.updateScroll("snapshot"),t.options.layoutRoot&&t.willUpdate(!1)}let{layoutId:t,layout:r}=this.options;if(void 0===t&&!r)return;let n=this.getTransformTemplate();this.prevTransformTemplateValue=n?n(this.latestValues,""):void 0,this.updateSnapshot(),e&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(sd);return}if(this.animationId<=this.animationCommitId)return void this.nodes.forEach(sf);this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(sp),this.nodes.forEach(so),this.nodes.forEach(sl)):this.nodes.forEach(sf),this.clearAllSnapshots();let e=tk.now();th.delta=X(0,1e3/60,e-th.timestamp),th.timestamp=e,th.isProcessing=!0,tc.update.process(th),tc.preRender.process(th),tc.render.process(th),th.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,tS.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(sc),this.sharedNodes.forEach(sw)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,tl.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){tl.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){!this.snapshot&&this.instance&&(this.snapshot=this.measure(),!this.snapshot||iu(this.snapshot.measuredBox.x)||iu(this.snapshot.measuredBox.y)||(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let e=0;e<this.path.length;e++)this.path[e].updateScroll();let e=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=ej(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);let{visualElement:t}=this.options;t&&t.notify("LayoutMeasure",this.layout.layoutBox,e?e.layoutBox:void 0)}updateScroll(e="measure"){let t=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===e&&(t=!1),t&&this.instance){let t=n(this.instance);this.scroll={animationId:this.root.animationId,phase:e,isRoot:t,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:t}}}resetTransform(){if(!i)return;let e=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,t=this.projectionDelta&&!i6(this.projectionDelta),r=this.getTransformTemplate(),n=r?r(this.latestValues,""):void 0,s=n!==this.prevTransformTemplateValue;e&&this.instance&&(t||ra(this.latestValues)||s)&&(i(this.instance,n),this.shouldResetTransform=!1,this.scheduleRender())}measure(e=!0){var t;let r=this.measurePageBox(),n=this.removeElementScroll(r);return e&&(n=this.removeTransform(n)),s_((t=n).x),s_(t.y),{animationId:this.root.animationId,measuredBox:r,layoutBox:n,latestValues:{},source:this.id}}measurePageBox(){let{visualElement:e}=this.options;if(!e)return ej();let t=e.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(sC))){let{scroll:e}=this.root;e&&(rc(t.x,e.offset.x),rc(t.y,e.offset.y))}return t}removeElementScroll(e){let t=ej();if(iJ(t,e),this.scroll?.wasRoot)return t;for(let r=0;r<this.path.length;r++){let n=this.path[r],{scroll:i,options:s}=n;n!==this.root&&i&&s.layoutScroll&&(i.wasRoot&&iJ(t,e),rc(t.x,i.offset.x),rc(t.y,i.offset.y))}return t}applyTransform(e,t=!1){let r=ej();iJ(r,e);for(let e=0;e<this.path.length;e++){let n=this.path[e];!t&&n.options.layoutScroll&&n.scroll&&n!==n.root&&rf(r,{x:-n.scroll.offset.x,y:-n.scroll.offset.y}),ra(n.latestValues)&&rf(r,n.latestValues)}return ra(this.latestValues)&&rf(r,this.latestValues),r}removeTransform(e){let t=ej();iJ(t,e);for(let e=0;e<this.path.length;e++){let r=this.path[e];if(!r.instance||!ra(r.latestValues))continue;rs(r.latestValues)&&r.updateSnapshot();let n=ej();iJ(n,r.measurePageBox()),i2(t,r.latestValues,r.snapshot?r.snapshot.layoutBox:void 0,n)}return ra(this.latestValues)&&i2(t,this.latestValues),t}setTargetDelta(e){this.targetDelta=e,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(e){this.options={...this.options,...e,crossfade:void 0===e.crossfade||e.crossfade}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==th.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(e=!1){let t=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=t.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=t.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=t.isSharedProjectionDirty);let r=!!this.resumingFrom||this!==t;if(!(e||r&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;let{layout:n,layoutId:i}=this.options;if(!this.layout||!(n||i))return;this.resolvedRelativeTargetAt=th.timestamp;let s=this.getClosestProjectingParent();if(s&&this.linkedParentVersion!==s.layoutVersion&&!s.options.layoutRoot&&this.removeRelativeTarget(),this.targetDelta||this.relativeTarget||(s&&s.layout?this.createRelativeTarget(s,this.layout.layoutBox,s.layout.layoutBox):this.removeRelativeTarget()),this.relativeTarget||this.targetDelta){if(this.target||(this.target=ej(),this.targetWithTransforms=ej()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target){var a,o,l;this.forceRelativeParentToResolveTarget(),a=this.target,o=this.relativeTarget,l=this.relativeParent.target,id(a.x,o.x,l.x),id(a.y,o.y,l.y)}else this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):iJ(this.target,this.layout.layoutBox),rh(this.target,this.targetDelta)):iJ(this.target,this.layout.layoutBox);this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,s&&!!s.resumingFrom==!!this.resumingFrom&&!s.options.layoutScroll&&s.target&&1!==this.animationProgress?this.createRelativeTarget(s,this.target,s.target):this.relativeParent=this.relativeTarget=void 0)}}getClosestProjectingParent(){if(!(!this.parent||rs(this.parent.latestValues)||ro(this.parent.latestValues)))if(this.parent.isProjecting())return this.parent;else return this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(e,t,r){this.relativeParent=e,this.linkedParentVersion=e.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ej(),this.relativeTargetOrigin=ej(),im(this.relativeTargetOrigin,t,r),iJ(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){let e=this.getLead(),t=!!this.resumingFrom||this!==e,r=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(r=!1),t&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(r=!1),this.resolvedRelativeTargetAt===th.timestamp&&(r=!1),r)return;let{layout:n,layoutId:i}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(n||i))return;iJ(this.layoutCorrected,this.layout.layoutBox);let s=this.treeScale.x,a=this.treeScale.y;!function(e,t,r,n=!1){let i,s,a=r.length;if(a){t.x=t.y=1;for(let o=0;o<a;o++){s=(i=r[o]).projectionDelta;let{visualElement:a}=i.options;(!a||!a.props.style||"contents"!==a.props.style.display)&&(n&&i.options.layoutScroll&&i.scroll&&i!==i.root&&rf(e,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),s&&(t.x*=s.x.scale,t.y*=s.y.scale,rh(e,s)),n&&ra(i.latestValues)&&rf(e,i.latestValues))}t.x<1.0000000000001&&t.x>.999999999999&&(t.x=1),t.y<1.0000000000001&&t.y>.999999999999&&(t.y=1)}}(this.layoutCorrected,this.treeScale,this.path,t),e.layout&&!e.target&&(1!==this.treeScale.x||1!==this.treeScale.y)&&(e.target=e.layout.layoutBox,e.targetWithTransforms=ej());let{target:o}=e;if(!o){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}this.projectionDelta&&this.prevProjectionDelta?(iY(this.prevProjectionDelta.x,this.projectionDelta.x),iY(this.prevProjectionDelta.y,this.projectionDelta.y)):this.createProjectionDeltas(),ic(this.projectionDelta,this.layoutCorrected,o,this.latestValues),this.treeScale.x===s&&this.treeScale.y===a&&i9(this.projectionDelta.x,this.prevProjectionDelta.x)&&i9(this.projectionDelta.y,this.prevProjectionDelta.y)||(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",o))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(e=!0){if(this.options.visualElement?.scheduleRender(),e){let e=this.getStack();e&&e.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=eV(),this.projectionDelta=eV(),this.projectionDeltaWithTransform=eV()}setAnimationOrigin(e,t=!1){let r,n=this.snapshot,i=n?n.latestValues:{},s={...this.latestValues},a=eV();this.relativeParent&&this.relativeParent.options.layoutRoot||(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!t;let o=ej(),l=(n?n.source:void 0)!==(this.layout?this.layout.source:void 0),u=this.getStack(),h=!u||u.members.length<=1,c=!!(l&&!h&&!0===this.options.crossfade&&!this.path.some(sI));this.animationProgress=0,this.mixTargetDelta=t=>{let n=t/1e3;if(sb(a.x,e.x,n),sb(a.y,e.y,n),this.setTargetDelta(a),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout){var u,d,f,p,m,g;im(o,this.layout.layoutBox,this.relativeParent.layout.layoutBox),f=this.relativeTarget,p=this.relativeTargetOrigin,m=o,g=n,sx(f.x,p.x,m.x,g),sx(f.y,p.y,m.y,g),r&&(u=this.relativeTarget,d=r,i3(u.x,d.x)&&i3(u.y,d.y))&&(this.isProjectionDirty=!1),r||(r=ej()),iJ(r,this.relativeTarget)}l&&(this.animationValues=s,function(e,t,r,n,i,s){i?(e.opacity=t8(0,r.opacity??1,iK(n)),e.opacityExit=t8(t.opacity??1,0,iH(n))):s&&(e.opacity=t8(t.opacity??1,r.opacity??1,n));for(let i=0;i<iz;i++){let s=`border${iB[i]}Radius`,a=iG(t,s),o=iG(r,s);(void 0!==a||void 0!==o)&&(a||(a=0),o||(o=0),0===a||0===o||i$(a)===i$(o)?(e[s]=Math.max(t8(iq(a),iq(o),n),0),(ed.test(o)||ed.test(a))&&(e[s]+="%")):e[s]=o)}(t.rotate||r.rotate)&&(e.rotate=t8(t.rotate||0,r.rotate||0,n))}(s,i,this.latestValues,n,c,h)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=n},this.mixTargetDelta(1e3*!!this.options.layoutRoot)}startAnimation(e){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(tu(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=tl.update(()=>{var t,r,n;let i;iO.hasAnimatedSinceResize=!0,rH.layout++,this.motionValue||(this.motionValue=tA(0)),this.currentAnimation=(t=this.motionValue,r=[0,1e3],n={...e,velocity:0,isSync:!0,onUpdate:t=>{this.mixTargetDelta(t),e.onUpdate&&e.onUpdate(t)},onStop:()=>{rH.layout--},onComplete:()=>{rH.layout--,e.onComplete&&e.onComplete(),this.completeAnimation()}},(i=eU(t)?t:tA(t)).start(n2("",i,r,n)),i.animation),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);let e=this.getStack();e&&e.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(1e3),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){let e=this.getLead(),{targetWithTransforms:t,target:r,layout:n,latestValues:i}=e;if(t&&r&&n){if(this!==e&&this.layout&&n&&sk(this.options.animationType,this.layout.layoutBox,n.layoutBox)){r=this.target||ej();let t=iu(this.layout.layoutBox.x);r.x.min=e.target.x.min,r.x.max=r.x.min+t;let n=iu(this.layout.layoutBox.y);r.y.min=e.target.y.min,r.y.max=r.y.min+n}iJ(t,r),rf(t,i),ic(this.projectionDeltaWithTransform,this.layoutCorrected,t,i)}}registerSharedNode(e,t){this.sharedNodes.has(e)||this.sharedNodes.set(e,new se),this.sharedNodes.get(e).add(t);let r=t.options.initialPromotionConfig;t.promote({transition:r?r.transition:void 0,preserveFollowOpacity:r&&r.shouldPreserveFollowOpacity?r.shouldPreserveFollowOpacity(t):void 0})}isLead(){let e=this.getStack();return!e||e.lead===this}getLead(){let{layoutId:e}=this.options;return e&&this.getStack()?.lead||this}getPrevLead(){let{layoutId:e}=this.options;return e?this.getStack()?.prevLead:void 0}getStack(){let{layoutId:e}=this.options;if(e)return this.root.sharedNodes.get(e)}promote({needsReset:e,transition:t,preserveFollowOpacity:r}={}){let n=this.getStack();n&&n.promote(this,r),e&&(this.projectionDelta=void 0,this.needsReset=!0),t&&this.setOptions({transition:t})}relegate(){let e=this.getStack();return!!e&&e.relegate(this)}resetSkewAndRotation(){let{visualElement:e}=this.options;if(!e)return;let t=!1,{latestValues:r}=e;if((r.z||r.rotate||r.rotateX||r.rotateY||r.rotateZ||r.skewX||r.skewY)&&(t=!0),!t)return;let n={};r.z&&ss("z",e,n,this.animationValues);for(let t=0;t<sn.length;t++)ss(`rotate${sn[t]}`,e,n,this.animationValues),ss(`skew${sn[t]}`,e,n,this.animationValues);for(let t in e.render(),n)e.setStaticValue(t,n[t]),this.animationValues&&(this.animationValues[t]=n[t]);e.scheduleRender()}applyProjectionStyles(e,t){if(!this.instance||this.isSVG)return;if(!this.isVisible){e.visibility="hidden";return}let r=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,e.visibility="",e.opacity="",e.pointerEvents=rk(t?.pointerEvents)||"",e.transform=r?r(this.latestValues,""):"none";return}let n=this.getLead();if(!this.projectionDelta||!this.layout||!n.target){this.options.layoutId&&(e.opacity=void 0!==this.latestValues.opacity?this.latestValues.opacity:1,e.pointerEvents=rk(t?.pointerEvents)||""),this.hasProjected&&!ra(this.latestValues)&&(e.transform=r?r({},""):"none",this.hasProjected=!1);return}e.visibility="";let i=n.animationValues||n.latestValues;this.applyTransformsToTarget();let s=function(e,t,r){let n="",i=e.x.translate/t.x,s=e.y.translate/t.y,a=r?.z||0;if((i||s||a)&&(n=`translate3d(${i}px, ${s}px, ${a}px) `),(1!==t.x||1!==t.y)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),r){let{transformPerspective:e,rotate:t,rotateX:i,rotateY:s,skewX:a,skewY:o}=r;e&&(n=`perspective(${e}px) ${n}`),t&&(n+=`rotate(${t}deg) `),i&&(n+=`rotateX(${i}deg) `),s&&(n+=`rotateY(${s}deg) `),a&&(n+=`skewX(${a}deg) `),o&&(n+=`skewY(${o}deg) `)}let o=e.x.scale*t.x,l=e.y.scale*t.y;return(1!==o||1!==l)&&(n+=`scale(${o}, ${l})`),n||"none"}(this.projectionDeltaWithTransform,this.treeScale,i);r&&(s=r(i,s)),e.transform=s;let{x:a,y:o}=this.projectionDelta;for(let t in e.transformOrigin=`${100*a.origin}% ${100*o.origin}% 0`,n.animationValues?e.opacity=n===this?i.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:i.opacityExit:e.opacity=n===this?void 0!==i.opacity?i.opacity:"":void 0!==i.opacityExit?i.opacityExit:0,t7){if(void 0===i[t])continue;let{correct:r,applyTo:a,isCSSVariable:o}=t7[t],l="none"===s?i[t]:r(i[t],n);if(a){let t=a.length;for(let r=0;r<t;r++)e[a[r]]=l}else o?this.options.visualElement.renderState.vars[t]=l:e[t]=l}this.options.layoutId&&(e.pointerEvents=n===this?rk(t?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(e=>e.currentAnimation?.stop()),this.root.nodes.forEach(sd),this.root.sharedNodes.clear()}}}function so(e){e.updateLayout()}function sl(e){let t=e.resumeFrom?.snapshot||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){let{layoutBox:r,measuredBox:n}=e.layout,{animationType:i}=e.options,s=t.source!==e.layout.source;"size"===i?ii(e=>{let n=s?t.measuredBox[e]:t.layoutBox[e],i=iu(n);n.min=r[e].min,n.max=n.min+i}):sk(i,t.layoutBox,r)&&ii(n=>{let i=s?t.measuredBox[n]:t.layoutBox[n],a=iu(r[n]);i.max=i.min+a,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[n].max=e.relativeTarget[n].min+a)});let a=eV();ic(a,r,t.layoutBox);let o=eV();s?ic(o,e.applyTransform(n,!0),t.measuredBox):ic(o,r,t.layoutBox);let l=!i6(a),u=!1;if(!e.resumeFrom){let n=e.getClosestProjectingParent();if(n&&!n.resumeFrom){let{snapshot:i,layout:s}=n;if(i&&s){let a=ej();im(a,t.layoutBox,i.layoutBox);let o=ej();im(o,r,s.layoutBox),i8(a,o)||(u=!0),n.options.layoutRoot&&(e.relativeTarget=o,e.relativeTargetOrigin=a,e.relativeParent=n)}}}e.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:o,layoutDelta:a,hasLayoutChanged:l,hasRelativeLayoutChanged:u})}else if(e.isLead()){let{onExitComplete:t}=e.options;t&&t()}e.options.transition=void 0}function su(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function sh(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function sc(e){e.clearSnapshot()}function sd(e){e.clearMeasurements()}function sf(e){e.isLayoutDirty=!1}function sp(e){let{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function sm(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function sg(e){e.resolveTargetDelta()}function sy(e){e.calcProjection()}function sv(e){e.resetSkewAndRotation()}function sw(e){e.removeLeadSnapshot()}function sb(e,t,r){e.translate=t8(t.translate,0,r),e.scale=t8(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function sx(e,t,r,n){e.min=t8(t.min,r.min,n),e.max=t8(t.max,r.max,n)}function sI(e){return e.animationValues&&void 0!==e.animationValues.opacityExit}let sT={duration:.45,ease:[.4,0,.1,1]},sE=e=>"u">typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),sS=sE("applewebkit/")&&!sE("chrome/")?Math.round:ti;function s_(e){e.min=sS(e.min),e.max=sS(e.max)}function sk(e,t,r){return"position"===e||"preserve-aspect"===e&&!(.2>=Math.abs(i7(t)-i7(r)))}function sC(e){return e!==e.root&&e.scroll?.wasRoot}let sA=sa({attachResizeListener:(e,t)=>io(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body?.scrollLeft||0,y:document.documentElement.scrollTop||document.body?.scrollTop||0}),checkIsScrollRoot:()=>!0}),sD={current:void 0},sN=sa({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!sD.current){let e=new sA({});e.mount(window),e.setOptions({layoutScroll:!0}),sD.current=e}return sD.current},resetTransform:(e,t)=>{e.style.transform=void 0!==t?t:"none"},checkIsScrollRoot:e=>"fixed"===window.getComputedStyle(e).position});function sP(e,t){let r=function(e,t,r){if(null==e)return[];if(e instanceof EventTarget)return[e];if("string"==typeof e){let t=document,r=(void 0)??t.querySelectorAll(e);return r?Array.from(r):[]}return Array.from(e).filter(e=>null!=e)}(e),n=new AbortController;return[r,{passive:!0,...t,signal:n.signal},()=>n.abort()]}function sR(e){return!("touch"===e.pointerType||il.x||il.y)}function sM(e,t,r){let{props:n}=e;e.animationState&&n.whileHover&&e.animationState.setActive("whileHover","Start"===r);let i=n["onHover"+r];i&&tl.postRender(()=>i(t,iy(t)))}let sO=(e,t)=>!!t&&(e===t||sO(e,t.parentElement)),sL=new WeakSet;function sV(e){return t=>{"Enter"===t.key&&e(t)}}function sF(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}function sj(e){return ig(e)&&!(il.x||il.y)}function sU(e,t,r){let{props:n}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&n.whileTap&&e.animationState.setActive("whileTap","Start"===r);let i=n["onTap"+("End"===r?"":r)];i&&tl.postRender(()=>i(t,iy(t)))}let sB=new WeakMap,sz=new WeakMap,sq=e=>{let t=sB.get(e.target);t&&t(e)},s$=e=>{e.forEach(sq)},sG={some:0,all:1},sK=function(e,t){if("u"<typeof Proxy)return rF;let r=new Map,n=(r,n)=>rF(r,n,e,t);return new Proxy((e,t)=>n(e,t),{get:(i,s)=>"create"===s?n:(r.has(s)||r.set(s,rF(s,void 0,e,t)),r.get(s))})}({animation:{Feature:class extends rj{constructor(e){super(e),e.animationState||(e.animationState=function(e){let t=t=>Promise.all(t.map(({animation:t,options:r})=>(function(e,t,r={}){let n;if(e.notify("AnimationStart",t),Array.isArray(t))n=Promise.all(t.map(t=>n3(e,t,r)));else if("string"==typeof t)n=n3(e,t,r);else{let i="function"==typeof t?rU(e,t,r.custom):t;n=Promise.all(n5(e,i,r))}return n.then(()=>{e.notify("AnimationComplete",t)})})(e,t,r))),r=it(),n=!0,i=t=>(r,n)=>{let i=rU(e,n,"exit"===t?e.presenceContext?.custom:void 0);if(i){let{transition:e,transitionEnd:t,...n}=i;r={...r,...n,...t}}return r};function s(s){let{props:a}=e,o=function e(t){if(!t)return;if(!t.isControllingVariants){let r=t.parent&&e(t.parent)||{};return void 0!==t.props.initial&&(r.initial=t.props.initial),r}let r={};for(let e=0;e<n4;e++){let n=tF[e],i=t.props[n];(tL(i)||!1===i)&&(r[n]=i)}return r}(e.parent)||{},l=[],u=new Set,h={},c=1/0;for(let t=0;t<n9;t++){var d,f;let p=n7[t],m=r[p],g=void 0!==a[p]?a[p]:o[p],y=tL(g),v=p===s?m.isActive:null;!1===v&&(c=t);let w=g===o[p]&&g!==a[p]&&y;if(w&&n&&e.manuallyAnimateOnMount&&(w=!1),m.protectedKeys={...h},!m.isActive&&null===v||!g&&!m.prevProp||tO(g)||"boolean"==typeof g)continue;let b=(d=m.prevProp,"string"==typeof(f=g)?f!==d:!!Array.isArray(f)&&!n8(f,d)),x=b||p===s&&m.isActive&&!w&&y||t>c&&y,I=!1,T=Array.isArray(g)?g:[g],E=T.reduce(i(p),{});!1===v&&(E={});let{prevResolvedValues:S={}}=m,_={...S,...E},k=t=>{x=!0,u.has(t)&&(I=!0,u.delete(t)),m.needsAnimating[t]=!0;let r=e.getValue(t);r&&(r.liveStyle=!1)};for(let e in _){let t=E[e],r=S[e];if(!h.hasOwnProperty(e))(rz(t)&&rz(r)?n8(t,r):t===r)?void 0!==t&&u.has(e)?k(e):m.protectedKeys[e]=!0:null!=t?k(e):u.add(e)}m.prevProp=g,m.prevResolvedValues=E,m.isActive&&(h={...h,...E}),n&&e.blockInitialAnimation&&(x=!1);let C=w&&b,A=!C||I;x&&A&&l.push(...T.map(t=>{let r={type:p};if("string"==typeof t&&n&&!C&&e.manuallyAnimateOnMount&&e.parent){let{parent:n}=e,i=rU(n,t);if(n.enteringChildren&&i){let{delayChildren:t}=i.transition||{};r.delay=n6(n.enteringChildren,e,t)}}return{animation:t,options:r}}))}if(u.size){let t={};if("boolean"!=typeof a.initial){let r=rU(e,Array.isArray(a.initial)?a.initial[0]:a.initial);r&&r.transition&&(t.transition=r.transition)}u.forEach(r=>{let n=e.getBaseTarget(r),i=e.getValue(r);i&&(i.liveStyle=!0),t[r]=n??null}),l.push({animation:t})}let p=!!l.length;return n&&(!1===a.initial||a.initial===a.animate)&&!e.manuallyAnimateOnMount&&(p=!1),n=!1,p?t(l):Promise.resolve()}return{animateChanges:s,setActive:function(t,n){if(r[t].isActive===n)return Promise.resolve();e.variantChildren?.forEach(e=>e.animationState?.setActive(t,n)),r[t].isActive=n;let i=s(t);for(let e in r)r[e].protectedKeys={};return i},setAnimateFunction:function(r){t=r(e)},getState:()=>r,reset:()=>{r=it()}}}(e))}updateAnimationControlsSubscription(){let{animate:e}=this.node.getProps();tO(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){let{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}},exit:{Feature:class extends rj{constructor(){super(...arguments),this.id=ir++}update(){if(!this.node.presenceContext)return;let{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;let n=this.node.animationState.setActive("exit",!e);t&&!e&&n.then(()=>{t(this.id)})}mount(){let{register:e,onExitComplete:t}=this.node.presenceContext||{};t&&t(this.id),e&&(this.unmount=e(this.id))}unmount(){}}},inView:{Feature:class extends rj{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){var e;let t;this.unmount();let{viewport:r={}}=this.node.getProps(),{root:n,margin:i,amount:s="some",once:a}=r,o={root:n?n.current:void 0,rootMargin:i,threshold:"number"==typeof s?s:sG[s]},l=e=>{let{isIntersecting:t}=e;if(this.isInView===t||(this.isInView=t,a&&!t&&this.hasEnteredView))return;t&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",t);let{onViewportEnter:r,onViewportLeave:n}=this.node.getProps(),i=t?r:n;i&&i(e)};return e=this.node.current,t=function({root:e,...t}){let r=e||document;sz.has(r)||sz.set(r,{});let n=sz.get(r),i=JSON.stringify(t);return n[i]||(n[i]=new IntersectionObserver(s$,{root:e,...t})),n[i]}(o),sB.set(e,l),t.observe(e),()=>{sB.delete(e),t.unobserve(e)}}mount(){this.startObserver()}update(){if("u"<typeof IntersectionObserver)return;let{props:e,prevProps:t}=this.node;["amount","margin","root"].some(function({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}(e,t))&&this.startObserver()}unmount(){}}},tap:{Feature:class extends rj{mount(){let{current:e}=this.node;e&&(this.unmount=function(e,t,r={}){let[n,i,s]=sP(e,r),a=e=>{let n=e.currentTarget;if(!sj(e))return;sL.add(n);let s=t(n,e),a=(e,t)=>{window.removeEventListener("pointerup",o),window.removeEventListener("pointercancel",l),sL.has(n)&&sL.delete(n),sj(e)&&"function"==typeof s&&s(e,{success:t})},o=e=>{a(e,n===window||n===document||r.useGlobalTarget||sO(n,e.target))},l=e=>{a(e,!1)};window.addEventListener("pointerup",o,i),window.addEventListener("pointercancel",l,i)};return n.forEach(e=>{(r.useGlobalTarget?window:e).addEventListener("pointerdown",a,i),F(e)&&(e.addEventListener("focus",e=>((e,t)=>{let r=e.currentTarget;if(!r)return;let n=sV(()=>{if(sL.has(r))return;sF(r,"down");let e=sV(()=>{sF(r,"up")});r.addEventListener("keyup",e,t),r.addEventListener("blur",()=>sF(r,"cancel"),t)});r.addEventListener("keydown",n,t),r.addEventListener("blur",()=>r.removeEventListener("keydown",n),t)})(e,i)),ia(e)||e.hasAttribute("tabindex")||(e.tabIndex=0))}),s}(e,(e,t)=>(sU(this.node,t,"Start"),(e,{success:t})=>sU(this.node,e,t?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}},focus:{Feature:class extends rj{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch(t){e=!0}e&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){this.isActive&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=rK(io(this.node.current,"focus",()=>this.onFocus()),io(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}},hover:{Feature:class extends rj{mount(){let{current:e}=this.node;e&&(this.unmount=function(e,t,r={}){let[n,i,s]=sP(e,r),a=e=>{if(!sR(e))return;let{target:r}=e,n=t(r,e);if("function"!=typeof n||!r)return;let s=e=>{sR(e)&&(n(e),r.removeEventListener("pointerleave",s))};r.addEventListener("pointerleave",s,i)};return n.forEach(e=>{e.addEventListener("pointerenter",a,i)}),s}(e,(e,t)=>(sM(this.node,t,"Start"),e=>sM(this.node,e,"End"))))}unmount(){}}},pan:{Feature:class extends rj{constructor(){super(...arguments),this.removePointerDownListener=ti}onPointerDown(e){this.session=new iI(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:iw(this.node)})}createPanHandlers(){let{onPanSessionStart:e,onPanStart:t,onPan:r,onPanEnd:n}=this.node.getProps();return{onSessionStart:iM(e),onStart:iM(t),onMove:r,onEnd:(e,t)=>{delete this.session,n&&tl.postRender(()=>n(e,t))}}}mount(){this.removePointerDownListener=iv(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}},drag:{Feature:class extends rj{constructor(e){super(e),this.removeGroupControls=ti,this.removeListeners=ti,this.controls=new iP(e)}mount(){let{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ti}update(){let{dragControls:e}=this.node.getProps(),{dragControls:t}=this.node.prevProps||{};e!==t&&(this.removeGroupControls(),e&&(this.removeGroupControls=e.subscribe(this.controls)))}unmount(){this.removeGroupControls(),this.removeListeners(),this.controls.isDragging||this.controls.endPanSession()}},ProjectionNode:sN,MeasureLayout:ij},layout:{ProjectionNode:sN,MeasureLayout:ij}},(e,t)=>t.isSVG??ry(e)?new rr(t):new rm(t,{allowProjection:e!==D.Fragment})),sH=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim(),sW=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)};var sQ={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let sJ=(0,D.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:i="",children:s,iconNode:a,...o},l)=>(0,D.createElement)("svg",{ref:l,...sQ,width:t,height:t,stroke:e,strokeWidth:n?24*Number(r)/Number(t):r,className:sH("lucide",i),...!s&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0;return!1})(o)&&{"aria-hidden":"true"},...o},[...a.map(([e,t])=>(0,D.createElement)(e,t)),...Array.isArray(s)?s:[s]])),sY=(e,t)=>{let r=(0,D.forwardRef)(({className:r,...n},i)=>(0,D.createElement)(sJ,{ref:i,iconNode:t,className:sH(`lucide-${sW(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,r),...n}));return r.displayName=sW(e),r},sX=sY("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),sZ=sY("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),s0=sY("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]]);function s1({onCreateClick:e,onJoinClick:t}){return(0,A.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[80vh] text-center px-4",children:[(0,A.jsxs)(sK.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"mb-8",children:[(0,A.jsx)("div",{className:"inline-flex items-center justify-center w-20 h-20 rounded-2xl bg-blue-600/20 text-blue-500 mb-6",children:(0,A.jsx)(sX,{size:40})}),(0,A.jsx)("h1",{className:"text-4xl md:text-5xl font-bold mb-4 tracking-tight",children:"   "}),(0,A.jsxs)("p",{className:"text-gray-400 text-lg max-w-md mx-auto",children:[" ,  . ",(0,A.jsx)("br",{}),"ID     ."]})]}),(0,A.jsxs)(sK.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.5,delay:.2},className:"grid grid-cols-1 md:grid-cols-2 gap-4 w-full max-w-lg",children:[(0,A.jsxs)("button",{onClick:e,className:"flex flex-col items-center justify-center p-8 rounded-2xl bg-white/5 border border-white/10 hover:bg-white/10 transition-all group",children:[(0,A.jsx)("div",{className:"w-12 h-12 rounded-full bg-blue-600 flex items-center justify-center mb-4 group-hover:scale-110 transition-transform",children:(0,A.jsx)(sZ,{className:"text-white"})}),(0,A.jsx)("span",{className:"text-xl font-semibold",children:" "}),(0,A.jsx)("span",{className:"text-sm text-gray-500 mt-2",children:"  "})]}),(0,A.jsxs)("button",{onClick:t,className:"flex flex-col items-center justify-center p-8 rounded-2xl bg-white/5 border border-white/10 hover:bg-white/10 transition-all group",children:[(0,A.jsx)("div",{className:"w-12 h-12 rounded-full bg-emerald-600 flex items-center justify-center mb-4 group-hover:scale-110 transition-transform",children:(0,A.jsx)(s0,{className:"text-white"})}),(0,A.jsx)("span",{className:"text-xl font-semibold",children:" "}),(0,A.jsx)("span",{className:"text-sm text-gray-500 mt-2",children:"ID  "})]})]}),(0,A.jsx)(sK.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1},className:"mt-12 text-xs text-gray-600 max-w-xs",children:"         ."})]})}let s2=sY("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),s5=sY("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),s6=sY("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),s3=sY("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]),s4=(e=new Map,t=null,r)=>({nextPart:e,validators:t,classGroupId:r}),s8=[],s7=(e,t,r)=>{if(0==e.length-t)return r.classGroupId;let n=e[t],i=r.nextPart.get(n);if(i){let r=s7(e,t+1,i);if(r)return r}let s=r.validators;if(null===s)return;let a=0===t?e.join("-"):e.slice(t).join("-"),o=s.length;for(let e=0;e<o;e++){let t=s[e];if(t.validator(a))return t.classGroupId}},s9=(e,t)=>{let r=s4();for(let n in e)ae(e[n],r,n,t);return r},ae=(e,t,r,n)=>{let i=e.length;for(let s=0;s<i;s++)at(e[s],t,r,n)},at=(e,t,r,n)=>{"string"==typeof e?ar(e,t,r):"function"==typeof e?an(e,t,r,n):ai(e,t,r,n)},ar=(e,t,r)=>{(""===e?t:as(t,e)).classGroupId=r},an=(e,t,r,n)=>{aa(e)?ae(e(n),t,r,n):(null===t.validators&&(t.validators=[]),t.validators.push({classGroupId:r,validator:e}))},ai=(e,t,r,n)=>{let i=Object.entries(e),s=i.length;for(let e=0;e<s;e++){let[s,a]=i[e];ae(a,as(t,s),r,n)}},as=(e,t)=>{let r=e,n=t.split("-"),i=n.length;for(let e=0;e<i;e++){let t=n[e],i=r.nextPart.get(t);i||(i=s4(),r.nextPart.set(t,i)),r=i}return r},aa=e=>"isThemeGetter"in e&&!0===e.isThemeGetter,ao=[],al=(e,t,r,n,i)=>({modifiers:e,hasImportantModifier:t,baseClassName:r,maybePostfixModifierPosition:n,isExternal:i}),au=/\s+/,ah=e=>{let t;if("string"==typeof e)return e;let r="";for(let n=0;n<e.length;n++)e[n]&&(t=ah(e[n]))&&(r&&(r+=" "),r+=t);return r},ac=[],ad=e=>{let t=t=>t[e]||ac;return t.isThemeGetter=!0,t},af=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,ap=/^\((?:(\w[\w-]*):)?(.+)\)$/i,am=/^\d+\/\d+$/,ag=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,ay=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,av=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,aw=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,ab=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ax=e=>am.test(e),aI=e=>!!e&&!Number.isNaN(Number(e)),aT=e=>!!e&&Number.isInteger(Number(e)),aE=e=>e.endsWith("%")&&aI(e.slice(0,-1)),aS=e=>ag.test(e),a_=()=>!0,ak=e=>ay.test(e)&&!av.test(e),aC=()=>!1,aA=e=>aw.test(e),aD=e=>ab.test(e),aN=e=>!aR(e)&&!aj(e),aP=e=>aK(e,aJ,aC),aR=e=>af.test(e),aM=e=>aK(e,aY,ak),aO=e=>aK(e,aX,aI),aL=e=>aK(e,aW,aC),aV=e=>aK(e,aQ,aD),aF=e=>aK(e,a0,aA),aj=e=>ap.test(e),aU=e=>aH(e,aY),aB=e=>aH(e,aZ),az=e=>aH(e,aW),aq=e=>aH(e,aJ),a$=e=>aH(e,aQ),aG=e=>aH(e,a0,!0),aK=(e,t,r)=>{let n=af.exec(e);return!!n&&(n[1]?t(n[1]):r(n[2]))},aH=(e,t,r=!1)=>{let n=ap.exec(e);return!!n&&(n[1]?t(n[1]):r)},aW=e=>"position"===e||"percentage"===e,aQ=e=>"image"===e||"url"===e,aJ=e=>"length"===e||"size"===e||"bg-size"===e,aY=e=>"length"===e,aX=e=>"number"===e,aZ=e=>"family-name"===e,a0=e=>"shadow"===e,a1=((e,...t)=>{let r,n,i,s,a=e=>{let t=n(e);if(t)return t;let s=((e,t)=>{let{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:i,sortModifiers:s}=t,a=[],o=e.trim().split(au),l="";for(let e=o.length-1;e>=0;e-=1){let t=o[e],{isExternal:u,modifiers:h,hasImportantModifier:c,baseClassName:d,maybePostfixModifierPosition:f}=r(t);if(u){l=t+(l.length>0?" "+l:l);continue}let p=!!f,m=n(p?d.substring(0,f):d);if(!m){if(!p||!(m=n(d))){l=t+(l.length>0?" "+l:l);continue}p=!1}let g=0===h.length?"":1===h.length?h[0]:s(h).join(":"),y=c?g+"!":g,v=y+m;if(a.indexOf(v)>-1)continue;a.push(v);let w=i(m,p);for(let e=0;e<w.length;++e){let t=w[e];a.push(y+t)}l=t+(l.length>0?" "+l:l)}return l})(e,r);return i(e,s),s};return s=o=>{var l;let u;return n=(r={cache:(e=>{if(e<1)return{get:()=>void 0,set:()=>{}};let t=0,r=Object.create(null),n=Object.create(null),i=(i,s)=>{r[i]=s,++t>e&&(t=0,n=r,r=Object.create(null))};return{get(e){let t=r[e];return void 0!==t?t:void 0!==(t=n[e])?(i(e,t),t):void 0},set(e,t){e in r?r[e]=t:i(e,t)}}})((l=t.reduce((e,t)=>t(e),e())).cacheSize),parseClassName:(e=>{let{prefix:t,experimentalParseClassName:r}=e,n=e=>{let t,r=[],n=0,i=0,s=0,a=e.length;for(let o=0;o<a;o++){let a=e[o];if(0===n&&0===i){if(":"===a){r.push(e.slice(s,o)),s=o+1;continue}if("/"===a){t=o;continue}}"["===a?n++:"]"===a?n--:"("===a?i++:")"===a&&i--}let o=0===r.length?e:e.slice(s),l=o,u=!1;return o.endsWith("!")?(l=o.slice(0,-1),u=!0):o.startsWith("!")&&(l=o.slice(1),u=!0),al(r,u,l,t&&t>s?t-s:void 0)};if(t){let e=t+":",r=n;n=t=>t.startsWith(e)?r(t.slice(e.length)):al(ao,!1,t,void 0,!0)}if(r){let e=n;n=t=>r({className:t,parseClassName:e})}return n})(l),sortModifiers:(u=new Map,l.orderSensitiveModifiers.forEach((e,t)=>{u.set(e,1e6+t)}),e=>{let t=[],r=[];for(let n=0;n<e.length;n++){let i=e[n],s="["===i[0],a=u.has(i);s||a?(r.length>0&&(r.sort(),t.push(...r),r=[]),t.push(i)):r.push(i)}return r.length>0&&(r.sort(),t.push(...r)),t}),...(e=>{let t=(e=>{let{theme:t,classGroups:r}=e;return s9(r,t)})(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:e=>{if(e.startsWith("[")&&e.endsWith("]")){var r;let t,n,i;return -1===(r=e).slice(1,-1).indexOf(":")?void 0:(n=(t=r.slice(1,-1)).indexOf(":"),(i=t.slice(0,n))?"arbitrary.."+i:void 0)}let n=e.split("-"),i=+(""===n[0]&&n.length>1);return s7(n,i,t)},getConflictingClassGroupIds:(e,t)=>{if(t){let t=n[e],i=r[e];if(t){if(i){let e=Array(i.length+t.length);for(let t=0;t<i.length;t++)e[t]=i[t];for(let r=0;r<t.length;r++)e[i.length+r]=t[r];return e}return t}return i||s8}return r[e]||s8}}})(l)}).cache.get,i=r.cache.set,s=a,a(o)},(...e)=>s(((...e)=>{let t,r,n=0,i="";for(;n<e.length;)(t=e[n++])&&(r=ah(t))&&(i&&(i+=" "),i+=r);return i})(...e))})(()=>{let e=ad("color"),t=ad("font"),r=ad("text"),n=ad("font-weight"),i=ad("tracking"),s=ad("leading"),a=ad("breakpoint"),o=ad("container"),l=ad("spacing"),u=ad("radius"),h=ad("shadow"),c=ad("inset-shadow"),d=ad("text-shadow"),f=ad("drop-shadow"),p=ad("blur"),m=ad("perspective"),g=ad("aspect"),y=ad("ease"),v=ad("animate"),w=()=>["auto","avoid","all","avoid-page","page","left","right","column"],b=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],x=()=>[...b(),aj,aR],I=()=>["auto","hidden","clip","visible","scroll"],T=()=>["auto","contain","none"],E=()=>[aj,aR,l],S=()=>[ax,"full","auto",...E()],_=()=>[aT,"none","subgrid",aj,aR],k=()=>["auto",{span:["full",aT,aj,aR]},aT,aj,aR],C=()=>[aT,"auto",aj,aR],A=()=>["auto","min","max","fr",aj,aR],D=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],N=()=>["start","end","center","stretch","center-safe","end-safe"],P=()=>["auto",...E()],R=()=>[ax,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...E()],M=()=>[e,aj,aR],O=()=>[...b(),az,aL,{position:[aj,aR]}],L=()=>["no-repeat",{repeat:["","x","y","space","round"]}],V=()=>["auto","cover","contain",aq,aP,{size:[aj,aR]}],F=()=>[aE,aU,aM],j=()=>["","none","full",u,aj,aR],U=()=>["",aI,aU,aM],B=()=>["solid","dashed","dotted","double"],z=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],q=()=>[aI,aE,az,aL],$=()=>["","none",p,aj,aR],G=()=>["none",aI,aj,aR],K=()=>["none",aI,aj,aR],H=()=>[aI,aj,aR],W=()=>[ax,"full",...E()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[aS],breakpoint:[aS],color:[a_],container:[aS],"drop-shadow":[aS],ease:["in","out","in-out"],font:[aN],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[aS],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[aS],shadow:[aS],spacing:["px",aI],text:[aS],"text-shadow":[aS],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",ax,aR,aj,g]}],container:["container"],columns:[{columns:[aI,aR,aj,o]}],"break-after":[{"break-after":w()}],"break-before":[{"break-before":w()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:x()}],overflow:[{overflow:I()}],"overflow-x":[{"overflow-x":I()}],"overflow-y":[{"overflow-y":I()}],overscroll:[{overscroll:T()}],"overscroll-x":[{"overscroll-x":T()}],"overscroll-y":[{"overscroll-y":T()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:S()}],"inset-x":[{"inset-x":S()}],"inset-y":[{"inset-y":S()}],start:[{start:S()}],end:[{end:S()}],top:[{top:S()}],right:[{right:S()}],bottom:[{bottom:S()}],left:[{left:S()}],visibility:["visible","invisible","collapse"],z:[{z:[aT,"auto",aj,aR]}],basis:[{basis:[ax,"full","auto",o,...E()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[aI,ax,"auto","initial","none",aR]}],grow:[{grow:["",aI,aj,aR]}],shrink:[{shrink:["",aI,aj,aR]}],order:[{order:[aT,"first","last","none",aj,aR]}],"grid-cols":[{"grid-cols":_()}],"col-start-end":[{col:k()}],"col-start":[{"col-start":C()}],"col-end":[{"col-end":C()}],"grid-rows":[{"grid-rows":_()}],"row-start-end":[{row:k()}],"row-start":[{"row-start":C()}],"row-end":[{"row-end":C()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":A()}],"auto-rows":[{"auto-rows":A()}],gap:[{gap:E()}],"gap-x":[{"gap-x":E()}],"gap-y":[{"gap-y":E()}],"justify-content":[{justify:[...D(),"normal"]}],"justify-items":[{"justify-items":[...N(),"normal"]}],"justify-self":[{"justify-self":["auto",...N()]}],"align-content":[{content:["normal",...D()]}],"align-items":[{items:[...N(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...N(),{baseline:["","last"]}]}],"place-content":[{"place-content":D()}],"place-items":[{"place-items":[...N(),"baseline"]}],"place-self":[{"place-self":["auto",...N()]}],p:[{p:E()}],px:[{px:E()}],py:[{py:E()}],ps:[{ps:E()}],pe:[{pe:E()}],pt:[{pt:E()}],pr:[{pr:E()}],pb:[{pb:E()}],pl:[{pl:E()}],m:[{m:P()}],mx:[{mx:P()}],my:[{my:P()}],ms:[{ms:P()}],me:[{me:P()}],mt:[{mt:P()}],mr:[{mr:P()}],mb:[{mb:P()}],ml:[{ml:P()}],"space-x":[{"space-x":E()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":E()}],"space-y-reverse":["space-y-reverse"],size:[{size:R()}],w:[{w:[o,"screen",...R()]}],"min-w":[{"min-w":[o,"screen","none",...R()]}],"max-w":[{"max-w":[o,"screen","none","prose",{screen:[a]},...R()]}],h:[{h:["screen","lh",...R()]}],"min-h":[{"min-h":["screen","lh","none",...R()]}],"max-h":[{"max-h":["screen","lh",...R()]}],"font-size":[{text:["base",r,aU,aM]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[n,aj,aO]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",aE,aR]}],"font-family":[{font:[aB,aR,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[i,aj,aR]}],"line-clamp":[{"line-clamp":[aI,"none",aj,aO]}],leading:[{leading:[s,...E()]}],"list-image":[{"list-image":["none",aj,aR]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",aj,aR]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:M()}],"text-color":[{text:M()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...B(),"wavy"]}],"text-decoration-thickness":[{decoration:[aI,"from-font","auto",aj,aM]}],"text-decoration-color":[{decoration:M()}],"underline-offset":[{"underline-offset":[aI,"auto",aj,aR]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:E()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",aj,aR]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",aj,aR]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:O()}],"bg-repeat":[{bg:L()}],"bg-size":[{bg:V()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},aT,aj,aR],radial:["",aj,aR],conic:[aT,aj,aR]},a$,aV]}],"bg-color":[{bg:M()}],"gradient-from-pos":[{from:F()}],"gradient-via-pos":[{via:F()}],"gradient-to-pos":[{to:F()}],"gradient-from":[{from:M()}],"gradient-via":[{via:M()}],"gradient-to":[{to:M()}],rounded:[{rounded:j()}],"rounded-s":[{"rounded-s":j()}],"rounded-e":[{"rounded-e":j()}],"rounded-t":[{"rounded-t":j()}],"rounded-r":[{"rounded-r":j()}],"rounded-b":[{"rounded-b":j()}],"rounded-l":[{"rounded-l":j()}],"rounded-ss":[{"rounded-ss":j()}],"rounded-se":[{"rounded-se":j()}],"rounded-ee":[{"rounded-ee":j()}],"rounded-es":[{"rounded-es":j()}],"rounded-tl":[{"rounded-tl":j()}],"rounded-tr":[{"rounded-tr":j()}],"rounded-br":[{"rounded-br":j()}],"rounded-bl":[{"rounded-bl":j()}],"border-w":[{border:U()}],"border-w-x":[{"border-x":U()}],"border-w-y":[{"border-y":U()}],"border-w-s":[{"border-s":U()}],"border-w-e":[{"border-e":U()}],"border-w-t":[{"border-t":U()}],"border-w-r":[{"border-r":U()}],"border-w-b":[{"border-b":U()}],"border-w-l":[{"border-l":U()}],"divide-x":[{"divide-x":U()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":U()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...B(),"hidden","none"]}],"divide-style":[{divide:[...B(),"hidden","none"]}],"border-color":[{border:M()}],"border-color-x":[{"border-x":M()}],"border-color-y":[{"border-y":M()}],"border-color-s":[{"border-s":M()}],"border-color-e":[{"border-e":M()}],"border-color-t":[{"border-t":M()}],"border-color-r":[{"border-r":M()}],"border-color-b":[{"border-b":M()}],"border-color-l":[{"border-l":M()}],"divide-color":[{divide:M()}],"outline-style":[{outline:[...B(),"none","hidden"]}],"outline-offset":[{"outline-offset":[aI,aj,aR]}],"outline-w":[{outline:["",aI,aU,aM]}],"outline-color":[{outline:M()}],shadow:[{shadow:["","none",h,aG,aF]}],"shadow-color":[{shadow:M()}],"inset-shadow":[{"inset-shadow":["none",c,aG,aF]}],"inset-shadow-color":[{"inset-shadow":M()}],"ring-w":[{ring:U()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:M()}],"ring-offset-w":[{"ring-offset":[aI,aM]}],"ring-offset-color":[{"ring-offset":M()}],"inset-ring-w":[{"inset-ring":U()}],"inset-ring-color":[{"inset-ring":M()}],"text-shadow":[{"text-shadow":["none",d,aG,aF]}],"text-shadow-color":[{"text-shadow":M()}],opacity:[{opacity:[aI,aj,aR]}],"mix-blend":[{"mix-blend":[...z(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":z()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[aI]}],"mask-image-linear-from-pos":[{"mask-linear-from":q()}],"mask-image-linear-to-pos":[{"mask-linear-to":q()}],"mask-image-linear-from-color":[{"mask-linear-from":M()}],"mask-image-linear-to-color":[{"mask-linear-to":M()}],"mask-image-t-from-pos":[{"mask-t-from":q()}],"mask-image-t-to-pos":[{"mask-t-to":q()}],"mask-image-t-from-color":[{"mask-t-from":M()}],"mask-image-t-to-color":[{"mask-t-to":M()}],"mask-image-r-from-pos":[{"mask-r-from":q()}],"mask-image-r-to-pos":[{"mask-r-to":q()}],"mask-image-r-from-color":[{"mask-r-from":M()}],"mask-image-r-to-color":[{"mask-r-to":M()}],"mask-image-b-from-pos":[{"mask-b-from":q()}],"mask-image-b-to-pos":[{"mask-b-to":q()}],"mask-image-b-from-color":[{"mask-b-from":M()}],"mask-image-b-to-color":[{"mask-b-to":M()}],"mask-image-l-from-pos":[{"mask-l-from":q()}],"mask-image-l-to-pos":[{"mask-l-to":q()}],"mask-image-l-from-color":[{"mask-l-from":M()}],"mask-image-l-to-color":[{"mask-l-to":M()}],"mask-image-x-from-pos":[{"mask-x-from":q()}],"mask-image-x-to-pos":[{"mask-x-to":q()}],"mask-image-x-from-color":[{"mask-x-from":M()}],"mask-image-x-to-color":[{"mask-x-to":M()}],"mask-image-y-from-pos":[{"mask-y-from":q()}],"mask-image-y-to-pos":[{"mask-y-to":q()}],"mask-image-y-from-color":[{"mask-y-from":M()}],"mask-image-y-to-color":[{"mask-y-to":M()}],"mask-image-radial":[{"mask-radial":[aj,aR]}],"mask-image-radial-from-pos":[{"mask-radial-from":q()}],"mask-image-radial-to-pos":[{"mask-radial-to":q()}],"mask-image-radial-from-color":[{"mask-radial-from":M()}],"mask-image-radial-to-color":[{"mask-radial-to":M()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":b()}],"mask-image-conic-pos":[{"mask-conic":[aI]}],"mask-image-conic-from-pos":[{"mask-conic-from":q()}],"mask-image-conic-to-pos":[{"mask-conic-to":q()}],"mask-image-conic-from-color":[{"mask-conic-from":M()}],"mask-image-conic-to-color":[{"mask-conic-to":M()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:O()}],"mask-repeat":[{mask:L()}],"mask-size":[{mask:V()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",aj,aR]}],filter:[{filter:["","none",aj,aR]}],blur:[{blur:$()}],brightness:[{brightness:[aI,aj,aR]}],contrast:[{contrast:[aI,aj,aR]}],"drop-shadow":[{"drop-shadow":["","none",f,aG,aF]}],"drop-shadow-color":[{"drop-shadow":M()}],grayscale:[{grayscale:["",aI,aj,aR]}],"hue-rotate":[{"hue-rotate":[aI,aj,aR]}],invert:[{invert:["",aI,aj,aR]}],saturate:[{saturate:[aI,aj,aR]}],sepia:[{sepia:["",aI,aj,aR]}],"backdrop-filter":[{"backdrop-filter":["","none",aj,aR]}],"backdrop-blur":[{"backdrop-blur":$()}],"backdrop-brightness":[{"backdrop-brightness":[aI,aj,aR]}],"backdrop-contrast":[{"backdrop-contrast":[aI,aj,aR]}],"backdrop-grayscale":[{"backdrop-grayscale":["",aI,aj,aR]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[aI,aj,aR]}],"backdrop-invert":[{"backdrop-invert":["",aI,aj,aR]}],"backdrop-opacity":[{"backdrop-opacity":[aI,aj,aR]}],"backdrop-saturate":[{"backdrop-saturate":[aI,aj,aR]}],"backdrop-sepia":[{"backdrop-sepia":["",aI,aj,aR]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":E()}],"border-spacing-x":[{"border-spacing-x":E()}],"border-spacing-y":[{"border-spacing-y":E()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",aj,aR]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[aI,"initial",aj,aR]}],ease:[{ease:["linear","initial",y,aj,aR]}],delay:[{delay:[aI,aj,aR]}],animate:[{animate:["none",v,aj,aR]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[m,aj,aR]}],"perspective-origin":[{"perspective-origin":x()}],rotate:[{rotate:G()}],"rotate-x":[{"rotate-x":G()}],"rotate-y":[{"rotate-y":G()}],"rotate-z":[{"rotate-z":G()}],scale:[{scale:K()}],"scale-x":[{"scale-x":K()}],"scale-y":[{"scale-y":K()}],"scale-z":[{"scale-z":K()}],"scale-3d":["scale-3d"],skew:[{skew:H()}],"skew-x":[{"skew-x":H()}],"skew-y":[{"skew-y":H()}],transform:[{transform:[aj,aR,"","none","gpu","cpu"]}],"transform-origin":[{origin:x()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:W()}],"translate-x":[{"translate-x":W()}],"translate-y":[{"translate-y":W()}],"translate-z":[{"translate-z":W()}],"translate-none":["translate-none"],accent:[{accent:M()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:M()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",aj,aR]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":E()}],"scroll-mx":[{"scroll-mx":E()}],"scroll-my":[{"scroll-my":E()}],"scroll-ms":[{"scroll-ms":E()}],"scroll-me":[{"scroll-me":E()}],"scroll-mt":[{"scroll-mt":E()}],"scroll-mr":[{"scroll-mr":E()}],"scroll-mb":[{"scroll-mb":E()}],"scroll-ml":[{"scroll-ml":E()}],"scroll-p":[{"scroll-p":E()}],"scroll-px":[{"scroll-px":E()}],"scroll-py":[{"scroll-py":E()}],"scroll-ps":[{"scroll-ps":E()}],"scroll-pe":[{"scroll-pe":E()}],"scroll-pt":[{"scroll-pt":E()}],"scroll-pr":[{"scroll-pr":E()}],"scroll-pb":[{"scroll-pb":E()}],"scroll-pl":[{"scroll-pl":E()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",aj,aR]}],fill:[{fill:["none",...M()]}],"stroke-w":[{stroke:[aI,aU,aM,aO]}],stroke:[{stroke:["none",...M()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}});function a2(...e){return a1(function(){for(var e,t,r=0,n="",i=arguments.length;r<i;r++)(e=arguments[r])&&(t=function e(t){var r,n,i="";if("string"==typeof t||"number"==typeof t)i+=t;else if("object"==typeof t)if(Array.isArray(t)){var s=t.length;for(r=0;r<s;r++)t[r]&&(n=e(t[r]))&&(i&&(i+=" "),i+=n)}else for(n in t)t[n]&&(i&&(i+=" "),i+=n);return i}(e))&&(n&&(n+=" "),n+=t);return n}(e))}function a5({onBack:e,onCreate:t}){let[r,n]=(0,D.useState)(""),[i,s]=(0,D.useState)(2),[a,o]=(0,D.useState)("");return(0,A.jsxs)(sK.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"w-full max-w-md mx-auto p-6",children:[(0,A.jsxs)("button",{onClick:e,className:"flex items-center text-gray-400 hover:text-white mb-8 transition-colors",children:[(0,A.jsx)(s2,{size:20,className:"mr-2"}),""]}),(0,A.jsx)("h2",{className:"text-3xl font-bold mb-8",children:"  "}),(0,A.jsxs)("form",{onSubmit:e=>{e.preventDefault(),a&&t({name:r,expiresHours:i,password:a})},className:"space-y-6",children:[(0,A.jsxs)("div",{children:[(0,A.jsxs)("label",{className:"block text-sm font-medium text-gray-400 mb-2 flex items-center",children:[(0,A.jsx)(s3,{size:16,className:"mr-2"}),"  ()"]}),(0,A.jsx)("input",{type:"text",value:r,onChange:e=>n(e.target.value),placeholder:" ",className:"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all"})]}),(0,A.jsxs)("div",{children:[(0,A.jsxs)("label",{className:"block text-sm font-medium text-gray-400 mb-2 flex items-center",children:[(0,A.jsx)(s5,{size:16,className:"mr-2"}),"  (",i,")"]}),(0,A.jsx)("input",{type:"range",min:"1",max:"24",step:"1",value:i,onChange:e=>s(parseInt(e.target.value)),className:"w-full h-2 bg-white/10 rounded-lg appearance-none cursor-pointer accent-blue-500"}),(0,A.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-2",children:[(0,A.jsx)("span",{children:"1"}),(0,A.jsx)("span",{children:"12"}),(0,A.jsx)("span",{children:"24"})]})]}),(0,A.jsxs)("div",{children:[(0,A.jsxs)("label",{className:"block text-sm font-medium text-gray-400 mb-2 flex items-center",children:[(0,A.jsx)(s6,{size:16,className:"mr-2"})," ()"]}),(0,A.jsx)("input",{type:"password",required:!0,value:a,onChange:e=>o(e.target.value),placeholder:"",className:"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all"}),(0,A.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"   .   ."})]}),(0,A.jsx)("button",{type:"submit",disabled:!a,className:a2("w-full py-4 rounded-xl font-bold text-lg transition-all",a?"bg-blue-600 hover:bg-blue-700 text-white shadow-lg shadow-blue-600/20":"bg-gray-800 text-gray-500 cursor-not-allowed"),children:" "})]})]})}let a6=sY("key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);function a3({onBack:e,onJoin:t}){let[r,n]=(0,D.useState)(""),[i,s]=(0,D.useState)("");return(0,A.jsxs)(sK.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"w-full max-w-md mx-auto p-6",children:[(0,A.jsxs)("button",{onClick:e,className:"flex items-center text-gray-400 hover:text-white mb-8 transition-colors",children:[(0,A.jsx)(s2,{size:20,className:"mr-2"}),""]}),(0,A.jsx)("h2",{className:"text-3xl font-bold mb-8",children:" "}),(0,A.jsxs)("form",{onSubmit:e=>{e.preventDefault(),r&&i&&t(r,i)},className:"space-y-6",children:[(0,A.jsxs)("div",{children:[(0,A.jsxs)("label",{className:"block text-sm font-medium text-gray-400 mb-2 flex items-center",children:[(0,A.jsx)(a6,{size:16,className:"mr-2"})," ID"]}),(0,A.jsx)("input",{type:"text",required:!0,value:r,onChange:e=>n(e.target.value),placeholder:"Room ID ",className:"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-emerald-500 transition-all"})]}),(0,A.jsxs)("div",{children:[(0,A.jsxs)("label",{className:"block text-sm font-medium text-gray-400 mb-2 flex items-center",children:[(0,A.jsx)(s6,{size:16,className:"mr-2"}),""]}),(0,A.jsx)("input",{type:"password",required:!0,value:i,onChange:e=>s(e.target.value),placeholder:"",className:"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-emerald-500 transition-all"})]}),(0,A.jsx)("button",{type:"submit",disabled:!r||!i,className:a2("w-full py-4 rounded-xl font-bold text-lg transition-all",r&&i?"bg-emerald-600 hover:bg-emerald-700 text-white shadow-lg shadow-emerald-600/20":"bg-gray-800 text-gray-500 cursor-not-allowed"),children:""})]})]})}let a4=sY("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),a8=sY("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),a7=sY("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),a9=sY("shield-alert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]),oe=sY("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),ot=sY("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);function or({room:e,messages:t,currentUser:r,onSendMessage:n,onExtend:i,onLeave:s}){let[a,o]=(0,D.useState)(""),[l,u]=(0,D.useState)(0),[h,c]=(0,D.useState)(!1),d=(0,D.useRef)(null);return(0,D.useEffect)(()=>{let t=setInterval(()=>{u(Math.max(0,Math.floor((e.expiresAt-Date.now())/1e3)))},1e3);return()=>clearInterval(t)},[e.expiresAt]),(0,D.useEffect)(()=>{d.current&&(d.current.scrollTop=d.current.scrollHeight)},[t]),(0,A.jsxs)("div",{className:"flex flex-col h-[90vh] max-w-4xl mx-auto w-full bg-black/40 rounded-3xl border border-white/10 overflow-hidden shadow-2xl",children:[(0,A.jsxs)("div",{className:"p-4 border-b border-white/10 bg-white/5 backdrop-blur-md flex items-center justify-between",children:[(0,A.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,A.jsx)("div",{className:"w-10 h-10 rounded-full bg-blue-600/20 flex items-center justify-center text-blue-500",children:(0,A.jsx)(a8,{size:20})}),(0,A.jsxs)("div",{children:[(0,A.jsx)("h3",{className:"font-bold text-lg leading-tight truncate max-w-[150px] md:max-w-[300px]",children:e.name||e.id}),(0,A.jsxs)("div",{className:"flex items-center text-xs text-gray-500 mt-1",children:[(0,A.jsxs)("button",{onClick:()=>{navigator.clipboard.writeText(e.id),c(!0),setTimeout(()=>c(!1),2e3)},className:"flex items-center hover:text-white transition-colors mr-3",children:["ID: ",e.id,h?(0,A.jsx)(ot,{size:12,className:"ml-1 text-emerald-500"}):(0,A.jsx)(oe,{size:12,className:"ml-1"})]}),(0,A.jsxs)("div",{className:"flex items-center text-orange-400",children:[(0,A.jsx)(s5,{size:12,className:"mr-1"}),function(e){if(e<=0)return"";let t=Math.floor(e/3600),r=Math.floor(e%3600/60);return`${t.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}:${(e%60).toString().padStart(2,"0")}`}(l)]})]})]})]}),(0,A.jsx)("button",{onClick:s,className:"p-2 hover:bg-white/10 rounded-full text-gray-400 hover:text-red-400 transition-all",title:" ",children:(0,A.jsx)(a7,{size:24})})]}),(0,A.jsx)(Q,{children:l>0&&l<=7200&&(0,A.jsxs)(sK.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"bg-orange-500/10 border-b border-orange-500/20 p-3 flex items-center justify-between",children:[(0,A.jsxs)("div",{className:"flex items-center text-orange-400 text-sm",children:[(0,A.jsx)(a9,{size:16,className:"mr-2"}),"  .   ?"]}),(0,A.jsx)("button",{onClick:i,className:"px-4 py-1.5 bg-orange-500 hover:bg-orange-600 text-white text-xs font-bold rounded-lg transition-colors",children:"4 "})]})}),(0,A.jsx)("div",{ref:d,className:"flex-1 overflow-y-auto p-6 space-y-6 scrollbar-thin scrollbar-thumb-white/10",children:0===t.length?(0,A.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-gray-600 space-y-4",children:[(0,A.jsx)("div",{className:"w-16 h-16 rounded-full border-2 border-dashed border-gray-800 flex items-center justify-center",children:(0,A.jsx)(on,{size:32})}),(0,A.jsx)("p",{children:"  .   !"})]}):t.map(e=>(0,A.jsxs)("div",{className:a2("flex flex-col max-w-[80%]",e.senderId===r.id?"ml-auto items-end":"items-start"),children:[(0,A.jsxs)("div",{className:"flex items-center space-x-2 mb-1 px-1",children:[(0,A.jsx)("span",{className:"text-xs font-medium text-gray-500",children:e.nickname}),(0,A.jsx)("span",{className:"text-[10px] text-gray-700",children:new Date(e.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),(0,A.jsx)("div",{className:a2("px-4 py-2.5 rounded-2xl text-sm leading-relaxed break-words",e.senderId===r.id?"bg-blue-600 text-white rounded-tr-none shadow-lg shadow-blue-600/10":"bg-white/10 text-gray-200 rounded-tl-none border border-white/5"),children:e.text})]},e.id))}),(0,A.jsx)("div",{className:"p-4 bg-white/5 border-t border-white/10",children:(0,A.jsxs)("form",{onSubmit:e=>{e.preventDefault(),a.trim()&&(n(a),o(""))},className:"flex space-x-3",children:[(0,A.jsx)("input",{type:"text",value:a,onChange:e=>o(e.target.value),placeholder:" ...",className:"flex-1 bg-white/5 border border-white/10 rounded-2xl px-6 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all placeholder:text-gray-600"}),(0,A.jsx)("button",{type:"submit",disabled:!a.trim(),className:a2("w-12 h-12 rounded-2xl flex items-center justify-center transition-all",a.trim()?"bg-blue-600 text-white shadow-lg shadow-blue-600/20 hover:scale-105":"bg-gray-800 text-gray-500 cursor-not-allowed"),children:(0,A.jsx)(a4,{size:20})})]})})]})}function on({size:e}){return(0,A.jsx)("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,A.jsx)("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})})}let oi=function(e){let t=[],r=0;for(let n=0;n<e.length;n++){let i=e.charCodeAt(n);i<128?t[r++]=i:(i<2048?t[r++]=i>>6|192:((64512&i)==55296&&n+1<e.length&&(64512&e.charCodeAt(n+1))==56320?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++n)),t[r++]=i>>18|240,t[r++]=i>>12&63|128):t[r++]=i>>12|224,t[r++]=i>>6&63|128),t[r++]=63&i|128)}return t},os=function(e){let t=[],r=0,n=0;for(;r<e.length;){let i=e[r++];if(i<128)t[n++]=String.fromCharCode(i);else if(i>191&&i<224){let s=e[r++];t[n++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){let s=((7&i)<<18|(63&e[r++])<<12|(63&e[r++])<<6|63&e[r++])-65536;t[n++]=String.fromCharCode(55296+(s>>10)),t[n++]=String.fromCharCode(56320+(1023&s))}else{let s=e[r++],a=e[r++];t[n++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&a)}}return t.join("")},oa={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();let r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let t=0;t<e.length;t+=3){let i=e[t],s=t+1<e.length,a=s?e[t+1]:0,o=t+2<e.length,l=o?e[t+2]:0,u=i>>2,h=(3&i)<<4|a>>4,c=(15&a)<<2|l>>6,d=63&l;!o&&(d=64,s||(c=64)),n.push(r[u],r[h],r[c],r[d])}return n.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(oi(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):os(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();let r=t?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let t=0;t<e.length;){let i=r[e.charAt(t++)],s=t<e.length?r[e.charAt(t)]:0,a=++t<e.length?r[e.charAt(t)]:64,o=++t<e.length?r[e.charAt(t)]:64;if(++t,null==i||null==s||null==a||null==o)throw new oo;let l=i<<2|s>>4;if(n.push(l),64!==a){let e=s<<4&240|a>>2;if(n.push(e),64!==o){let e=a<<6&192|o;n.push(e)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class oo extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}let ol=function(e){let t=oi(e);return oa.encodeByteArray(t,!0)},ou=function(e){return ol(e).replace(/\./g,"")},oh=function(e){try{return oa.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function oc(){return"u">typeof self?self:"u">typeof window?window:e.g}let od=()=>{try{return oc().__FIREBASE_DEFAULTS__||(()=>{if(void 0===N.default||void 0===N.default.env)return;let e=N.default.env.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)})()||(()=>{let e;if("u"<typeof document)return;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}let t=e&&oh(e[1]);return t&&JSON.parse(t)})()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},of=e=>od()?.emulatorHosts?.[e],op=()=>od()?.config,om=e=>od()?.[`_${e}`];class og{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,r))}}}function oy(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch{return!1}}async function ov(e){return(await fetch(e,{credentials:"include"})).ok}let ow={},ob=!1;function ox(e,t){if("u"<typeof window||"u"<typeof document||!oy(window.location.host)||ow[e]===t||ow[e]||ob)return;function r(e){return`__firebase__banner__${e}`}ow[e]=t;let n="__firebase__banner",i=function(){let e={prod:[],emulator:[]};for(let t of Object.keys(ow))ow[t]?e.emulator.push(t):e.prod.push(t);return e}().prod.length>0;function s(){let e,t,s=(e=document.getElementById(n),t=!1,e||((e=document.createElement("div")).setAttribute("id",n),t=!0),{created:t,element:e}),a=r("text"),o=document.getElementById(a)||document.createElement("span"),l=r("learnmore"),u=document.getElementById(l)||document.createElement("a"),h=r("preprendIcon"),c=document.getElementById(h)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(s.created){let e,t=s.element;t.style.display="flex",t.style.background="#7faaf0",t.style.position="fixed",t.style.bottom="5px",t.style.left="5px",t.style.padding=".5em",t.style.borderRadius="5px",t.style.alignItems="center",u.setAttribute("id",l),u.innerText="Learn more",u.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",u.setAttribute("target","__blank"),u.style.paddingLeft="5px",u.style.textDecoration="underline";let r=((e=document.createElement("span")).style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{let e;ob=!0,(e=document.getElementById(n))&&e.remove()},e);c.setAttribute("width","24"),c.setAttribute("id",h),c.setAttribute("height","24"),c.setAttribute("viewBox","0 0 24 24"),c.setAttribute("fill","none"),c.style.marginLeft="-6px",t.append(c,o,u,r),document.body.appendChild(t)}i?(o.innerText="Preview backend disconnected.",c.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(c.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,o.innerText="Preview backend running in this workspace."),o.setAttribute("id",a)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",s):s()}function oI(){return"u">typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function oT(){let t=od()?.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(e.g.process)}catch(e){return!1}}function oE(){return"u">typeof WorkerGlobalScope&&"u">typeof self&&self instanceof WorkerGlobalScope}function oS(){let e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function o_(){return!oT()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ok(){return!oT()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function oC(){try{return"object"==typeof indexedDB}catch(e){return!1}}function oA(){return new Promise((e,t)=>{try{let r=!0,n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),e(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{t(i.error?.message||"")}}catch(e){t(e)}})}function oD(){return!("u"<typeof navigator)&&!!navigator.cookieEnabled}class oN extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name="FirebaseError",Object.setPrototypeOf(this,oN.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,oP.prototype.create)}}class oP{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){var r,n;let i=t[0]||{},s=`${this.service}/${e}`,a=this.errors[e],o=a?(r=a,n=i,r.replace(oR,(e,t)=>{let r=n[t];return null!=r?String(r):`<${t}?>`})):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new oN(s,l,i)}}let oR=/\{\$([^}]+)}/g;function oM(e,t){if(e===t)return!0;let r=Object.keys(e),n=Object.keys(t);for(let i of r){if(!n.includes(i))return!1;let r=e[i],s=t[i];if(oO(r)&&oO(s)){if(!oM(r,s))return!1}else if(r!==s)return!1}for(let e of n)if(!r.includes(e))return!1;return!0}function oO(e){return null!==e&&"object"==typeof e}function oL(e){let t=[];for(let[r,n]of Object.entries(e))Array.isArray(n)?n.forEach(e=>{t.push(encodeURIComponent(r)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return t.length?"&"+t.join("&"):""}function oV(e){let t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){let[r,n]=e.split("=");t[decodeURIComponent(r)]=decodeURIComponent(n)}}),t}function oF(e){let t=e.indexOf("?");if(!t)return"";let r=e.indexOf("#",t);return e.substring(t,r>0?r:void 0)}class oj{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let n;if(void 0===e&&void 0===t&&void 0===r)throw Error("Missing Observer.");void 0===(n=!function(e,t){if("object"!=typeof e||null===e)return!1;for(let r of t)if(r in e&&"function"==typeof e[r])return!0;return!1}(e,["next","error","complete"])?{next:e,error:t,complete:r}:e).next&&(n.next=oU),void 0===n.error&&(n.error=oU),void 0===n.complete&&(n.complete=oU);let i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?n.error(this.finalError):n.complete()}catch(e){}}),this.observers.push(n),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"u">typeof console&&console.error&&console.error(e)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function oU(){}function oB(e,t=1e3,r=2){let n=t*Math.pow(r,e),i=Math.round(.5*n*(Math.random()-.5)*2);return Math.min(144e5,n+i)}function oz(e){return e&&e._delegate?e._delegate:e}class oq{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}let o$="[DEFAULT]";class oG{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let e=new og;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{let r=this.getOrInitializeService({instanceIdentifier:t});r&&e.resolve(r)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){let t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(e){if(r)return null;throw e}if(r)return null;throw Error(`Service ${this.name} is not available`)}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if("EAGER"===e.instantiationMode)try{this.getOrInitializeService({instanceIdentifier:o$})}catch(e){}for(let[e,t]of this.instancesDeferred.entries()){let r=this.normalizeInstanceIdentifier(e);try{let e=this.getOrInitializeService({instanceIdentifier:r});t.resolve(e)}catch(e){}}}}clearInstance(e=o$){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(e=o$){return this.instances.has(e)}getOptions(e=o$){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let n=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[e,t]of this.instancesDeferred.entries())r===this.normalizeInstanceIdentifier(e)&&t.resolve(n);return n}onInit(e,t){let r=this.normalizeInstanceIdentifier(t),n=this.onInitCallbacks.get(r)??new Set;n.add(e),this.onInitCallbacks.set(r,n);let i=this.instances.get(r);return i&&e(i,r),()=>{n.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let n of r)try{n(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){var r;let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e)===o$?void 0:r,options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=o$){return this.component?this.component.multipleInstances?e:o$:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class oK{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new oG(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}let oH=[];(d=p||(p={}))[d.DEBUG=0]="DEBUG",d[d.VERBOSE=1]="VERBOSE",d[d.INFO=2]="INFO",d[d.WARN=3]="WARN",d[d.ERROR=4]="ERROR",d[d.SILENT=5]="SILENT";let oW={debug:p.DEBUG,verbose:p.VERBOSE,info:p.INFO,warn:p.WARN,error:p.ERROR,silent:p.SILENT},oQ=p.INFO,oJ={[p.DEBUG]:"log",[p.VERBOSE]:"log",[p.INFO]:"info",[p.WARN]:"warn",[p.ERROR]:"error"},oY=(e,t,...r)=>{if(t<e.logLevel)return;let n=new Date().toISOString(),i=oJ[t];if(i)console[i](`[${n}]  ${e.name}:`,...r);else throw Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class oX{constructor(e){this.name=e,this._logLevel=oQ,this._logHandler=oY,this._userLogHandler=null,oH.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in p))throw TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?oW[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,p.DEBUG,...e),this._logHandler(this,p.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,p.VERBOSE,...e),this._logHandler(this,p.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,p.INFO,...e),this._logHandler(this,p.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,p.WARN,...e),this._logHandler(this,p.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,p.ERROR,...e),this._logHandler(this,p.ERROR,...e)}}let oZ=new WeakMap,o0=new WeakMap,o1=new WeakMap,o2=new WeakMap,o5=new WeakMap,o6={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return o0.get(e);if("objectStoreNames"===t)return e.objectStoreNames||o1.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return o3(e[t])},set:(e,t,r)=>(e[t]=r,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function o3(e){if(e instanceof IDBRequest){let t;return(t=new Promise((t,r)=>{let n=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(o3(e.result)),n()},s=()=>{r(e.error),n()};e.addEventListener("success",i),e.addEventListener("error",s)})).then(t=>{t instanceof IDBCursor&&oZ.set(t,e)}).catch(()=>{}),o5.set(t,e),t}if(o2.has(e))return o2.get(e);let t=function(e){if("function"==typeof e)return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(n||(n=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(o4(this),t),o3(oZ.get(this))}:function(...t){return o3(e.apply(o4(this),t))}:function(t,...r){let n=e.call(o4(this),t,...r);return o1.set(n,t.sort?t.sort():[t]),o3(n)};return e instanceof IDBTransaction&&function(e){if(o0.has(e))return;let t=new Promise((t,r)=>{let n=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),n()},s=()=>{r(e.error||new DOMException("AbortError","AbortError")),n()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)});o0.set(e,t)}(e),(r||(r=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(t=>e instanceof t)?new Proxy(e,o6):e}(e);return t!==e&&(o2.set(e,t),o5.set(t,e)),t}let o4=e=>o5.get(e);function o8(e,t,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){let a=indexedDB.open(e,t),o=o3(a);return n&&a.addEventListener("upgradeneeded",e=>{n(o3(a.result),e.oldVersion,e.newVersion,o3(a.transaction),e)}),r&&a.addEventListener("blocked",e=>r(e.oldVersion,e.newVersion,e)),o.then(e=>{s&&e.addEventListener("close",()=>s()),i&&e.addEventListener("versionchange",e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),o}let o7=["get","getKey","getAll","getAllKeys","count"],o9=["put","add","delete","clear"],le=new Map;function lt(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t))return;if(le.get(t))return le.get(t);let r=t.replace(/FromIndex$/,""),n=t!==r,i=o9.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||o7.includes(r)))return;let s=async function(e,...t){let s=this.transaction(e,i?"readwrite":"readonly"),a=s.store;return n&&(a=a.index(t.shift())),(await Promise.all([a[r](...t),i&&s.done]))[0]};return le.set(t,s),s}o6={...h=o6,get:(e,t,r)=>lt(e,t)||h.get(e,t,r),has:(e,t)=>!!lt(e,t)||h.has(e,t)};class lr{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{let t;if(t=e.getComponent(),t?.type!=="VERSION")return null;{let t=e.getImmediate();return`${t.library}/${t.version}`}}).filter(e=>e).join(" ")}}let ln="@firebase/app",li="0.14.7",ls=new oX("@firebase/app"),la="[DEFAULT]",lo={[ln]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/data-connect":"fire-data-connect","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","@firebase/ai":"fire-vertex","fire-js":"fire-js",firebase:"fire-js-all"},ll=new Map,lu=new Map,lh=new Map;function lc(e,t){try{e.container.addComponent(t)}catch(r){ls.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,r)}}function ld(e,t){e.container.addOrOverwriteComponent(t)}function lf(e){let t=e.name;if(lh.has(t))return ls.debug(`There were multiple attempts to register component ${t}.`),!1;for(let r of(lh.set(t,e),ll.values()))lc(r,e);for(let t of lu.values())lc(t,e);return!0}function lp(e,t){let r=e.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),e.container.getProvider(t)}function lm(e,t,r=la){lp(e,t).clearInstance(r)}function lg(e){return void 0!==e.options}function ly(e){return!lg(e)&&("authIdToken"in e||"appCheckToken"in e||"releaseOnDeref"in e||"automaticDataCollectionEnabled"in e)}function lv(e){return null!=e&&void 0!==e.settings}function lw(){lh.clear()}let lb=new oP("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class lx{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new oq("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw lb.create("app-deleted",{appName:this._name})}}function lI(e,t){let r=oh(e.split(".")[1]);null===r?console.error(`FirebaseServerApp ${t} is invalid: second part could not be parsed.`):void 0===JSON.parse(r).exp?console.error(`FirebaseServerApp ${t} is invalid: expiration claim could not be parsed`):1e3*JSON.parse(r).exp-new Date().getTime()<=0&&console.error(`FirebaseServerApp ${t} is invalid: the token has expired.`)}class lT extends lx{constructor(e,t,r,n){const i=void 0===t.automaticDataCollectionEnabled||t.automaticDataCollectionEnabled,s={name:r,automaticDataCollectionEnabled:i};void 0!==e.apiKey?super(e,s,n):super(e.options,s,n),this._serverConfig={automaticDataCollectionEnabled:i,...t},this._serverConfig.authIdToken&&lI(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&lI(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,"u">typeof FinalizationRegistry&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,lD(ln,li,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,void 0!==e&&null!==this._finalizationRegistry&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){lA(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw lb.create("server-app-deleted")}}let lE="12.8.0";function lS(e,t={}){let r=e;"object"!=typeof t&&(t={name:t});let n={name:la,automaticDataCollectionEnabled:!0,...t},i=n.name;if("string"!=typeof i||!i)throw lb.create("bad-app-name",{appName:String(i)});if(r||(r=op()),!r)throw lb.create("no-options");let s=ll.get(i);if(s)if(oM(r,s.options)&&oM(n,s.config))return s;else throw lb.create("duplicate-app",{appName:i});let a=new oK(i);for(let e of lh.values())a.addComponent(e);let o=new lx(r,n,a);return ll.set(i,o),o}function l_(e,t={}){let r;if(("u">typeof window||oE())&&!oE())throw lb.create("invalid-server-app-environment");let n=t||{};if(e&&(lg(e)?r=e.options:ly(e)?n=e:r=e),void 0===n.automaticDataCollectionEnabled&&(n.automaticDataCollectionEnabled=!0),r||(r=op()),!r)throw lb.create("no-options");let i={...n,...r};if(void 0!==i.releaseOnDeref&&delete i.releaseOnDeref,void 0!==n.releaseOnDeref&&"u"<typeof FinalizationRegistry)throw lb.create("finalization-registry-not-supported",{});let s=""+[...JSON.stringify(i)].reduce((e,t)=>Math.imul(31,e)+t.charCodeAt(0)|0,0),a=lu.get(s);if(a)return a.incRefCount(n.releaseOnDeref),a;let o=new oK(s);for(let e of lh.values())o.addComponent(e);let l=new lT(r,n,s,o);return lu.set(s,l),l}function lk(e=la){let t=ll.get(e);if(!t&&e===la&&op())return lS();if(!t)throw lb.create("no-app",{appName:e});return t}function lC(){return Array.from(ll.values())}async function lA(e){let t=!1,r=e.name;ll.has(r)?(t=!0,ll.delete(r)):lu.has(r)&&0>=e.decRefCount()&&(lu.delete(r),t=!0),t&&(await Promise.all(e.container.getProviders().map(e=>e.delete())),e.isDeleted=!0)}function lD(e,t,r){let n=lo[e]??e;r&&(n+=`-${r}`);let i=n.match(/\s|\//),s=t.match(/\s|\//);if(i||s){let e=[`Unable to register library "${n}" with version "${t}":`];i&&e.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&s&&e.push("and"),s&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),ls.warn(e.join(" "));return}lf(new oq(`${n}-version`,()=>({library:n,version:t}),"VERSION"))}function lN(e,t){if(null!==e&&"function"!=typeof e)throw lb.create("invalid-log-argument");for(let r of oH){let n=null;t&&t.level&&(n=oW[t.level]),null===e?r.userLogHandler=null:r.userLogHandler=(t,r,...i)=>{let s=i.map(e=>{if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(e){return null}}).filter(e=>e).join(" ");r>=(n??t.logLevel)&&e({level:p[r].toLowerCase(),message:s,args:i,type:t.name})}}}function lP(e){oH.forEach(t=>{t.setLogLevel(e)})}let lR="firebase-heartbeat-store",lM=null;function lO(){return lM||(lM=o8("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(lR)}catch(e){console.warn(e)}}}).catch(e=>{throw lb.create("idb-open",{originalErrorMessage:e.message})})),lM}async function lL(e){try{let t=(await lO()).transaction(lR),r=await t.objectStore(lR).get(lF(e));return await t.done,r}catch(e){if(e instanceof oN)ls.warn(e.message);else{let t=lb.create("idb-get",{originalErrorMessage:e?.message});ls.warn(t.message)}}}async function lV(e,t){try{let r=(await lO()).transaction(lR,"readwrite"),n=r.objectStore(lR);await n.put(t,lF(e)),await r.done}catch(e){if(e instanceof oN)ls.warn(e.message);else{let t=lb.create("idb-set",{originalErrorMessage:e?.message});ls.warn(t.message)}}}function lF(e){return`${e.name}!${e.options.appId}`}class lj{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new lB(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){try{let e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=lU();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===t||this._heartbeatsCache.heartbeats.some(e=>e.date===t))return;if(this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats.length>30){let e=function(e){if(0===e.length)return -1;let t=0,r=e[0].date;for(let n=1;n<e.length;n++)e[n].date<r&&(r=e[n].date,t=n);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){ls.warn(e)}}async getHeartbeatsHeader(){try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||0===this._heartbeatsCache.heartbeats.length)return"";let e=lU(),{heartbeatsToSend:t,unsentEntries:r}=function(e,t=1024){let r=[],n=e.slice();for(let i of e){let e=r.find(e=>e.agent===i.agent);if(e){if(e.dates.push(i.date),lz(r)>t){e.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),lz(r)>t){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}(this._heartbeatsCache.heartbeats),n=ou(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),n}catch(e){return ls.warn(e),""}}}function lU(){return new Date().toISOString().substring(0,10)}class lB{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!oC()&&oA().then(()=>!0).catch(()=>!1)}async read(){if(!await this._canUseIndexedDBPromise)return{heartbeats:[]};{let e=await lL(this.app);return e?.heartbeats?e:{heartbeats:[]}}}async overwrite(e){if(await this._canUseIndexedDBPromise){let t=await this.read();return lV(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??t.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){if(await this._canUseIndexedDBPromise){let t=await this.read();return lV(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??t.lastSentHeartbeatDate,heartbeats:[...t.heartbeats,...e.heartbeats]})}}}function lz(e){return ou(JSON.stringify({version:2,heartbeats:e})).length}lf(new oq("platform-logger",e=>new lr(e),"PRIVATE")),lf(new oq("heartbeat",e=>new lj(e),"PRIVATE")),lD(ln,li,""),lD(ln,li,"esm2020"),lD("fire-js",""),e.s(["SDK_VERSION",()=>lE,"_DEFAULT_ENTRY_NAME",()=>la,"_addComponent",()=>lc,"_addOrOverwriteComponent",()=>ld,"_apps",()=>ll,"_clearComponents",()=>lw,"_components",()=>lh,"_getProvider",()=>lp,"_isFirebaseApp",()=>lg,"_isFirebaseServerApp",()=>lv,"_isFirebaseServerAppSettings",()=>ly,"_registerComponent",()=>lf,"_removeServiceInstance",()=>lm,"_serverApps",()=>lu,"deleteApp",()=>lA,"getApp",()=>lk,"getApps",()=>lC,"initializeApp",()=>lS,"initializeServerApp",()=>l_,"onLog",()=>lN,"registerVersion",()=>lD,"setLogLevel",()=>lP],92953);var lq=e.i(67034),l$="u">typeof globalThis?globalThis:"u">typeof window?window:e.g,lG={};(function(){function e(){this.blockSize=-1,this.blockSize=64,this.g=[,,,,],this.C=Array(this.blockSize),this.o=this.h=0,this.u()}var t=function(){this.blockSize=-1};function r(){}function n(e,t,r){r||(r=0);let n=Array(16);if("string"==typeof t)for(var i=0;i<16;++i)n[i]=t.charCodeAt(r++)|t.charCodeAt(r++)<<8|t.charCodeAt(r++)<<16|t.charCodeAt(r++)<<24;else for(i=0;i<16;++i)n[i]=t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24;t=e.g[0],r=e.g[1],i=e.g[2];let s=e.g[3],a;a=t+(s^r&(i^s))+n[0]+0xd76aa478|0,a=s+(i^(t=r+(a<<7|a>>>25))&(r^i))+n[1]+0xe8c7b756|0,a=i+(r^(s=t+(a<<12|a>>>20))&(t^r))+n[2]+0x242070db|0,a=r+(t^(i=s+(a<<17|a>>>15))&(s^t))+n[3]+0xc1bdceee|0,a=t+(s^(r=i+(a<<22|a>>>10))&(i^s))+n[4]+0xf57c0faf|0,a=s+(i^(t=r+(a<<7|a>>>25))&(r^i))+n[5]+0x4787c62a|0,a=i+(r^(s=t+(a<<12|a>>>20))&(t^r))+n[6]+0xa8304613|0,a=r+(t^(i=s+(a<<17|a>>>15))&(s^t))+n[7]+0xfd469501|0,a=t+(s^(r=i+(a<<22|a>>>10))&(i^s))+n[8]+0x698098d8|0,a=s+(i^(t=r+(a<<7|a>>>25))&(r^i))+n[9]+0x8b44f7af|0,a=i+(r^(s=t+(a<<12|a>>>20))&(t^r))+n[10]+0xffff5bb1|0,a=r+(t^(i=s+(a<<17|a>>>15))&(s^t))+n[11]+0x895cd7be|0,a=t+(s^(r=i+(a<<22|a>>>10))&(i^s))+n[12]+0x6b901122|0,a=s+(i^(t=r+(a<<7|a>>>25))&(r^i))+n[13]+0xfd987193|0,a=i+(r^(s=t+(a<<12|a>>>20))&(t^r))+n[14]+0xa679438e|0,a=r+(t^(i=s+(a<<17|a>>>15))&(s^t))+n[15]+0x49b40821|0,r=i+(a<<22|a>>>10),a=t+(i^s&(r^i))+n[1]+0xf61e2562|0,t=r+(a<<5|a>>>27),a=s+(r^i&(t^r))+n[6]+0xc040b340|0,s=t+(a<<9|a>>>23),a=i+(t^r&(s^t))+n[11]+0x265e5a51|0,i=s+(a<<14|a>>>18),a=r+(s^t&(i^s))+n[0]+0xe9b6c7aa|0,r=i+(a<<20|a>>>12),a=t+(i^s&(r^i))+n[5]+0xd62f105d|0,t=r+(a<<5|a>>>27),a=s+(r^i&(t^r))+n[10]+0x2441453|0,s=t+(a<<9|a>>>23),a=i+(t^r&(s^t))+n[15]+0xd8a1e681|0,i=s+(a<<14|a>>>18),a=r+(s^t&(i^s))+n[4]+0xe7d3fbc8|0,r=i+(a<<20|a>>>12),a=t+(i^s&(r^i))+n[9]+0x21e1cde6|0,t=r+(a<<5|a>>>27),a=s+(r^i&(t^r))+n[14]+0xc33707d6|0,s=t+(a<<9|a>>>23),a=i+(t^r&(s^t))+n[3]+0xf4d50d87|0,i=s+(a<<14|a>>>18),a=r+(s^t&(i^s))+n[8]+0x455a14ed|0,r=i+(a<<20|a>>>12),a=t+(i^s&(r^i))+n[13]+0xa9e3e905|0,t=r+(a<<5|a>>>27),a=s+(r^i&(t^r))+n[2]+0xfcefa3f8|0,s=t+(a<<9|a>>>23),a=i+(t^r&(s^t))+n[7]+0x676f02d9|0,i=s+(a<<14|a>>>18),a=r+(s^t&(i^s))+n[12]+0x8d2a4c8a|0,a=t+((r=i+(a<<20|a>>>12))^i^s)+n[5]+0xfffa3942|0,a=s+((t=r+(a<<4|a>>>28))^r^i)+n[8]+0x8771f681|0,a=i+((s=t+(a<<11|a>>>21))^t^r)+n[11]+0x6d9d6122|0,a=r+((i=s+(a<<16|a>>>16))^s^t)+n[14]+0xfde5380c|0,a=t+((r=i+(a<<23|a>>>9))^i^s)+n[1]+0xa4beea44|0,a=s+((t=r+(a<<4|a>>>28))^r^i)+n[4]+0x4bdecfa9|0,a=i+((s=t+(a<<11|a>>>21))^t^r)+n[7]+0xf6bb4b60|0,a=r+((i=s+(a<<16|a>>>16))^s^t)+n[10]+0xbebfbc70|0,a=t+((r=i+(a<<23|a>>>9))^i^s)+n[13]+0x289b7ec6|0,a=s+((t=r+(a<<4|a>>>28))^r^i)+n[0]+0xeaa127fa|0,a=i+((s=t+(a<<11|a>>>21))^t^r)+n[3]+0xd4ef3085|0,a=r+((i=s+(a<<16|a>>>16))^s^t)+n[6]+0x4881d05|0,a=t+((r=i+(a<<23|a>>>9))^i^s)+n[9]+0xd9d4d039|0,a=s+((t=r+(a<<4|a>>>28))^r^i)+n[12]+0xe6db99e5|0,a=i+((s=t+(a<<11|a>>>21))^t^r)+n[15]+0x1fa27cf8|0,a=r+((i=s+(a<<16|a>>>16))^s^t)+n[2]+0xc4ac5665|0,r=i+(a<<23|a>>>9),a=t+(i^(r|~s))+n[0]+0xf4292244|0,t=r+(a<<6|a>>>26),a=s+(r^(t|~i))+n[7]+0x432aff97|0,s=t+(a<<10|a>>>22),a=i+(t^(s|~r))+n[14]+0xab9423a7|0,i=s+(a<<15|a>>>17),a=r+(s^(i|~t))+n[5]+0xfc93a039|0,r=i+(a<<21|a>>>11),a=t+(i^(r|~s))+n[12]+0x655b59c3|0,t=r+(a<<6|a>>>26),a=s+(r^(t|~i))+n[3]+0x8f0ccc92|0,s=t+(a<<10|a>>>22),a=i+(t^(s|~r))+n[10]+0xffeff47d|0,i=s+(a<<15|a>>>17),a=r+(s^(i|~t))+n[1]+0x85845dd1|0,r=i+(a<<21|a>>>11),a=t+(i^(r|~s))+n[8]+0x6fa87e4f|0,t=r+(a<<6|a>>>26),a=s+(r^(t|~i))+n[15]+0xfe2ce6e0|0,s=t+(a<<10|a>>>22),a=i+(t^(s|~r))+n[6]+0xa3014314|0,i=s+(a<<15|a>>>17),a=r+(s^(i|~t))+n[13]+0x4e0811a1|0,r=i+(a<<21|a>>>11),a=t+(i^(r|~s))+n[4]+0xf7537e82|0,t=r+(a<<6|a>>>26),a=s+(r^(t|~i))+n[11]+0xbd3af235|0,s=t+(a<<10|a>>>22),a=i+(t^(s|~r))+n[2]+0x2ad7d2bb|0,i=s+(a<<15|a>>>17),a=r+(s^(i|~t))+n[9]+0xeb86d391|0,e.g[0]=e.g[0]+t|0,e.g[1]=e.g[1]+(i+(a<<21|a>>>11))|0,e.g[2]=e.g[2]+i|0,e.g[3]=e.g[3]+s|0}function i(e,t){this.h=t;let r=[],n=!0;for(let i=e.length-1;i>=0;i--){let s=0|e[i];n&&s==t||(r[i]=s,n=!1)}this.g=r}r.prototype=t.prototype,e.F=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.D=function(e,r,n){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[r].apply(e,i)},e.prototype.u=function(){this.g[0]=0x67452301,this.g[1]=0xefcdab89,this.g[2]=0x98badcfe,this.g[3]=0x10325476,this.o=this.h=0},e.prototype.v=function(e,t){void 0===t&&(t=e.length);let r=t-this.blockSize,i=this.C,s=this.h,a=0;for(;a<t;){if(0==s)for(;a<=r;)n(this,e,a),a+=this.blockSize;if("string"==typeof e){for(;a<t;)if(i[s++]=e.charCodeAt(a++),s==this.blockSize){n(this,i),s=0;break}}else for(;a<t;)if(i[s++]=e[a++],s==this.blockSize){n(this,i),s=0;break}}this.h=s,this.o+=t},e.prototype.A=function(){var e=Array((this.h<56?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;t=8*this.o;for(var r=e.length-8;r<e.length;++r)e[r]=255&t,t/=256;for(this.v(e),e=Array(16),t=0,r=0;r<4;++r)for(let n=0;n<32;n+=8)e[t++]=this.g[r]>>>n&255;return e};var s,a={};function o(e){var t;return -128<=e&&e<128?(t=function(e){return new i([0|e],e<0?-1:0)},Object.prototype.hasOwnProperty.call(a,e)?a[e]:a[e]=t(e)):new i([0|e],e<0?-1:0)}function l(e){if(isNaN(e)||!isFinite(e))return u;if(e<0)return p(l(-e));let t=[],r=1;for(let n=0;e>=r;n++)t[n]=e/r|0,r*=0x100000000;return new i(t,0)}var u=o(0),h=o(1),c=o(0x1000000);function d(e){if(0!=e.h)return!1;for(let t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function f(e){return -1==e.h}function p(e){let t=e.g.length,r=[];for(let n=0;n<t;n++)r[n]=~e.g[n];return new i(r,~e.h).add(h)}function y(e,t){return e.add(p(t))}function v(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function w(e,t){this.g=e,this.h=t}function b(e,t){if(d(t))throw Error("division by zero");if(d(e))return new w(u,u);if(f(e))return t=b(p(e),t),new w(p(t.g),p(t.h));if(f(t))return t=b(e,p(t)),new w(p(t.g),t.h);if(e.g.length>30){if(f(e)||f(t))throw Error("slowDivide_ only works with positive integers.");for(var r=h,n=t;0>=n.l(e);)r=x(r),n=x(n);var i=I(r,1),s=I(n,1);for(n=I(n,2),r=I(r,2);!d(n);){var a=s.add(n);0>=a.l(e)&&(i=i.add(r),s=a),n=I(n,1),r=I(r,1)}return t=y(e,i.j(t)),new w(i,t)}for(i=u;e.l(t)>=0;){for(n=(n=Math.ceil(Math.log(r=Math.max(1,Math.floor(e.m()/t.m())))/Math.LN2))<=48?1:Math.pow(2,n-48),a=(s=l(r)).j(t);f(a)||a.l(e)>0;)r-=n,a=(s=l(r)).j(t);d(s)&&(s=h),i=i.add(s),e=y(e,a)}return new w(i,e)}function x(e){let t=e.g.length+1,r=[];for(let n=0;n<t;n++)r[n]=e.i(n)<<1|e.i(n-1)>>>31;return new i(r,e.h)}function I(e,t){let r=t>>5;t%=32;let n=e.g.length-r,s=[];for(let i=0;i<n;i++)s[i]=t>0?e.i(i+r)>>>t|e.i(i+r+1)<<32-t:e.i(i+r);return new i(s,e.h)}(s=i.prototype).m=function(){if(f(this))return-p(this).m();let e=0,t=1;for(let r=0;r<this.g.length;r++){let n=this.i(r);e+=(n>=0?n:0x100000000+n)*t,t*=0x100000000}return e},s.toString=function(e){if((e=e||10)<2||36<e)throw Error("radix out of range: "+e);if(d(this))return"0";if(f(this))return"-"+p(this).toString(e);let t=l(Math.pow(e,6));var r=this;let n="";for(;;){let i=b(r,t).g,s=(((r=y(r,i.j(t))).g.length>0?r.g[0]:r.h)>>>0).toString(e);if(d(r=i))return s+n;for(;s.length<6;)s="0"+s;n=s+n}},s.i=function(e){return e<0?0:e<this.g.length?this.g[e]:this.h},s.l=function(e){return f(e=y(this,e))?-1:+!d(e)},s.abs=function(){return f(this)?p(this):this},s.add=function(e){let t=Math.max(this.g.length,e.g.length),r=[],n=0;for(let i=0;i<=t;i++){let t=n+(65535&this.i(i))+(65535&e.i(i)),s=(t>>>16)+(this.i(i)>>>16)+(e.i(i)>>>16);n=s>>>16,t&=65535,s&=65535,r[i]=s<<16|t}return new i(r,-0x80000000&r[r.length-1]?-1:0)},s.j=function(e){if(d(this)||d(e))return u;if(f(this))return f(e)?p(this).j(p(e)):p(p(this).j(e));if(f(e))return p(this.j(p(e)));if(0>this.l(c)&&0>e.l(c))return l(this.m()*e.m());let t=this.g.length+e.g.length,r=[];for(var n=0;n<2*t;n++)r[n]=0;for(n=0;n<this.g.length;n++)for(let t=0;t<e.g.length;t++){let i=this.i(n)>>>16,s=65535&this.i(n),a=e.i(t)>>>16,o=65535&e.i(t);r[2*n+2*t]+=s*o,v(r,2*n+2*t),r[2*n+2*t+1]+=i*o,v(r,2*n+2*t+1),r[2*n+2*t+1]+=s*a,v(r,2*n+2*t+1),r[2*n+2*t+2]+=i*a,v(r,2*n+2*t+2)}for(e=0;e<t;e++)r[e]=r[2*e+1]<<16|r[2*e];for(e=t;e<2*t;e++)r[e]=0;return new i(r,0)},s.B=function(e){return b(this,e).h},s.and=function(e){let t=Math.max(this.g.length,e.g.length),r=[];for(let n=0;n<t;n++)r[n]=this.i(n)&e.i(n);return new i(r,this.h&e.h)},s.or=function(e){let t=Math.max(this.g.length,e.g.length),r=[];for(let n=0;n<t;n++)r[n]=this.i(n)|e.i(n);return new i(r,this.h|e.h)},s.xor=function(e){let t=Math.max(this.g.length,e.g.length),r=[];for(let n=0;n<t;n++)r[n]=this.i(n)^e.i(n);return new i(r,this.h^e.h)},e.prototype.digest=e.prototype.A,e.prototype.reset=e.prototype.u,e.prototype.update=e.prototype.v,g=lG.Md5=e,i.prototype.add=i.prototype.add,i.prototype.multiply=i.prototype.j,i.prototype.modulo=i.prototype.B,i.prototype.compare=i.prototype.l,i.prototype.toNumber=i.prototype.m,i.prototype.toString=i.prototype.toString,i.prototype.getBits=i.prototype.i,i.fromNumber=l,i.fromString=function e(t,r){if(0==t.length)throw Error("number format error: empty string");if((r=r||10)<2||36<r)throw Error("radix out of range: "+r);if("-"==t.charAt(0))return p(e(t.substring(1),r));if(t.indexOf("-")>=0)throw Error('number format error: interior "-" character');let n=l(Math.pow(r,8)),i=u;for(let e=0;e<t.length;e+=8){var s=Math.min(8,t.length-e);let a=parseInt(t.substring(e,e+s),r);s<8?(s=l(Math.pow(r,s)),i=i.j(s).add(l(a))):i=(i=i.j(n)).add(l(a))}return i},m=lG.Integer=i}).apply(void 0!==l$?l$:"u">typeof self?self:"u">typeof window?window:{});var lK="u">typeof globalThis?globalThis:"u">typeof window?window:e.g,lH={};(function(){var e,t,r=Object.defineProperty,n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof lK&&lK];for(var t=0;t<e.length;++t){var r=e[t];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")}(this);function i(e,t){if(t)e:{var i=n;e=e.split(".");for(var s=0;s<e.length-1;s++){var a=e[s];if(!(a in i))break e;i=i[a]}(t=t(s=i[e=e[e.length-1]]))!=s&&null!=t&&r(i,e,{configurable:!0,writable:!0,value:t})}}i("Symbol.dispose",function(e){return e||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(e){return e||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(e){return e||function(e){var t,r=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&r.push([t,e[t]]);return r}});var s=s||{},a=this||self;function o(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function l(e,t,r){return e.call.apply(e.bind,arguments)}function u(e,t,r){return(u=l).apply(null,arguments)}function h(e,t){var r=Array.prototype.slice.call(arguments,1);return function(){var t=r.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function c(e,t){function r(){}r.prototype=t.prototype,e.Z=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.Ob=function(e,r,n){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[r].apply(e,i)}}var d="u">typeof AsyncContext&&"function"==typeof AsyncContext.Snapshot?e=>e&&AsyncContext.Snapshot.wrap(e):e=>e;function f(e){let t=e.length;if(t>0){let r=Array(t);for(let n=0;n<t;n++)r[n]=e[n];return r}return[]}function p(e,t){for(let t=1;t<arguments.length;t++){let n=arguments[t];var r=typeof n;if("array"==(r="object"!=r?r:n?Array.isArray(n)?"array":r:"null")||"object"==r&&"number"==typeof n.length){r=e.length||0;let t=n.length||0;e.length=r+t;for(let i=0;i<t;i++)e[r+i]=n[i]}else e.push(n)}}var m=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return this.h>0?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new g,e=>e.reset());class g{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let S,_=!1,k=new class{constructor(){this.h=this.g=null}add(e,t){let r=m.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}},C=()=>{let e=Promise.resolve(void 0);S=()=>{e.then(A)}};function A(){let e;for(var t;e=null,k.g&&(e=k.g,k.g=k.g.next,k.g||(k.h=null),e.next=null),t=e;){try{t.h.call(t.g)}catch(e){!function(e){a.setTimeout(()=>{throw e},0)}(e)}m.j(t),m.h<100&&(m.h++,t.next=m.g,m.g=t)}_=!1}function D(){this.u=this.u,this.C=this.C}function N(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}D.prototype.u=!1,D.prototype.dispose=function(){this.u||(this.u=!0,this.N())},D.prototype[Symbol.dispose]=function(){this.dispose()},D.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},N.prototype.h=function(){this.defaultPrevented=!0};var P=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{let e=()=>{};a.addEventListener("test",e,t),a.removeEventListener("test",e,t)}catch(e){}return e}();function R(e){return/^[\s\xa0]*$/.test(e)}function M(e,t){N.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e&&this.init(e,t)}c(M,N),M.prototype.init=function(e,t){let r=this.type=e.type,n=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;this.target=e.target||e.srcElement,this.g=t,(t=e.relatedTarget)||("mouseover"==r?t=e.fromElement:"mouseout"==r&&(t=e.toElement)),this.relatedTarget=t,n?(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=e.pointerType,this.state=e.state,this.i=e,e.defaultPrevented&&M.Z.h.call(this)},M.prototype.h=function(){M.Z.h.call(this);let e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var O="closure_listenable_"+(1e6*Math.random()|0),L=0;function V(e,t,r,n,i){this.listener=e,this.proxy=null,this.src=t,this.type=r,this.capture=!!n,this.ha=i,this.key=++L,this.da=this.fa=!1}function F(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function j(e,t,r){for(let n in e)t.call(r,e[n],n,e)}function U(e){let t={};for(let r in e)t[r]=e[r];return t}let B="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function z(e,t){let r,n;for(let t=1;t<arguments.length;t++){for(r in n=arguments[t])e[r]=n[r];for(let t=0;t<B.length;t++)r=B[t],Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}}function q(e){this.src=e,this.g={},this.h=0}function $(e,t){let r=t.type;if(r in e.g){var n,i=e.g[r],s=Array.prototype.indexOf.call(i,t,void 0);(n=s>=0)&&Array.prototype.splice.call(i,s,1),n&&(F(t),0==e.g[r].length&&(delete e.g[r],e.h--))}}function G(e,t,r,n){for(let i=0;i<e.length;++i){let s=e[i];if(!s.da&&s.listener==t&&!!r==s.capture&&s.ha==n)return i}return -1}q.prototype.add=function(e,t,r,n,i){let s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);let a=G(e,t,n,i);return a>-1?(t=e[a],r||(t.fa=!1)):((t=new V(t,this.src,s,!!n,i)).fa=r,e.push(t)),t};var K="closure_lm_"+(1e6*Math.random()|0),H={};function W(e,t,r,n,i,s){if(!t)throw Error("Invalid event type");let a=o(i)?!!i.capture:!!i,l=X(e);if(l||(e[K]=l=new q(e)),(r=l.add(t,r,n,a,s)).proxy)return r;if(n=function e(t){return Y.call(e.src,e.listener,t)},r.proxy=n,n.src=e,n.listener=r,e.addEventListener)P||(i=a),void 0===i&&(i=!1),e.addEventListener(t.toString(),n,i);else if(e.attachEvent)e.attachEvent(J(t.toString()),n);else if(e.addListener&&e.removeListener)e.addListener(n);else throw Error("addEventListener and attachEvent are unavailable.");return r}function Q(e){if("number"!=typeof e&&e&&!e.da){var t=e.src;if(t&&t[O])$(t.i,e);else{var r=e.type,n=e.proxy;t.removeEventListener?t.removeEventListener(r,n,e.capture):t.detachEvent?t.detachEvent(J(r),n):t.addListener&&t.removeListener&&t.removeListener(n),(r=X(t))?($(r,e),0==r.h&&(r.src=null,t[K]=null)):F(e)}}}function J(e){return e in H?H[e]:H[e]="on"+e}function Y(e,t){if(e.da)e=!0;else{t=new M(t,this);let r=e.listener,n=e.ha||e.src;e.fa&&Q(e),e=r.call(n,t)}return e}function X(e){return(e=e[K])instanceof q?e:null}var Z="__closure_events_fn_"+(1e9*Math.random()>>>0);function ee(e){return"function"==typeof e?e:(e[Z]||(e[Z]=function(t){return e.handleEvent(t)}),e[Z])}function et(){D.call(this),this.i=new q(this),this.M=this,this.G=null}function er(e,t){let r,n;var i,s=e.G;if(s)for(i=[];s;s=s.G)i.push(s);if(e=e.M,s=t.type||t,"string"==typeof t)t=new N(t,e);else if(t instanceof N)t.target=t.target||e;else{var a=t;z(t=new N(s,e),a)}if(a=!0,i)for(n=i.length-1;n>=0;n--)a=en(r=t.g=i[n],s,!0,t)&&a;if(a=en(r=t.g=e,s,!0,t)&&a,a=en(r,s,!1,t)&&a,i)for(n=0;n<i.length;n++)a=en(r=t.g=i[n],s,!1,t)&&a}function en(e,t,r,n){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();let i=!0;for(let s=0;s<t.length;++s){let a=t[s];if(a&&!a.da&&a.capture==r){let t=a.listener,r=a.ha||a.src;a.fa&&$(e.i,a),i=!1!==t.call(r,n)&&i}}return i&&!n.defaultPrevented}c(et,D),et.prototype[O]=!0,et.prototype.removeEventListener=function(e,t,r,n){!function e(t,r,n,i,s){if(Array.isArray(r))for(var a=0;a<r.length;a++)e(t,r[a],n,i,s);else(i=o(i)?!!i.capture:!!i,n=ee(n),t&&t[O])?(t=t.i,(a=String(r).toString())in t.g&&(n=G(r=t.g[a],n,i,s))>-1&&(F(r[n]),Array.prototype.splice.call(r,n,1),0==r.length&&(delete t.g[a],t.h--))):t&&(t=X(t))&&(r=t.g[r.toString()],t=-1,r&&(t=G(r,n,i,s)),(n=t>-1?r[t]:null)&&Q(n))}(this,e,t,r,n)},et.prototype.N=function(){if(et.Z.N.call(this),this.i){var e=this.i;for(let t in e.g){let r=e.g[t];for(let e=0;e<r.length;e++)F(r[e]);delete e.g[t],e.h--}}this.G=null},et.prototype.J=function(e,t,r,n){return this.i.add(String(e),t,!1,r,n)},et.prototype.K=function(e,t,r,n){return this.i.add(String(e),t,!0,r,n)};class ei extends D{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:function e(t){t.g=function(e,t){if("function"!=typeof e)if(e&&"function"==typeof e.handleEvent)e=u(e.handleEvent,e);else throw Error("Invalid listener argument");return Number(t)>0x7fffffff?-1:a.setTimeout(e,t||0)}(()=>{t.g=null,t.i&&(t.i=!1,e(t))},t.l);let r=t.h;t.h=null,t.m.apply(null,r)}(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function es(e){D.call(this),this.h=e,this.g={}}c(es,D);var ea=[];function eo(e){j(e.g,function(e,t){this.g.hasOwnProperty(t)&&Q(e)},e),e.g={}}es.prototype.N=function(){es.Z.N.call(this),eo(this)},es.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var el=a.JSON.stringify,eu=a.JSON.parse,eh=class{stringify(e){return a.JSON.stringify(e,void 0)}parse(e){return a.JSON.parse(e,void 0)}};function ec(){}function ed(){}var ef={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ep(){N.call(this,"d")}function em(){N.call(this,"c")}c(ep,N),c(em,N);var eg={},ey=null;function ev(){return ey=ey||new et}function ew(e){N.call(this,eg.Ia,e)}function eb(e){let t=ev();er(t,new ew(t))}function ex(e,t){N.call(this,eg.STAT_EVENT,e),this.stat=t}function eI(e){let t=ev();er(t,new ex(t,e))}function eT(e,t){N.call(this,eg.Ja,e),this.size=t}function eE(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){e()},t)}function eS(){this.g=!0}function e_(e,t,r,n){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{let s=JSON.parse(t);if(s){for(e=0;e<s.length;e++)if(Array.isArray(s[e])){var r=s[e];if(!(r.length<2)){var n=r[1];if(Array.isArray(n)&&!(n.length<1)){var i=n[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(let e=1;e<n.length;e++)n[e]=""}}}}return el(s)}catch(e){return t}}(e,r)+(n?" "+n:"")})}eg.Ia="serverreachability",c(ew,N),eg.STAT_EVENT="statevent",c(ex,N),eg.Ja="timingevent",c(eT,N),eS.prototype.ua=function(){this.g=!1},eS.prototype.info=function(){};var ek={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},eC={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"};function eA(){}function eD(e){return encodeURIComponent(String(e))}function eN(e,t,r,n){this.j=e,this.i=t,this.l=r,this.S=n||1,this.V=new es(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new eP}function eP(){this.i=null,this.g="",this.h=!1}c(eA,ec),eA.prototype.g=function(){return new XMLHttpRequest},e=new eA;var eR={},eM={};function eO(e,t,r){e.M=1,e.A=e3(e0(t)),e.u=r,e.R=!0,eL(e,null)}function eL(e,t){e.F=Date.now(),eF(e),e.B=e0(e.A);var r,n,i,s,a,l,h=e.B,c=e.S;Array.isArray(c)||(c=[String(c)]),tu(h.i,"t",c),e.C=0,h=e.j.L,e.h=new eP,e.g=tQ(e.j,h?t:null,!e.u),e.P>0&&(e.O=new ei(u(e.Y,e,e.g),e.P)),t=e.V,h=e.g,c=e.ba;var d="readystatechange";Array.isArray(d)||(d&&(ea[0]=d.toString()),d=ea);for(let e=0;e<d.length;e++){let r=function e(t,r,n,i,s){if(i&&i.once)return function e(t,r,n,i,s){if(Array.isArray(r)){for(let a=0;a<r.length;a++)e(t,r[a],n,i,s);return null}return n=ee(n),t&&t[O]?t.K(r,n,o(i)?!!i.capture:!!i,s):W(t,r,n,!0,i,s)}(t,r,n,i,s);if(Array.isArray(r)){for(let a=0;a<r.length;a++)e(t,r[a],n,i,s);return null}return n=ee(n),t&&t[O]?t.J(r,n,o(i)?!!i.capture:!!i,s):W(t,r,n,!1,i,s)}(h,d[e],c||t.handleEvent,!1,t.h||t);if(!r)break;t.g[r.key]=r}t=e.J?U(e.J):{},e.u?(e.v||(e.v="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.B,e.v,e.u,t)):(e.v="GET",e.g.ea(e.B,e.v,null,t)),eb(),r=e.i,n=e.v,i=e.B,s=e.l,a=e.S,l=e.u,r.info(function(){if(r.g)if(l){var e="",t=l.split("&");for(let r=0;r<t.length;r++){var o=t[r].split("=");if(o.length>1){let t=o[0];o=o[1];let r=t.split("_");e=r.length>=2&&"type"==r[1]?e+(t+"=")+o+"&":e+(t+"=redacted&")}}}else e=null;else e=l;return"XMLHTTP REQ ("+s+") [attempt "+a+"]: "+n+"\n"+i+"\n"+e})}function eV(e){return!!e.g&&"GET"==e.v&&2!=e.M&&e.j.Aa}function eF(e){e.T=Date.now()+e.H,ej(e,e.H)}function ej(e,t){if(null!=e.D)throw Error("WatchDog timer not null");e.D=eE(u(e.aa,e),t)}function eU(e){e.D&&(a.clearTimeout(e.D),e.D=null)}function eB(e){0==e.j.I||e.K||t$(e.j,e)}function ez(e){eU(e);var t=e.O;t&&"function"==typeof t.dispose&&t.dispose(),e.O=null,eo(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.dispose())}function eq(e,t){try{var r=e.j;if(0!=r.I&&(r.g==e||eW(r.h,e))){if(!e.L&&eW(r.h,e)&&3==r.I){try{var n=r.Ba.g.parse(t)}catch(e){n=null}if(Array.isArray(n)&&3==n.length){var i=n;if(0==i[0]){e:if(!r.v){if(r.g)if(r.g.F+3e3<e.F)tq(r),tR(r);else break e;tU(r),eI(18)}}else r.xa=i[1],0<r.xa-r.K&&i[2]<37500&&r.F&&0==r.A&&!r.C&&(r.C=eE(u(r.Va,r),6e3));1>=eH(r.h)&&r.ta&&(r.ta=void 0)}else tK(r,11)}else if((e.L||r.g==e)&&tq(r),!R(t))for(i=r.Ba.g.parse(t),t=0;t<i.length;t++){let o=i[t],l=o[0];if(!(l<=r.K))if(r.K=l,o=o[1],2==r.I)if("c"==o[0]){r.M=o[1],r.ba=o[2];let t=o[3];null!=t&&(r.ka=t,r.j.info("VER="+r.ka));let i=o[4];null!=i&&(r.za=i,r.j.info("SVER="+r.za));let l=o[5];null!=l&&"number"==typeof l&&l>0&&(r.O=n=1.5*l,r.j.info("backChannelRequestTimeoutMs_="+n)),n=r;let u=e.g;if(u){let e=u.g?u.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=n.h;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(eQ(s,s.h),s.h=null))}if(n.G){let e=u.g?u.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(n.wa=e,e6(n.J,n.G,e))}}if(r.I=3,r.l&&r.l.ra(),r.aa&&(r.T=Date.now()-e.F,r.j.info("Handshake RTT: "+r.T+"ms")),(n=r).na=tW(n,n.L?n.ba:null,n.W),e.L){eJ(n.h,e);var a=n.O;a&&(e.H=a),e.D&&(eU(e),eF(e)),n.g=e}else tj(n);r.i.length>0&&tO(r)}else"stop"!=o[0]&&"close"!=o[0]||tK(r,7);else 3==r.I&&("stop"==o[0]||"close"==o[0]?"stop"==o[0]?tK(r,7):tP(r):"noop"!=o[0]&&r.l&&r.l.qa(o),r.A=0)}}eb(4)}catch(e){}}eN.prototype.ba=function(e){e=e.target;let t=this.O;t&&3==tC(e)?t.j():this.Y(e)},eN.prototype.Y=function(e){try{if(e==this.g)e:{let f=tC(this.g),p=this.g.ya(),m=this.g.ca();if(!(f<3)&&(3!=f||this.g&&(this.h.h||this.g.la()||tA(this.g)))){this.K||4!=f||7==p||(8==p||m<=0?eb(3):eb(2)),eU(this);var t=this.g.ca();this.X=t;var r=function(e){if(!eV(e))return e.g.la();let t=tA(e.g);if(""===t)return"";let r="",n=t.length,i=4==tC(e.g);if(!e.h.i){if("u"<typeof TextDecoder)return ez(e),eB(e),"";e.h.i=new a.TextDecoder}for(let s=0;s<n;s++)e.h.h=!0,r+=e.h.i.decode(t[s],{stream:!(i&&s==n-1)});return t.length=0,e.h.g+=r,e.C=0,e.h.g}(this);if(this.o=200==t,n=this.i,i=this.v,s=this.B,o=this.l,l=this.S,n.info(function(){return"XMLHTTP RESP ("+o+") [ attempt "+l+"]: "+i+"\n"+s+"\n"+f+" "+t}),this.o){if(this.U&&!this.L){t:{if(this.g){var n,i,s,o,l,u,h=this.g;if((u=h.g?h.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!R(u)){var c=u;break t}}c=null}if(e=c)e_(this.i,this.l,e,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,eq(this,e);else{this.o=!1,this.m=3,eI(12),ez(this),eB(this);break e}}if(this.R){let t;for(e=!0;!this.K&&this.C<r.length;)if((t=function(e,t){var r=e.C,n=t.indexOf("\n",r);return -1==n?eM:isNaN(r=Number(t.substring(r,n)))?eR:(n+=1)+r>t.length?eM:(t=t.slice(n,n+r),e.C=n+r,t)}(this,r))==eM){4==f&&(this.m=4,eI(14),e=!1),e_(this.i,this.l,null,"[Incomplete Response]");break}else if(t==eR){this.m=4,eI(15),e_(this.i,this.l,r,"[Invalid Chunk]"),e=!1;break}else e_(this.i,this.l,t,null),eq(this,t);if(eV(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=f||0!=r.length||this.h.h||(this.m=1,eI(16),e=!1),this.o=this.o&&e,e){if(r.length>0&&!this.W){this.W=!0;var d=this.j;d.g==this&&d.aa&&!d.P&&(d.j.info("Great, no buffering proxy detected. Bytes received: "+r.length),tB(d),d.P=!0,eI(11))}}else e_(this.i,this.l,r,"[Invalid Chunked Response]"),ez(this),eB(this)}else e_(this.i,this.l,r,null),eq(this,r);4==f&&ez(this),this.o&&!this.K&&(4==f?t$(this.j,this):(this.o=!1,eF(this)))}else(function(e){let t={};e=(e.g&&tC(e)>=2&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let n=0;n<e.length;n++){if(R(e[n]))continue;var r=function(e){var t=1;e=e.split(":");let r=[];for(;t>0&&e.length;)r.push(e.shift()),t--;return e.length&&r.push(e.join(":")),r}(e[n]);let i=r[0];if("string"!=typeof(r=r[1]))continue;r=r.trim();let s=t[i]||[];t[i]=s,s.push(r)}var n=function(e){return e.join(", ")};for(let e in t)n.call(void 0,t[e],e,t)})(this.g),400==t&&r.indexOf("Unknown SID")>0?(this.m=3,eI(12)):(this.m=0,eI(13)),ez(this),eB(this)}}}catch(e){}finally{}},eN.prototype.cancel=function(){this.K=!0,ez(this)},eN.prototype.aa=function(){var e,t;this.D=null;let r=Date.now();r-this.T>=0?(e=this.i,t=this.B,e.info(function(){return"TIMEOUT: "+t}),2!=this.M&&(eb(),eI(17)),ez(this),this.m=2,eB(this)):ej(this,this.T-r)};var e$=class{constructor(e,t){this.g=e,this.map=t}};function eG(e){this.l=e||10,e=a.PerformanceNavigationTiming?(e=a.performance.getEntriesByType("navigation")).length>0&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function eK(e){return!!e.h||!!e.g&&e.g.size>=e.j}function eH(e){return e.h?1:e.g?e.g.size:0}function eW(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function eQ(e,t){e.g?e.g.add(t):e.h=t}function eJ(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function eY(e){if(null!=e.h)return e.i.concat(e.h.G);if(null!=e.g&&0!==e.g.size){let t=e.i;for(let r of e.g.values())t=t.concat(r.G);return t}return f(e.i)}eG.prototype.cancel=function(){if(this.i=eY(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(let e of this.g.values())e.cancel();this.g.clear()}};var eX=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function eZ(e){let t;this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1,e instanceof eZ?(this.l=e.l,e1(this,e.j),this.o=e.o,this.g=e.g,e2(this,e.u),this.h=e.h,e5(this,th(e.i)),this.m=e.m):e&&(t=String(e).match(eX))?(this.l=!1,e1(this,t[1]||"",!0),this.o=e4(t[2]||""),this.g=e4(t[3]||"",!0),e2(this,t[4]),this.h=e4(t[5]||"",!0),e5(this,t[6]||"",!0),this.m=e4(t[7]||"")):(this.l=!1,this.i=new ti(null,this.l))}function e0(e){return new eZ(e)}function e1(e,t,r){e.j=r?e4(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function e2(e,t){if(t){if(isNaN(t=Number(t))||t<0)throw Error("Bad port number "+t);e.u=t}else e.u=null}function e5(e,t,r){var n,i;t instanceof ti?(e.i=t,n=e.i,(i=e.l)&&!n.j&&(ts(n),n.i=null,n.g.forEach(function(e,t){let r=t.toLowerCase();t!=r&&(ta(this,t),tu(this,r,e))},n)),n.j=i):(r||(t=e8(t,tr)),e.i=new ti(t,e.l))}function e6(e,t,r){e.i.set(t,r)}function e3(e){return e6(e,"zx",Math.floor(0x80000000*Math.random()).toString(36)+Math.abs(Math.floor(0x80000000*Math.random())^Date.now()).toString(36)),e}function e4(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function e8(e,t,r){return"string"==typeof e?(e=encodeURI(e).replace(t,e7),r&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function e7(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}eZ.prototype.toString=function(){let e=[];var t=this.j;t&&e.push(e8(t,e9,!0),":");var r=this.g;return(r||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(e8(t,e9,!0),"@"),e.push(eD(r).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(r=this.u)&&e.push(":",String(r))),(r=this.h)&&(this.g&&"/"!=r.charAt(0)&&e.push("/"),e.push(e8(r,"/"==r.charAt(0)?tt:te,!0))),(r=this.i.toString())&&e.push("?",r),(r=this.m)&&e.push("#",e8(r,tn)),e.join("")},eZ.prototype.resolve=function(e){let t=e0(this),r=!!e.j;r?e1(t,e.j):r=!!e.o,r?t.o=e.o:r=!!e.g,r?t.g=e.g:r=null!=e.u;var n=e.h;if(r)e2(t,e.u);else if(r=!!e.h){if("/"!=n.charAt(0))if(this.g&&!this.h)n="/"+n;else{var i=t.h.lastIndexOf("/");-1!=i&&(n=t.h.slice(0,i+1)+n)}if(".."==(i=n)||"."==i)n="";else if(-1!=i.indexOf("./")||-1!=i.indexOf("/.")){n=0==i.lastIndexOf("/",0),i=i.split("/");let e=[];for(let t=0;t<i.length;){let r=i[t++];"."==r?n&&t==i.length&&e.push(""):".."==r?((e.length>1||1==e.length&&""!=e[0])&&e.pop(),n&&t==i.length&&e.push("")):(e.push(r),n=!0)}n=e.join("/")}else n=i}return r?t.h=n:r=""!==e.i.toString(),r?e5(t,th(e.i)):r=!!e.m,r&&(t.m=e.m),t};var e9=/[#\/\?@]/g,te=/[#\?:]/g,tt=/[#\?]/g,tr=/[#\?@]/g,tn=/#/g;function ti(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function ts(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(let r=0;r<e.length;r++){let n=e[r].indexOf("="),i,s=null;n>=0?(i=e[r].substring(0,n),s=e[r].substring(n+1)):i=e[r],t(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(e.i,function(t,r){e.add(decodeURIComponent(t.replace(/\+/g," ")),r)}))}function ta(e,t){ts(e),t=tc(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function to(e,t){return ts(e),t=tc(e,t),e.g.has(t)}function tl(e,t){ts(e);let r=[];if("string"==typeof t)to(e,t)&&(r=r.concat(e.g.get(tc(e,t))));else for(e=Array.from(e.g.values()),t=0;t<e.length;t++)r=r.concat(e[t]);return r}function tu(e,t,r){ta(e,t),r.length>0&&(e.i=null,e.g.set(tc(e,t),f(r)),e.h+=r.length)}function th(e){let t=new ti;return t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),t}function tc(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function td(e,t,r,n,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),n(r)}catch(e){}}function tf(){this.g=new eh}function tp(e){this.i=e.Sb||null,this.h=e.ab||!1}function tm(e,t){et.call(this),this.H=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}function tg(e){e.j.read().then(e.Ma.bind(e)).catch(e.ga.bind(e))}function ty(e){e.readyState=4,e.l=null,e.j=null,e.B=null,tv(e)}function tv(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function tw(e){let t="";return j(e,function(e,r){t+=r,t+=":",t+=e,t+="\r\n"}),t}function tb(e,t,r){e:{for(n in r){var n=!1;break e}n=!0}n||(r=tw(r),"string"==typeof e?null!=r&&eD(r):e6(e,t,r))}function tx(e){et.call(this),this.headers=new Map,this.L=e||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}(t=ti.prototype).add=function(e,t){ts(this),this.i=null,e=tc(this,e);let r=this.g.get(e);return r||this.g.set(e,r=[]),r.push(t),this.h+=1,this},t.forEach=function(e,t){ts(this),this.g.forEach(function(r,n){r.forEach(function(r){e.call(t,r,n,this)},this)},this)},t.set=function(e,t){return ts(this),this.i=null,to(this,e=tc(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},t.get=function(e,t){return e&&(e=tl(this,e)).length>0?String(e[0]):t},t.toString=function(){if(this.i)return this.i;if(!this.g)return"";let e=[],t=Array.from(this.g.keys());for(let n=0;n<t.length;n++){var r=t[n];let i=eD(r);r=tl(this,r);for(let t=0;t<r.length;t++){let n=i;""!==r[t]&&(n+="="+eD(r[t])),e.push(n)}}return this.i=e.join("&")},c(tp,ec),tp.prototype.g=function(){return new tm(this.i,this.h)},c(tm,et),(t=tm.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.F=e,this.D=t,this.readyState=1,tv(this)},t.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;let t={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};e&&(t.body=e),(this.H||a).fetch(new Request(this.D,t)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&4!=this.readyState&&(this.g=!1,ty(this)),this.readyState=0},t.Pa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,tv(this)),this.g&&(this.readyState=3,tv(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(void 0!==a.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;tg(this)}else e.text().then(this.Oa.bind(this),this.ga.bind(this))},t.Ma=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.B.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?ty(this):tv(this),3==this.readyState&&tg(this)}},t.Oa=function(e){this.g&&(this.response=this.responseText=e,ty(this))},t.Na=function(e){this.g&&(this.response=e,ty(this))},t.ga=function(){this.g&&ty(this)},t.setRequestHeader=function(e,t){this.A.append(e,t)},t.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";let e=[],t=this.h.entries();for(var r=t.next();!r.done;)e.push((r=r.value)[0]+": "+r[1]),r=t.next();return e.join("\r\n")},Object.defineProperty(tm.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),c(tx,et);var tI=/^https?$/i,tT=["POST","PUT"];function tE(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.o=5,tS(e),tk(e)}function tS(e){e.A||(e.A=!0,er(e,"complete"),er(e,"error"))}function t_(e){if(e.h&&void 0!==s){if(e.v&&4==tC(e))setTimeout(e.Ca.bind(e),0);else if(er(e,"readystatechange"),4==tC(e)){e.h=!1;try{let s=e.ca();switch(s){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t,r,n=!0;break;default:n=!1}if(!(t=n)){if(r=0===s){let t=String(e.D).match(eX)[1]||null;!t&&a.self&&a.self.location&&(t=a.self.location.protocol.slice(0,-1)),r=!tI.test(t?t.toLowerCase():"")}t=r}if(t)er(e,"complete"),er(e,"success");else{e.o=6;try{var i=tC(e)>2?e.g.statusText:""}catch(e){i=""}e.l=i+" ["+e.ca()+"]",tS(e)}}finally{tk(e)}}}}function tk(e,t){if(e.g){e.m&&(clearTimeout(e.m),e.m=null);let r=e.g;e.g=null,t||er(e,"ready");try{r.onreadystatechange=null}catch(e){}}}function tC(e){return e.g?e.g.readyState:0}function tA(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.F){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function tD(e,t,r){return r&&r.internalChannelParams&&r.internalChannelParams[e]||t}function tN(e){this.za=0,this.i=[],this.j=new eS,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=tD("failFast",!1,e),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=tD("baseRetryDelayMs",5e3,e),this.Za=tD("retryDelaySeedMs",1e4,e),this.Ta=tD("forwardChannelMaxRetries",2,e),this.va=tD("forwardChannelRequestTimeoutMs",2e4,e),this.ma=e&&e.xmlHttpFactory||void 0,this.Ua=e&&e.Rb||void 0,this.Aa=e&&e.useFetchStreams||!1,this.O=void 0,this.L=e&&e.supportsCrossDomainXhr||!1,this.M="",this.h=new eG(e&&e.concurrentRequestLimit),this.Ba=new tf,this.S=e&&e.fastHandshake||!1,this.R=e&&e.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=e&&e.Pb||!1,e&&e.ua&&this.j.ua(),e&&e.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&e&&e.detectBufferingProxy||!1,this.ia=void 0,e&&e.longPollingTimeout&&e.longPollingTimeout>0&&(this.ia=e.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}function tP(e){if(tM(e),3==e.I){var t=e.V++,r=e0(e.J);if(e6(r,"SID",e.M),e6(r,"RID",t),e6(r,"TYPE","terminate"),tV(e,r),(t=new eN(e,e.j,t)).M=2,t.A=e3(e0(r)),r=!1,a.navigator&&a.navigator.sendBeacon)try{r=a.navigator.sendBeacon(t.A.toString(),"")}catch(e){}!r&&a.Image&&((new Image).src=t.A,r=!0),r||(t.g=tQ(t.j,null),t.g.ea(t.A)),t.F=Date.now(),eF(t)}tH(e)}function tR(e){e.g&&(tB(e),e.g.cancel(),e.g=null)}function tM(e){tR(e),e.v&&(a.clearTimeout(e.v),e.v=null),tq(e),e.h.cancel(),e.m&&("number"==typeof e.m&&a.clearTimeout(e.m),e.m=null)}function tO(e){if(!eK(e.h)&&!e.m){e.m=!0;var t=e.Ea;S||C(),_||(S(),_=!0),k.add(t,e),e.D=0}}function tL(e,t){var r;r=t?t.l:e.V++;let n=e0(e.J);e6(n,"SID",e.M),e6(n,"RID",r),e6(n,"AID",e.K),tV(e,n),e.u&&e.o&&tb(n,e.u,e.o),r=new eN(e,e.j,r,e.D+1),null===e.u&&(r.J=e.o),t&&(e.i=t.G.concat(e.i)),t=tF(e,r,1e3),r.H=Math.round(.5*e.va)+Math.round(.5*e.va*Math.random()),eQ(e.h,r),eO(r,n,t)}function tV(e,t){e.H&&j(e.H,function(e,r){e6(t,r,e)}),e.l&&j({},function(e,r){e6(t,r,e)})}function tF(e,t,r){r=Math.min(e.i.length,r);let n=e.l?u(e.l.Ka,e.l,e):null;e:{var i=e.i;let t=-1;for(;;){let e=["count="+r];-1==t?r>0?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let l=!0;for(let u=0;u<r;u++){var s=i[u].g;let r=i[u].map;if((s-=t)<0)t=Math.max(0,i[u].g-100),l=!1;else try{s="req"+s+"_";try{var a=r instanceof Map?r:Object.entries(r);for(let[t,r]of a){let n=r;o(r)&&(n=el(r)),e.push(s+t+"="+encodeURIComponent(n))}}catch(t){throw e.push(s+"type="+encodeURIComponent("_badmap")),t}}catch(e){n&&n(r)}}if(l){a=e.join("&");break e}}a=void 0}return t.G=e=e.i.splice(0,r),a}function tj(e){if(!e.g&&!e.v){e.Y=1;var t=e.Da;S||C(),_||(S(),_=!0),k.add(t,e),e.A=0}}function tU(e){return!e.g&&!e.v&&!(e.A>=3)&&(e.Y++,e.v=eE(u(e.Da,e),tG(e,e.A)),e.A++,!0)}function tB(e){null!=e.B&&(a.clearTimeout(e.B),e.B=null)}function tz(e){e.g=new eN(e,e.j,"rpc",e.Y),null===e.u&&(e.g.J=e.o),e.g.P=0;var t=e0(e.na);e6(t,"RID","rpc"),e6(t,"SID",e.M),e6(t,"AID",e.K),e6(t,"CI",e.F?"0":"1"),!e.F&&e.ia&&e6(t,"TO",e.ia),e6(t,"TYPE","xmlhttp"),tV(e,t),e.u&&e.o&&tb(t,e.u,e.o),e.O&&(e.g.H=e.O);var r=e.g;e=e.ba,r.M=1,r.A=e3(e0(t)),r.u=null,r.R=!0,eL(r,e)}function tq(e){null!=e.C&&(a.clearTimeout(e.C),e.C=null)}function t$(e,t){var r,n=null;if(e.g==t){tq(e),tB(e),e.g=null;var i=2}else{if(!eW(e.h,t))return;n=t.G,eJ(e.h,t),i=1}if(0!=e.I){if(t.o)if(1==i){n=t.u?t.u.length:0,t=Date.now()-t.F;var s=e.D;er(i=ev(),new eT(i,n)),tO(e)}else tj(e);else if(3==(s=t.m)||0==s&&t.X>0||!(1==i&&(r=t,!(eH(e.h)>=e.h.j-!!e.m)&&(e.m?(e.i=r.G.concat(e.i),!0):1!=e.I&&2!=e.I&&!(e.D>=(e.Sa?0:e.Ta))&&(e.m=eE(u(e.Ea,e,r),tG(e,e.D)),e.D++,!0)))||2==i&&tU(e)))switch(n&&n.length>0&&((t=e.h).i=t.i.concat(n)),s){case 1:tK(e,5);break;case 4:tK(e,10);break;case 3:tK(e,6);break;default:tK(e,2)}}}function tG(e,t){let r=e.Qa+Math.floor(Math.random()*e.Za);return e.isActive()||(r*=2),r*t}function tK(e,t){if(e.j.info("Error code "+t),2==t){let t,s,o;var r,n=u(e.bb,e),i=e.Ua;let l=!i;i=new eZ(i||"//www.google.com/images/cleardot.gif"),a.location&&"http"==a.location.protocol||e1(i,"https"),e3(i),l?function(e,t){let r=new eS;if(a.Image){let n=new Image;n.onload=h(td,r,"TestLoadImage: loaded",!0,t,n),n.onerror=h(td,r,"TestLoadImage: error",!1,t,n),n.onabort=h(td,r,"TestLoadImage: abort",!1,t,n),n.ontimeout=h(td,r,"TestLoadImage: timeout",!1,t,n),a.setTimeout(function(){n.ontimeout&&n.ontimeout()},1e4),n.src=e}else t(!1)}(i.toString(),n):(r=i.toString(),t=new eS,s=new AbortController,o=setTimeout(()=>{s.abort(),td(t,"TestPingServer: timeout",!1,n)},1e4),fetch(r,{signal:s.signal}).then(e=>{clearTimeout(o),e.ok?td(t,"TestPingServer: ok",!0,n):td(t,"TestPingServer: server error",!1,n)}).catch(()=>{clearTimeout(o),td(t,"TestPingServer: error",!1,n)}))}else eI(2);e.I=0,e.l&&e.l.pa(t),tH(e),tM(e)}function tH(e){if(e.I=0,e.ja=[],e.l){let t=eY(e.h);(0!=t.length||0!=e.i.length)&&(p(e.ja,t),p(e.ja,e.i),e.h.i.length=0,f(e.i),e.i.length=0),e.l.oa()}}function tW(e,t,r){var n=r instanceof eZ?e0(r):new eZ(r);if(""!=n.g)t&&(n.g=t+"."+n.g),e2(n,n.u);else{var i=a.location;n=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;let e=new eZ(null);n&&e1(e,n),t&&(e.g=t),i&&e2(e,i),r&&(e.h=r),n=e}return r=e.G,t=e.wa,r&&t&&e6(n,r,t),e6(n,"VER",e.ka),tV(e,n),n}function tQ(e,t,r){if(t&&!e.L)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new tx(e.Aa&&!e.ma?new tp({ab:r}):e.ma)).Fa(e.L),t}function tJ(){}function tY(){}function tX(e,t){et.call(this),this.g=new tN(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.sa&&(e?e["X-WebChannel-Client-Profile"]=t.sa:e={"X-WebChannel-Client-Profile":t.sa}),this.g.U=e,(e=t&&t.Qb)&&!R(e)&&(this.g.u=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!R(t)&&(this.g.G=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new t1(this)}function tZ(e){ep.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(let r in t){e=r;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function t0(){em.call(this),this.status=1}function t1(e){this.g=e}(t=tx.prototype).Fa=function(e){this.H=e},t.ea=function(t,r,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+t);r=r?r.toUpperCase():"GET",this.D=t,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():e.g(),this.g.onreadystatechange=d(u(this.Ca,this));try{this.B=!0,this.g.open(r,String(t),!0),this.B=!1}catch(e){tE(this,e);return}if(t=n||"",n=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var s in i)n.set(s,i[s]);else if("function"==typeof i.keys&&"function"==typeof i.get)for(let e of i.keys())n.set(e,i.get(e));else throw Error("Unknown input type for opt_headers: "+String(i));for(let[e,o]of(i=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),s=a.FormData&&t instanceof a.FormData,!(Array.prototype.indexOf.call(tT,r,void 0)>=0)||i||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),n))this.g.setRequestHeader(e,o);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(t),this.v=!1}catch(e){tE(this,e)}},t.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=e||7,er(this,"complete"),er(this,"abort"),tk(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),tk(this,!0)),tx.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?t_(this):this.Xa())},t.Xa=function(){t_(this)},t.isActive=function(){return!!this.g},t.ca=function(){try{return tC(this)>2?this.g.status:-1}catch(e){return -1}},t.la=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},t.La=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),eu(t)}},t.ya=function(){return this.o},t.Ha=function(){return"string"==typeof this.l?this.l:String(this.l)},(t=tN.prototype).ka=8,t.I=1,t.connect=function(e,t,r,n){eI(0),this.W=e,this.H=t||{},r&&void 0!==n&&(this.H.OSID=r,this.H.OAID=n),this.F=this.X,this.J=tW(this,null,this.W),tO(this)},t.Ea=function(e){if(this.m)if(this.m=null,1==this.I){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;let i=new eN(this,this.j,e),s=this.o;if(this.U&&(s?z(s=U(s),this.U):s=this.U),null!==this.u||this.R||(i.J=s,s=null),this.S)e:{for(var t=0,r=0;r<this.i.length;r++){t:{var n=this.i[r];if("__data__"in n.map&&"string"==typeof(n=n.map.__data__)){n=n.length;break t}n=void 0}if(void 0===n)break;if((t+=n)>4096){t=r;break e}if(4096===t||r===this.i.length-1){t=r+1;break e}}t=1e3}else t=1e3;t=tF(this,i,t),e6(r=e0(this.J),"RID",e),e6(r,"CVER",22),this.G&&e6(r,"X-HTTP-Session-Id",this.G),tV(this,r),s&&(this.R?t="headers="+eD(tw(s))+"&"+t:this.u&&tb(r,this.u,s)),eQ(this.h,i),this.Ra&&e6(r,"TYPE","init"),this.S?(e6(r,"$req",t),e6(r,"SID","null"),i.U=!0,eO(i,r,null)):eO(i,r,t),this.I=2}}else 3==this.I&&(e?tL(this,e):0==this.i.length||eK(this.h)||tL(this))},t.Da=function(){if(this.v=null,tz(this),this.aa&&!(this.P||null==this.g||this.T<=0)){var e=4*this.T;this.j.info("BP detection timer enabled: "+e),this.B=eE(u(this.Wa,this),e)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,eI(10),tR(this),tz(this))},t.Va=function(){null!=this.C&&(this.C=null,tR(this),tU(this),eI(19))},t.bb=function(e){e?(this.j.info("Successfully pinged google.com"),eI(2)):(this.j.info("Failed to ping google.com"),eI(1))},t.isActive=function(){return!!this.l&&this.l.isActive(this)},(t=tJ.prototype).ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){},tY.prototype.g=function(e,t){return new tX(e,t)},c(tX,et),tX.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},tX.prototype.close=function(){tP(this.g)},tX.prototype.o=function(e){var t=this.g;if("string"==typeof e){var r={};r.__data__=e,e=r}else this.v&&((r={}).__data__=el(e),e=r);t.i.push(new e$(t.Ya++,e)),3==t.I&&tO(t)},tX.prototype.N=function(){this.g.l=null,delete this.j,tP(this.g),delete this.g,tX.Z.N.call(this)},c(tZ,ep),c(t0,em),c(t1,tJ),t1.prototype.ra=function(){er(this.g,"a")},t1.prototype.qa=function(e){er(this.g,new tZ(e))},t1.prototype.pa=function(e){er(this.g,new t0)},t1.prototype.oa=function(){er(this.g,"b")},tY.prototype.createWebChannel=tY.prototype.g,tX.prototype.send=tX.prototype.o,tX.prototype.open=tX.prototype.m,tX.prototype.close=tX.prototype.close,E=lH.createWebChannelTransport=function(){return new tY},T=lH.getStatEventTarget=function(){return ev()},I=lH.Event=eg,x=lH.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ek.NO_ERROR=0,ek.TIMEOUT=8,ek.HTTP_ERROR=6,b=lH.ErrorCode=ek,eC.COMPLETE="complete",w=lH.EventType=eC,ed.EventType=ef,ef.OPEN="a",ef.CLOSE="b",ef.ERROR="c",ef.MESSAGE="d",et.prototype.listen=et.prototype.J,v=lH.WebChannel=ed,lH.FetchXmlHttpFactory=tp,tx.prototype.listenOnce=tx.prototype.K,tx.prototype.getLastError=tx.prototype.Ha,tx.prototype.getLastErrorCode=tx.prototype.ya,tx.prototype.getStatus=tx.prototype.ca,tx.prototype.getResponseJson=tx.prototype.La,tx.prototype.getResponseText=tx.prototype.la,tx.prototype.send=tx.prototype.ea,tx.prototype.setWithCredentials=tx.prototype.Fa,y=lH.XhrIo=tx}).apply(void 0!==lK?lK:"u">typeof self?self:"u">typeof window?window:{});class lW{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}lW.UNAUTHENTICATED=new lW(null),lW.GOOGLE_CREDENTIALS=new lW("google-credentials-uid"),lW.FIRST_PARTY=new lW("first-party-uid"),lW.MOCK_USER=new lW("mock-user");let lQ="12.8.0",lJ=new oX("@firebase/firestore");function lY(){return lJ.logLevel}function lX(e,...t){if(lJ.logLevel<=p.DEBUG){let r=t.map(l1);lJ.debug(`Firestore (${lQ}): ${e}`,...r)}}function lZ(e,...t){if(lJ.logLevel<=p.ERROR){let r=t.map(l1);lJ.error(`Firestore (${lQ}): ${e}`,...r)}}function l0(e,...t){if(lJ.logLevel<=p.WARN){let r=t.map(l1);lJ.warn(`Firestore (${lQ}): ${e}`,...r)}}function l1(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function l2(e,t,r){let n="Unexpected state";"string"==typeof t?n=t:r=t,l5(e,n,r)}function l5(e,t,r){let n=`FIRESTORE (${lQ}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(void 0!==r)try{n+=" CONTEXT: "+JSON.stringify(r)}catch(e){n+=" CONTEXT: "+r}throw lZ(n),Error(n)}function l6(e,t,r,n){let i="Unexpected state";"string"==typeof r?i=r:n=r,e||l5(t,i,n)}let l3={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class l4 extends oN{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class l8{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class l7{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class l9{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(lW.UNAUTHENTICATED))}shutdown(){}}class ue{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class ut{constructor(e){this.t=e,this.currentUser=lW.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){l6(void 0===this.o,42304);let r=this.i,n=e=>this.i!==r?(r=this.i,t(e)):Promise.resolve(),i=new l8;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new l8,e.enqueueRetryable(()=>n(this.currentUser))};let s=()=>{let t=i;e.enqueueRetryable(async()=>{await t.promise,await n(this.currentUser)})},a=e=>{lX("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(e=>a(e)),setTimeout(()=>{if(!this.auth){let e=this.t.getImmediate({optional:!0});e?a(e):(lX("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new l8)}},0),s()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(lX("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(l6("string"==typeof t.accessToken,31837,{l:t}),new l7(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return l6(null===e||"string"==typeof e,2055,{h:e}),new lW(e)}}class ur{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=lW.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);let e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class un{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new ur(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(lW.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class ui{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class us{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,lv(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){l6(void 0===this.o,3512);let r=e=>{null!=e.error&&lX("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);let r=e.token!==this.m;return this.m=e.token,lX("FirebaseAppCheckTokenProvider",`Received ${r?"new":"existing"} token.`),r?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>r(t))};let n=e=>{lX("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(e=>n(e)),setTimeout(()=>{if(!this.appCheck){let e=this.V.getImmediate({optional:!0});e?n(e):lX("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new ui(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(l6("string"==typeof e.token,44558,{tokenResult:e}),this.m=e.token,new ui(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}class ua{static newId(){let e=62*Math.floor(256/62),t="";for(;t.length<20;){let r=function(e){let t="u">typeof self&&(self.crypto||self.msCrypto),r=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(r);else for(let e=0;e<40;e++)r[e]=Math.floor(256*Math.random());return r}(0);for(let n=0;n<r.length;++n)t.length<20&&r[n]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(r[n]%62))}return t}}function uo(e,t){return e<t?-1:+(e>t)}function ul(e,t){let r=Math.min(e.length,t.length);for(let n=0;n<r;n++){let r=e.charAt(n),i=t.charAt(n);if(r!==i)return uu(r)===uu(i)?uo(r,i):uu(r)?1:-1}return uo(e.length,t.length)}function uu(e){let t=e.charCodeAt(0);return t>=55296&&t<=57343}function uh(e,t,r){return e.length===t.length&&e.every((e,n)=>r(e,t[n]))}let uc="__name__";class ud{constructor(e,t,r){void 0===t?t=0:t>e.length&&l2(637,{offset:t,range:e.length}),void 0===r?r=e.length-t:r>e.length-t&&l2(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===ud.comparator(this,e)}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof ud?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let n=0;n<r;n++){let r=ud.compareSegments(e.get(n),t.get(n));if(0!==r)return r}return uo(e.length,t.length)}static compareSegments(e,t){let r=ud.isNumericId(e),n=ud.isNumericId(t);return r&&!n?-1:!r&&n?1:r&&n?ud.extractNumericId(e).compare(ud.extractNumericId(t)):ul(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return m.fromString(e.substring(4,e.length-2))}}class uf extends ud{construct(e,t,r){return new uf(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new l4(l3.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(e=>e.length>0))}return new uf(t)}static emptyPath(){return new uf([])}}let up=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class um extends ud{construct(e,t,r){return new um(e,t,r)}static isValidIdentifier(e){return up.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),um.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===uc}static keyField(){return new um([uc])}static fromServerFormat(e){let t=[],r="",n=0,i=()=>{if(0===r.length)throw new l4(l3.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},s=!1;for(;n<e.length;){let t=e[n];if("\\"===t){if(n+1===e.length)throw new l4(l3.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let t=e[n+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new l4(l3.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=t,n+=2}else"`"===t?s=!s:"."!==t||s?r+=t:i(),n++}if(i(),s)throw new l4(l3.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new um(t)}static emptyPath(){return new um([])}}class ug{constructor(e){this.path=e}static fromPath(e){return new ug(uf.fromString(e))}static fromName(e){return new ug(uf.fromString(e).popFirst(5))}static empty(){return new ug(uf.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===uf.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return uf.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ug(new uf(e.slice()))}}function uy(e,t,r){if(!r)throw new l4(l3.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function uv(e){if(!ug.isDocumentKey(e))throw new l4(l3.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function uw(e){if(ug.isDocumentKey(e))throw new l4(l3.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function ub(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function ux(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{var t;let r=(t=e).constructor?t.constructor.name:null;return r?`a custom ${r} object`:"an object"}}return"function"==typeof e?"a function":l2(12329,{type:typeof e})}function uI(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new l4(l3.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let r=ux(e);throw new l4(l3.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${r}`)}}return e}function uT(e,t){if(t<=0)throw new l4(l3.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}function uE(e,t){let r={typeString:e};return t&&(r.value=t),r}function uS(e,t){let r;if(!ub(e))throw new l4(l3.INVALID_ARGUMENT,"JSON must be an object");for(let n in t)if(t[n]){let i=t[n].typeString,s="value"in t[n]?{value:t[n].value}:void 0;if(!(n in e)){r=`JSON missing required field: '${n}'`;break}let a=e[n];if(i&&typeof a!==i){r=`JSON field '${n}' must be a ${i}.`;break}if(void 0!==s&&a!==s.value){r=`Expected '${n}' field to equal '${s.value}'`;break}}if(r)throw new l4(l3.INVALID_ARGUMENT,r);return!0}class u_{static now(){return u_.fromMillis(Date.now())}static fromDate(e){return u_.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*1e6);return new u_(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0||t>=1e9)throw new l4(l3.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-0xe7791f700||e>=0x3afff44180)throw new l4(l3.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?uo(this.nanoseconds,e.nanoseconds):uo(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:u_._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(uS(e,u_._jsonSchema))return new u_(e.seconds,e.nanoseconds)}valueOf(){return String(this.seconds- -0xe7791f700).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}u_._jsonSchemaVersion="firestore/timestamp/1.0",u_._jsonSchema={type:uE("string",u_._jsonSchemaVersion),seconds:uE("number"),nanoseconds:uE("number")};class uk{static fromTimestamp(e){return new uk(e)}static min(){return new uk(new u_(0,0))}static max(){return new uk(new u_(0x3afff4417f,0x3b9ac9ff))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class uC{constructor(e,t,r,n){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=n}}function uA(e){return e.fields.find(e=>2===e.kind)}function uD(e){return e.fields.filter(e=>2!==e.kind)}function uN(e,t){let r=uo(e.collectionGroup,t.collectionGroup);if(0!==r)return r;for(let n=0;n<Math.min(e.fields.length,t.fields.length);++n)if(0!==(r=function(e,t){let r=um.comparator(e.fieldPath,t.fieldPath);return 0!==r?r:uo(e.kind,t.kind)}(e.fields[n],t.fields[n])))return r;return uo(e.fields.length,t.fields.length)}uC.UNKNOWN_ID=-1;class uP{constructor(e,t){this.fieldPath=e,this.kind=t}}class uR{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new uR(0,uL.min())}}function uM(e,t){let r=e.toTimestamp().seconds,n=e.toTimestamp().nanoseconds+1;return new uL(uk.fromTimestamp(1e9===n?new u_(r+1,0):new u_(r,n)),ug.empty(),t)}function uO(e){return new uL(e.readTime,e.key,-1)}class uL{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new uL(uk.min(),ug.empty(),-1)}static max(){return new uL(uk.max(),ug.empty(),-1)}}function uV(e,t){let r=e.readTime.compareTo(t.readTime);return 0!==r||0!==(r=ug.comparator(e.documentKey,t.documentKey))?r:uo(e.largestBatchId,t.largestBatchId)}let uF="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class uj{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function uU(e){if(e.code!==l3.FAILED_PRECONDITION||e.message!==uF)throw e;lX("LocalStore","Unexpectedly lost primary lease")}class uB{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&l2(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new uB((r,n)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(r,n)},this.catchCallback=e=>{this.wrapFailure(t,e).next(r,n)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof uB?t:uB.resolve(t)}catch(e){return uB.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):uB.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):uB.reject(t)}static resolve(e){return new uB((t,r)=>{t(e)})}static reject(e){return new uB((t,r)=>{r(e)})}static waitFor(e){return new uB((t,r)=>{let n=0,i=0,s=!1;e.forEach(e=>{++n,e.next(()=>{++i,s&&i===n&&t()},e=>r(e))}),s=!0,i===n&&t()})}static or(e){let t=uB.resolve(!1);for(let r of e)t=t.next(e=>e?uB.resolve(e):r());return t}static forEach(e,t){let r=[];return e.forEach((e,n)=>{r.push(t.call(this,e,n))}),this.waitFor(r)}static mapArray(e,t){return new uB((r,n)=>{let i=e.length,s=Array(i),a=0;for(let o=0;o<i;o++){let l=o;t(e[l]).next(e=>{s[l]=e,++a===i&&r(s)},e=>n(e))}})}static doWhile(e,t){return new uB((r,n)=>{let i=()=>{!0===e()?t().next(()=>{i()},n):r()};i()})}}let uz="SimpleDb";class uq{static open(e,t,r,n){try{return new uq(t,e.transaction(n,r))}catch(e){throw new uH(t,e)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new l8,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new uH(e,t.error)):this.S.resolve()},this.transaction.onerror=t=>{let r=uX(t.target.error);this.S.reject(new uH(e,r))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(lX(uz,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){let e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){return new uQ(this.transaction.objectStore(e))}}class u${static delete(e){return lX(uz,"Removing database:",e),uJ(oc().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!oC())return!1;if(u$.F())return!0;let e=oI(),t=u$.M(e),r=uG(e);return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||0<t&&t<10||0<r&&r<4.5)}static F(){return void 0!==N.default&&"YES"===N.default.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE}static O(e,t){return e.store(t)}static M(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i);return Number(t?t[1].split("_").slice(0,2).join("."):"-1")}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,12.2===u$.M(oI())&&lZ("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(lX(uz,"Opening database:",this.name),this.db=await new Promise((t,r)=>{let n=indexedDB.open(this.name,this.version);n.onsuccess=e=>{t(e.target.result)},n.onblocked=()=>{r(new uH(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},n.onerror=t=>{let n=t.target.error;"VersionError"===n.name?r(new l4(l3.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===n.name?r(new l4(l3.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+n)):r(new uH(e,n))},n.onupgradeneeded=e=>{lX(uz,'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);let t=e.target.result;this.N.k(t,n.transaction,e.oldVersion,this.version).next(()=>{lX(uz,"Database upgrade to version "+this.version+" complete")})}})),this.K&&(this.db.onversionchange=e=>this.K(e)),this.db}q(e){this.K=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,n){let i="readonly"===t,s=0;for(;;){++s;try{this.db=await this.L(e);let t=uq.open(this.db,e,i?"readonly":"readwrite",r),s=n(t).next(e=>(t.C(),e)).catch(e=>(t.abort(e),uB.reject(e))).toPromise();return s.catch(()=>{}),await t.D,s}catch(t){let e="FirebaseError"!==t.name&&s<3;if(lX(uz,"Transaction failed with error:",t.message,"Retrying:",e),this.close(),!e)return Promise.reject(t)}}}close(){this.db&&this.db.close(),this.db=void 0}}function uG(e){let t=e.match(/Android ([\d.]+)/i);return Number(t?t[1].split(".").slice(0,2).join("."):"-1")}class uK{constructor(e){this.U=e,this.$=!1,this.W=null}get isDone(){return this.$}get G(){return this.W}set cursor(e){this.U=e}done(){this.$=!0}j(e){this.W=e}delete(){return uJ(this.U.delete())}}class uH extends l4{constructor(e,t){super(l3.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function uW(e){return"IndexedDbTransactionError"===e.name}class uQ{constructor(e){this.store=e}put(e,t){let r;return void 0!==t?(lX(uz,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(lX(uz,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),uJ(r)}add(e){return lX(uz,"ADD",this.store.name,e,e),uJ(this.store.add(e))}get(e){return uJ(this.store.get(e)).next(t=>(void 0===t&&(t=null),lX(uz,"GET",this.store.name,e,t),t))}delete(e){return lX(uz,"DELETE",this.store.name,e),uJ(this.store.delete(e))}count(){return lX(uz,"COUNT",this.store.name),uJ(this.store.count())}H(e,t){let r=this.options(e,t),n=r.index?this.store.index(r.index):this.store;if("function"==typeof n.getAll){let e=n.getAll(r.range);return new uB((t,r)=>{e.onerror=e=>{r(e.target.error)},e.onsuccess=e=>{t(e.target.result)}})}{let e=this.cursor(r),t=[];return this.J(e,(e,r)=>{t.push(r)}).next(()=>t)}}Z(e,t){let r=this.store.getAll(e,null===t?void 0:t);return new uB((e,t)=>{r.onerror=e=>{t(e.target.error)},r.onsuccess=t=>{e(t.target.result)}})}X(e,t){lX(uz,"DELETE ALL",this.store.name);let r=this.options(e,t);r.Y=!1;let n=this.cursor(r);return this.J(n,(e,t,r)=>r.delete())}ee(e,t){let r;t?r=e:(r={},t=e);let n=this.cursor(r);return this.J(n,t)}te(e){let t=this.cursor({});return new uB((r,n)=>{t.onerror=e=>{n(uX(e.target.error))},t.onsuccess=t=>{let n=t.target.result;n?e(n.primaryKey,n.value).next(e=>{e?n.continue():r()}):r()}})}J(e,t){let r=[];return new uB((n,i)=>{e.onerror=e=>{i(e.target.error)},e.onsuccess=e=>{let i=e.target.result;if(!i)return void n();let s=new uK(i),a=t(i.primaryKey,i.value,s);if(a instanceof uB){let e=a.catch(e=>(s.done(),uB.reject(e)));r.push(e)}s.isDone?n():null===s.G?i.continue():i.continue(s.G)}}).next(()=>uB.waitFor(r))}options(e,t){let r;return void 0!==e&&("string"==typeof e?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let r=this.store.index(e.index);return e.Y?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function uJ(e){return new uB((t,r)=>{e.onsuccess=e=>{t(e.target.result)},e.onerror=e=>{r(uX(e.target.error))}})}let uY=!1;function uX(e){let t=u$.M(oI());if(t>=12.2&&t<13){let t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){let e=new l4("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return uY||(uY=!0,setTimeout(()=>{throw e},0)),e}}return e}let uZ="IndexBackfiller";class u0{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}re(e){lX(uZ,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{let e=await this.ne.ie();lX(uZ,`Documents written: ${e}`)}catch(e){uW(e)?lX(uZ,"Ignoring IndexedDB error during index backfill: ",e):await uU(e)}await this.re(6e4)})}}class u1{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.se(t,e))}se(e,t){let r=new Set,n=t,i=!0;return uB.doWhile(()=>!0===i&&n>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(t=>{if(null!==t&&!r.has(t))return lX(uZ,`Processing collection: ${t}`),this.oe(e,t,n).next(e=>{n-=e,r.add(t)});i=!1})).next(()=>t-n)}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(n=>this.localStore.localDocuments.getNextDocuments(e,t,n,r).next(r=>{let i=r.changes;return this.localStore.indexManager.updateIndexEntries(e,i).next(()=>this._e(n,r)).next(r=>(lX(uZ,`Updating offset: ${r}`),this.localStore.indexManager.updateCollectionGroup(e,t,r))).next(()=>i.size)}))}_e(e,t){let r=e;return t.changes.forEach((e,t)=>{let n=uO(t);uV(n,r)>0&&(r=n)}),new uL(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class u2{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ae(e),this.ue=e=>t.writeSequenceNumber(e))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){let e=++this.previousValue;return this.ue&&this.ue(e),e}}function u5(e){return null==e}function u6(e){return 0===e&&1/e==-1/0}function u3(e){return"number"==typeof e&&Number.isInteger(e)&&!u6(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}function u4(e){let t="";for(let r=0;r<e.length;r++)t.length>0&&(t+="\x01\x01"),t=function(e,t){let r=t,n=e.length;for(let t=0;t<n;t++){let n=e.charAt(t);switch(n){case"\0":r+="\x01\x10";break;case"\x01":r+="\x01\x11";break;default:r+=n}}return r}(e.get(r),t);return t+"\x01\x01"}u2.ce=-1;function u8(e){let t=e.length;if(l6(t>=2,64408,{path:e}),2===t)return l6("\x01"===e.charAt(0)&&"\x01"===e.charAt(1),56145,{path:e}),uf.emptyPath();let r=t-2,n=[],i="";for(let s=0;s<t;){let t=e.indexOf("\x01",s);switch((t<0||t>r)&&l2(50515,{path:e}),e.charAt(t+1)){case"\x01":let a,o=e.substring(s,t);0===i.length?a=o:(i+=o,a=i,i=""),n.push(a);break;case"\x10":i+=e.substring(s,t),i+="\0";break;case"\x11":i+=e.substring(s,t+1);break;default:l2(61167,{path:e})}s=t+2}return new uf(n)}let u7="remoteDocuments",u9="owner",he="owner",ht="mutationQueues",hr="mutations",hn="batchId",hi="userMutationsIndex",hs=["userId","batchId"],ha={},ho="documentMutations",hl="remoteDocumentsV14",hu=["prefixPath","collectionGroup","readTime","documentId"],hh="documentKeyIndex",hc=["prefixPath","collectionGroup","documentId"],hd="collectionGroupIndex",hf=["collectionGroup","readTime","prefixPath","documentId"],hp="remoteDocumentGlobal",hm="remoteDocumentGlobalKey",hg="targets",hy="queryTargetsIndex",hv=["canonicalId","targetId"],hw="targetDocuments",hb=["targetId","path"],hx="documentTargetsIndex",hI=["path","targetId"],hT="targetGlobalKey",hE="targetGlobal",hS="collectionParents",h_=["collectionId","parent"],hk="clientMetadata",hC="bundles",hA="namedQueries",hD="indexConfiguration",hN="collectionGroupIndex",hP="indexState",hR=["indexId","uid"],hM="sequenceNumberIndex",hO=["uid","sequenceNumber"],hL="indexEntries",hV=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],hF="documentKeyIndex",hj=["indexId","uid","orderedDocumentKey"],hU="documentOverlays",hB=["userId","collectionPath","documentId"],hz="collectionPathOverlayIndex",hq=["userId","collectionPath","largestBatchId"],h$="collectionGroupOverlayIndex",hG=["userId","collectionGroup","largestBatchId"],hK="globals",hH=[ht,hr,ho,u7,hg,u9,hE,hw,hk,hp,hS,hC,hA],hW=[...hH,hU],hQ=[ht,hr,ho,hl,hg,u9,hE,hw,hk,hp,hS,hC,hA,hU],hJ=[...hQ,hD,hP,hL],hY=[...hJ,hK];class hX extends uj{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function hZ(e,t){return u$.O(e.le,t)}function h0(e){let t=0;for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}function h1(e,t){for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(r,e[r])}function h2(e){for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class h5{constructor(e,t){this.comparator=e,this.root=t||h3.EMPTY}insert(e,t){return new h5(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,h3.BLACK,null,null))}remove(e){return new h5(this.comparator,this.root.remove(e,this.comparator).copy(null,null,h3.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let n=this.comparator(e,r.key);if(0===n)return t+r.left.size;n<0?r=r.left:(t+=r.left.size+1,r=r.right)}return -1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new h6(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new h6(this.root,e,this.comparator,!1)}getReverseIterator(){return new h6(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new h6(this.root,e,this.comparator,!0)}}class h6{constructor(e,t,r,n){this.isReverse=n,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&n&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class h3{constructor(e,t,r,n,i){this.key=e,this.value=t,this.color=null!=r?r:h3.RED,this.left=null!=n?n:h3.EMPTY,this.right=null!=i?i:h3.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,n,i){return new h3(null!=e?e:this.key,null!=t?t:this.value,null!=r?r:this.color,null!=n?n:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let n=this,i=r(e,n.key);return(n=i<0?n.copy(null,null,null,n.left.insert(e,t,r),null):0===i?n.copy(null,t,null,null,null):n.copy(null,null,null,null,n.right.insert(e,t,r))).fixUp()}removeMin(){if(this.left.isEmpty())return h3.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()}remove(e,t){let r,n=this;if(0>t(e,n.key))n.left.isEmpty()||n.left.isRed()||n.left.left.isRed()||(n=n.moveRedLeft()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed()&&(n=n.rotateRight()),n.right.isEmpty()||n.right.isRed()||n.right.left.isRed()||(n=n.moveRedRight()),0===t(e,n.key)){if(n.right.isEmpty())return h3.EMPTY;r=n.right.min(),n=n.copy(r.key,r.value,null,null,n.right.removeMin())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}rotateLeft(){let e=this.copy(null,null,h3.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,h3.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){return Math.pow(2,this.check())<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw l2(43730,{key:this.key,value:this.value});if(this.right.isRed())throw l2(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw l2(27949);return e+ +!this.isRed()}}h3.EMPTY=null,h3.RED=!0,h3.BLACK=!1,h3.EMPTY=new class{constructor(){this.size=0}get key(){throw l2(57766)}get value(){throw l2(16141)}get color(){throw l2(16727)}get left(){throw l2(29726)}get right(){throw l2(36894)}copy(e,t,r,n,i){return this}insert(e,t,r){return new h3(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class h4{constructor(e){this.comparator=e,this.data=new h5(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let n=r.getNext();if(this.comparator(n.key,e[1])>=0)return;t(n.key)}}forEachWhile(e,t){let r;for(r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new h8(this.data.getIterator())}getIteratorFrom(e){return new h8(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof h4)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let e=t.getNext().key,n=r.getNext().key;if(0!==this.comparator(e,n))return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new h4(this.comparator);return t.data=e,t}}class h8{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function h7(e){return e.hasNext()?e.getNext():void 0}class h9{constructor(e){this.fields=e,e.sort(um.comparator)}static empty(){return new h9([])}unionWith(e){let t=new h4(um.comparator);for(let e of this.fields)t=t.add(e);for(let r of e)t=t.add(r);return new h9(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return uh(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class ce extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class ct{constructor(e){this.binaryString=e}static fromBase64String(e){return new ct(function(e){try{return atob(e)}catch(e){throw"u">typeof DOMException&&e instanceof DOMException?new ce("Invalid base64 string: "+e):e}}(e))}static fromUint8Array(e){return new ct(function(e){let t="";for(let r=0;r<e.length;++r)t+=String.fromCharCode(e[r]);return t}(e))}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){var e=this.binaryString;let t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return uo(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ct.EMPTY_BYTE_STRING=new ct("");let cr=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function cn(e){if(l6(!!e,39018),"string"==typeof e){let t=0,r=cr.exec(e);if(l6(!!r,46558,{timestamp:e}),r[1]){let e=r[1];t=Number(e=(e+"000000000").substr(0,9))}return{seconds:Math.floor(new Date(e).getTime()/1e3),nanos:t}}return{seconds:ci(e.seconds),nanos:ci(e.nanos)}}function ci(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function cs(e){return"string"==typeof e?ct.fromBase64String(e):ct.fromUint8Array(e)}let ca="server_timestamp",co="__type__",cl="__previous_value__",cu="__local_write_time__";function ch(e){return(e?.mapValue?.fields||{})[co]?.stringValue===ca}function cc(e){let t=e.mapValue.fields[cl];return ch(t)?cc(t):t}function cd(e){let t=cn(e.mapValue.fields[cu].timestampValue);return new u_(t.seconds,t.nanos)}class cf{constructor(e,t,r,n,i,s,a,o,l,u,h){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=n,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=o,this.useFetchStreams=l,this.isUsingEmulator=u,this.apiKey=h}}let cp="(default)";class cm{constructor(e,t){this.projectId=e,this.database=t||cp}static empty(){return new cm("","")}get isDefaultDatabase(){return this.database===cp}isEqual(e){return e instanceof cm&&e.projectId===this.projectId&&e.database===this.database}}let cg="__type__",cy="__max__",cv={mapValue:{fields:{__type__:{stringValue:cy}}}},cw="__vector__",cb="value",cx={nullValue:"NULL_VALUE"};function cI(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?ch(e)?4:cV(e)?0x1fffffffffffff:cO(e)?10:11:l2(28295,{value:e})}function cT(e,t){if(e===t)return!0;let r=cI(e);if(r!==cI(t))return!1;switch(r){case 0:case 0x1fffffffffffff:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return cd(e).isEqual(cd(t));case 3:if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;let n=cn(e.timestampValue),i=cn(t.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos;case 5:return e.stringValue===t.stringValue;case 6:return cs(e.bytesValue).isEqual(cs(t.bytesValue));case 7:return e.referenceValue===t.referenceValue;case 8:return ci(e.geoPointValue.latitude)===ci(t.geoPointValue.latitude)&&ci(e.geoPointValue.longitude)===ci(t.geoPointValue.longitude);case 2:if("integerValue"in e&&"integerValue"in t)return ci(e.integerValue)===ci(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){let r=ci(e.doubleValue),n=ci(t.doubleValue);return r===n?u6(r)===u6(n):isNaN(r)&&isNaN(n)}return!1;case 9:return uh(e.arrayValue.values||[],t.arrayValue.values||[],cT);case 10:case 11:let s=e.mapValue.fields||{},a=t.mapValue.fields||{};if(h0(s)!==h0(a))return!1;for(let e in s)if(s.hasOwnProperty(e)&&(void 0===a[e]||!cT(s[e],a[e])))return!1;return!0;default:return l2(52216,{left:e})}}function cE(e,t){return void 0!==(e.values||[]).find(e=>cT(e,t))}function cS(e,t){var r,n,i,s,a,o;if(e===t)return 0;let l=cI(e),u=cI(t);if(l!==u)return uo(l,u);switch(l){case 0:case 0x1fffffffffffff:return 0;case 1:return uo(e.booleanValue,t.booleanValue);case 2:let h,c;return h=ci(e.integerValue||e.doubleValue),h<(c=ci(t.integerValue||t.doubleValue))?-1:h>c?1:h===c?0:isNaN(h)?isNaN(c)?0:-1:1;case 3:return c_(e.timestampValue,t.timestampValue);case 4:return c_(cd(e),cd(t));case 5:return ul(e.stringValue,t.stringValue);case 6:let d,f;return r=e.bytesValue,n=t.bytesValue,d=cs(r),f=cs(n),d.compareTo(f);case 7:return function(e,t){let r=e.split("/"),n=t.split("/");for(let e=0;e<r.length&&e<n.length;e++){let t=uo(r[e],n[e]);if(0!==t)return t}return uo(r.length,n.length)}(e.referenceValue,t.referenceValue);case 8:let p;return i=e.geoPointValue,s=t.geoPointValue,0!==(p=uo(ci(i.latitude),ci(s.latitude)))?p:uo(ci(i.longitude),ci(s.longitude));case 9:return ck(e.arrayValue,t.arrayValue);case 10:let m,g,y,v,w;return a=e.mapValue,o=t.mapValue,m=a.fields||{},g=o.fields||{},y=m[cb]?.arrayValue,v=g[cb]?.arrayValue,0!==(w=uo(y?.values?.length||0,v?.values?.length||0))?w:ck(y,v);case 11:return function(e,t){if(e===cv.mapValue&&t===cv.mapValue)return 0;if(e===cv.mapValue)return 1;if(t===cv.mapValue)return -1;let r=e.fields||{},n=Object.keys(r),i=t.fields||{},s=Object.keys(i);n.sort(),s.sort();for(let e=0;e<n.length&&e<s.length;++e){let t=ul(n[e],s[e]);if(0!==t)return t;let a=cS(r[n[e]],i[s[e]]);if(0!==a)return a}return uo(n.length,s.length)}(e.mapValue,t.mapValue);default:throw l2(23264,{he:l})}}function c_(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return uo(e,t);let r=cn(e),n=cn(t),i=uo(r.seconds,n.seconds);return 0!==i?i:uo(r.nanos,n.nanos)}function ck(e,t){let r=e.values||[],n=t.values||[];for(let e=0;e<r.length&&e<n.length;++e){let t=cS(r[e],n[e]);if(t)return t}return uo(r.length,n.length)}function cC(e){var t,r;let n;return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?(n=cn(e.timestampValue),`time(${n.seconds},${n.nanos})`):"stringValue"in e?e.stringValue:"bytesValue"in e?cs(e.bytesValue).toBase64():"referenceValue"in e?(t=e.referenceValue,ug.fromName(t).toString()):"geoPointValue"in e?(r=e.geoPointValue,`geo(${r.latitude},${r.longitude})`):"arrayValue"in e?function(e){let t="[",r=!0;for(let n of e.values||[])r?r=!1:t+=",",t+=cC(n);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){let t=Object.keys(e.fields||{}).sort(),r="{",n=!0;for(let i of t)n?n=!1:r+=",",r+=`${i}:${cC(e.fields[i])}`;return r+"}"}(e.mapValue):l2(61005,{value:e})}function cA(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function cD(e){return!!e&&"integerValue"in e}function cN(e){return!!e&&"arrayValue"in e}function cP(e){return!!e&&"nullValue"in e}function cR(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function cM(e){return!!e&&"mapValue"in e}function cO(e){return(e?.mapValue?.fields||{})[cg]?.stringValue===cw}function cL(e){if(e.geoPointValue)return{geoPointValue:{...e.geoPointValue}};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:{...e.timestampValue}};if(e.mapValue){let t={mapValue:{fields:{}}};return h1(e.mapValue.fields,(e,r)=>t.mapValue.fields[e]=cL(r)),t}if(e.arrayValue){let t={arrayValue:{values:[]}};for(let r=0;r<(e.arrayValue.values||[]).length;++r)t.arrayValue.values[r]=cL(e.arrayValue.values[r]);return t}return{...e}}function cV(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===cy}let cF={mapValue:{fields:{[cg]:{stringValue:cw},[cb]:{arrayValue:{}}}}};function cj(e,t){let r=cS(e.value,t.value);return 0!==r?r:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function cU(e,t){let r=cS(e.value,t.value);return 0!==r?r:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}class cB{constructor(e){this.value=e}static empty(){return new cB({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(!cM(t=(t.mapValue.fields||{})[e.get(r)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=cL(t)}setAll(e){let t=um.emptyPath(),r={},n=[];e.forEach((e,i)=>{if(!t.isImmediateParentOf(i)){let e=this.getFieldsMap(t);this.applyChanges(e,r,n),r={},n=[],t=i.popLast()}e?r[i.lastSegment()]=cL(e):n.push(i.lastSegment())});let i=this.getFieldsMap(t);this.applyChanges(i,r,n)}delete(e){let t=this.field(e.popLast());cM(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return cT(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let n=t.mapValue.fields[e.get(r)];cM(n)&&n.mapValue.fields||(n={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=n),t=n}return t.mapValue.fields}applyChanges(e,t,r){for(let n of(h1(t,(t,r)=>e[t]=r),r))delete e[n]}clone(){return new cB(cL(this.value))}}class cz{constructor(e,t,r,n,i,s,a){this.key=e,this.documentType=t,this.version=r,this.readTime=n,this.createTime=i,this.data=s,this.documentState=a}static newInvalidDocument(e){return new cz(e,0,uk.min(),uk.min(),uk.min(),cB.empty(),0)}static newFoundDocument(e,t,r,n){return new cz(e,1,t,uk.min(),r,n,0)}static newNoDocument(e,t){return new cz(e,2,t,uk.min(),uk.min(),cB.empty(),0)}static newUnknownDocument(e,t){return new cz(e,3,t,uk.min(),uk.min(),cB.empty(),2)}convertToFoundDocument(e,t){return this.createTime.isEqual(uk.min())&&(2===this.documentType||0===this.documentType)&&(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=cB.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=cB.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=uk.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof cz&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new cz(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class cq{constructor(e,t){this.position=e,this.inclusive=t}}function c$(e,t,r){let n=0;for(let i=0;i<e.position.length;i++){let s=t[i],a=e.position[i];if(n=s.field.isKeyField()?ug.comparator(ug.fromName(a.referenceValue),r.key):cS(a,r.data.field(s.field)),"desc"===s.dir&&(n*=-1),0!==n)break}return n}function cG(e,t){if(null===e)return null===t;if(null===t||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let r=0;r<e.position.length;r++)if(!cT(e.position[r],t.position[r]))return!1;return!0}class cK{constructor(e,t="asc"){this.field=e,this.dir=t}}class cH{}class cW extends cH{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,r):new c1(e,t,r):"array-contains"===t?new c3(e,r):"in"===t?new c4(e,r):"not-in"===t?new c8(e,r):"array-contains-any"===t?new c7(e,r):new cW(e,t,r)}static createKeyFieldInFilter(e,t,r){return"in"===t?new c2(e,r):new c5(e,r)}matches(e){let t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(cS(t,this.value)):null!==t&&cI(this.value)===cI(t)&&this.matchesComparison(cS(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return l2(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class cQ extends cH{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new cQ(e,t)}matches(e){return cJ(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.Pe||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function cJ(e){return"and"===e.op}function cY(e){return"or"===e.op}function cX(e){return cZ(e)&&cJ(e)}function cZ(e){for(let t of e.filters)if(t instanceof cQ)return!1;return!0}function c0(e,t){let r=e.filters.concat(t);return cQ.create(r,e.op)}class c1 extends cW{constructor(e,t,r){super(e,t,r),this.key=ug.fromName(r.referenceValue)}matches(e){let t=ug.comparator(e.key,this.key);return this.matchesComparison(t)}}class c2 extends cW{constructor(e,t){super(e,"in",t),this.keys=c6("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class c5 extends cW{constructor(e,t){super(e,"not-in",t),this.keys=c6("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function c6(e,t){return(t.arrayValue?.values||[]).map(e=>ug.fromName(e.referenceValue))}class c3 extends cW{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return cN(t)&&cE(t.arrayValue,this.value)}}class c4 extends cW{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return null!==t&&cE(this.value.arrayValue,t)}}class c8 extends cW{constructor(e,t){super(e,"not-in",t)}matches(e){if(cE(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!cE(this.value.arrayValue,t)}}class c7 extends cW{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!cN(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>cE(this.value.arrayValue,e))}}class c9{constructor(e,t=null,r=[],n=[],i=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=n,this.limit=i,this.startAt=s,this.endAt=a,this.Te=null}}function de(e,t=null,r=[],n=[],i=null,s=null,a=null){return new c9(e,t,r,n,i,s,a)}function dt(e){if(null===e.Te){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(e=>(function e(t){if(t instanceof cW)return t.field.canonicalString()+t.op.toString()+cC(t.value);if(cX(t))return t.filters.map(t=>e(t)).join(",");{let r=t.filters.map(t=>e(t)).join(",");return`${t.op}(${r})`}})(e)).join(","),t+="|ob:",t+=e.orderBy.map(e=>e.field.canonicalString()+e.dir).join(","),u5(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>cC(e)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>cC(e)).join(",")),e.Te=t}return e.Te}function dr(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let i=0;i<e.orderBy.length;i++){var r,n;if(r=e.orderBy[i],n=t.orderBy[i],!(r.dir===n.dir&&r.field.isEqual(n.field)))return!1}if(e.filters.length!==t.filters.length)return!1;for(let r=0;r<e.filters.length;r++)if(!function e(t,r){return t instanceof cW?r instanceof cW&&t.op===r.op&&t.field.isEqual(r.field)&&cT(t.value,r.value):t instanceof cQ?r instanceof cQ&&t.op===r.op&&t.filters.length===r.filters.length&&t.filters.reduce((t,n,i)=>t&&e(n,r.filters[i]),!0):void l2(19439)}(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!cG(e.startAt,t.startAt)&&cG(e.endAt,t.endAt)}function dn(e){return ug.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function di(e,t){return e.filters.filter(e=>e instanceof cW&&e.field.isEqual(t))}function ds(e,t,r){let n=cx,i=!0;for(let r of di(e,t)){let e=cx,t=!0;switch(r.op){case"<":case"<=":var s;e="nullValue"in(s=r.value)?cx:"booleanValue"in s?{booleanValue:!1}:"integerValue"in s||"doubleValue"in s?{doubleValue:NaN}:"timestampValue"in s?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in s?{stringValue:""}:"bytesValue"in s?{bytesValue:""}:"referenceValue"in s?cA(cm.empty(),ug.empty()):"geoPointValue"in s?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in s?{arrayValue:{}}:"mapValue"in s?cO(s)?cF:{mapValue:{}}:l2(35942,{value:s});break;case"==":case"in":case">=":e=r.value;break;case">":e=r.value,t=!1;break;case"!=":case"not-in":e=cx}0>cj({value:n,inclusive:i},{value:e,inclusive:t})&&(n=e,i=t)}if(null!==r){for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){let e=r.position[s];0>cj({value:n,inclusive:i},{value:e,inclusive:r.inclusive})&&(n=e,i=r.inclusive);break}}return{value:n,inclusive:i}}function da(e,t,r){let n=cv,i=!0;for(let r of di(e,t)){let e=cv,t=!0;switch(r.op){case">=":case">":var s;e="nullValue"in(s=r.value)?{booleanValue:!1}:"booleanValue"in s?{doubleValue:NaN}:"integerValue"in s||"doubleValue"in s?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in s?{stringValue:""}:"stringValue"in s?{bytesValue:""}:"bytesValue"in s?cA(cm.empty(),ug.empty()):"referenceValue"in s?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in s?{arrayValue:{}}:"arrayValue"in s?cF:"mapValue"in s?cO(s)?{mapValue:{}}:cv:l2(61959,{value:s}),t=!1;break;case"==":case"in":case"<=":e=r.value;break;case"<":e=r.value,t=!1;break;case"!=":case"not-in":e=cv}cU({value:n,inclusive:i},{value:e,inclusive:t})>0&&(n=e,i=t)}if(null!==r){for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){let e=r.position[s];cU({value:n,inclusive:i},{value:e,inclusive:r.inclusive})>0&&(n=e,i=r.inclusive);break}}return{value:n,inclusive:i}}class dl{constructor(e,t=null,r=[],n=[],i=null,s="F",a=null,o=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=n,this.limit=i,this.limitType=s,this.startAt=a,this.endAt=o,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function du(e){return new dl(e)}function dh(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function dc(e){return null!==e.collectionGroup}function dd(e){if(null===e.Ie){let t;e.Ie=[];let r=new Set;for(let t of e.explicitOrderBy)e.Ie.push(t),r.add(t.field.canonicalString());let n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(t=new h4(um.comparator),e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t).forEach(t=>{r.has(t.canonicalString())||t.isKeyField()||e.Ie.push(new cK(t,n))}),r.has(um.keyField().canonicalString())||e.Ie.push(new cK(um.keyField(),n))}return e.Ie}function df(e){return e.Ee||(e.Ee=dp(e,dd(e))),e.Ee}function dp(e,t){if("F"===e.limitType)return de(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{let t="desc"===e.dir?"asc":"desc";return new cK(e.field,t)});let r=e.endAt?new cq(e.endAt.position,e.endAt.inclusive):null,n=e.startAt?new cq(e.startAt.position,e.startAt.inclusive):null;return de(e.path,e.collectionGroup,t,e.filters,e.limit,r,n)}}function dm(e,t){let r=e.filters.concat([t]);return new dl(e.path,e.collectionGroup,e.explicitOrderBy.slice(),r,e.limit,e.limitType,e.startAt,e.endAt)}function dg(e,t,r){return new dl(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,r,e.startAt,e.endAt)}function dy(e,t){return dr(df(e),df(t))&&e.limitType===t.limitType}function dv(e){return`${dt(df(e))}|lt:${e.limitType}`}function dw(e){var t;let r;return`Query(target=${r=(t=df(e)).path.canonicalString(),null!==t.collectionGroup&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(e=>(function e(t){return t instanceof cW?`${t.field.canonicalString()} ${t.op} ${cC(t.value)}`:t instanceof cQ?t.op.toString()+" {"+t.getFilters().map(e).join(" ,")+"}":"Filter"})(e)).join(", ")}]`),u5(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(e=>`${e.field.canonicalString()} (${e.dir})`).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(e=>cC(e)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(e=>cC(e)).join(",")),`Target(${r})`}; limitType=${e.limitType})`}function db(e,t){var r,n,i,s;let a,o,l;return t.isFoundDocument()&&(a=t.key.path,null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(a):ug.isDocumentKey(e.path)?e.path.isEqual(a):e.path.isImmediateParentOf(a))&&function(e,t){for(let r of dd(e))if(!r.field.isKeyField()&&null===t.data.field(r.field))return!1;return!0}(e,t)&&function(e,t){for(let r of e.filters)if(!r.matches(t))return!1;return!0}(e,t)&&(r=e,n=t,(!r.startAt||(i=r.startAt,o=c$(i,dd(r),n),i.inclusive?!!(o<=0):!!(o<0)))&&(!r.endAt||(s=r.endAt,l=c$(s,dd(r),n),s.inclusive?!!(l>=0):!!(l>0))))}function dx(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function dI(e){return(t,r)=>{let n=!1;for(let i of dd(e)){let e=function(e,t,r){var n;let i,s,a=e.field.isKeyField()?ug.comparator(t.key,r.key):(n=e.field,i=t.data.field(n),s=r.data.field(n),null!==i&&null!==s?cS(i,s):l2(42886));switch(e.dir){case"asc":return a;case"desc":return -1*a;default:return l2(19790,{direction:e.dir})}}(i,t,r);if(0!==e)return e;n=n||i.field.isKeyField()}return 0}}class dT{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r){for(let[t,n]of r)if(this.equalsFn(t,e))return n}}has(e){return void 0!==this.get(e)}set(e,t){let r=this.mapKeyFn(e),n=this.inner[r];if(void 0===n)return this.inner[r]=[[e,t]],void this.innerSize++;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return void(n[r]=[e,t]);n.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(void 0===r)return!1;for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],e))return 1===r.length?delete this.inner[t]:r.splice(n,1),this.innerSize--,!0;return!1}forEach(e){h1(this.inner,(t,r)=>{for(let[t,n]of r)e(t,n)})}isEmpty(){return h2(this.inner)}size(){return this.innerSize}}let dE=new h5(ug.comparator),dS=new h5(ug.comparator);function d_(...e){let t=dS;for(let r of e)t=t.insert(r.key,r);return t}function dk(e){let t=dS;return e.forEach((e,r)=>t=t.insert(e,r.overlayedDocument)),t}function dC(){return new dT(e=>e.toString(),(e,t)=>e.isEqual(t))}let dA=new h5(ug.comparator),dD=new h4(ug.comparator);function dN(...e){let t=dD;for(let r of e)t=t.add(r);return t}let dP=new h4(uo);function dR(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:u6(t)?"-0":t}}function dM(e){return{integerValue:""+e}}function dO(e,t){return u3(t)?dM(t):dR(e,t)}class dL{constructor(){this._=void 0}}function dV(e,t){return e instanceof dq?cD(t)||t&&"doubleValue"in t?t:{integerValue:0}:null}class dF extends dL{}class dj extends dL{constructor(e){super(),this.elements=e}}function dU(e,t){let r=dG(t);for(let t of e.elements)r.some(e=>cT(e,t))||r.push(t);return{arrayValue:{values:r}}}class dB extends dL{constructor(e){super(),this.elements=e}}function dz(e,t){let r=dG(t);for(let t of e.elements)r=r.filter(e=>!cT(e,t));return{arrayValue:{values:r}}}class dq extends dL{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function d$(e){return ci(e.integerValue||e.doubleValue)}function dG(e){return cN(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class dK{constructor(e,t){this.field=e,this.transform=t}}class dH{constructor(e,t){this.version=e,this.transformResults=t}}class dW{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new dW}static exists(e){return new dW(void 0,e)}static updateTime(e){return new dW(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function dQ(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class dJ{}function dY(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new d3(e.key,dW.none()):new d0(e.key,e.data,dW.none());{let r=e.data,n=cB.empty(),i=new h4(um.comparator);for(let e of t.fields)if(!i.has(e)){let t=r.field(e);null===t&&e.length>1&&(e=e.popLast(),t=r.field(e)),null===t?n.delete(e):n.set(e,t),i=i.add(e)}return new d1(e.key,n,new h9(i.toArray()),dW.none())}}function dX(e,t,r,n){return e instanceof d0?function(e,t,r,n){if(!dQ(e.precondition,t))return r;let i=e.value.clone(),s=d6(e.fieldTransforms,n,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,r,n):e instanceof d1?function(e,t,r,n){if(!dQ(e.precondition,t))return r;let i=d6(e.fieldTransforms,n,t),s=t.data;return(s.setAll(d2(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===r)?null:r.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,r,n):dQ(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):r}function dZ(e,t){var r,n;return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(r=e.fieldTransforms,n=t.fieldTransforms,!!(void 0===r&&void 0===n||!(!r||!n)&&uh(r,n,(e,t)=>{var r,n;return e.field.isEqual(t.field)&&(r=e.transform,n=t.transform,r instanceof dj&&n instanceof dj||r instanceof dB&&n instanceof dB?uh(r.elements,n.elements,cT):r instanceof dq&&n instanceof dq?cT(r.Ae,n.Ae):r instanceof dF&&n instanceof dF)})))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class d0 extends dJ{constructor(e,t,r,n=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=n,this.type=0}getFieldMask(){return null}}class d1 extends dJ{constructor(e,t,r,n,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=n,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function d2(e){let t=new Map;return e.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){let n=e.data.field(r);t.set(r,n)}}),t}function d5(e,t,r){let n=new Map;l6(e.length===r.length,32656,{Ve:r.length,de:e.length});for(let s=0;s<r.length;s++){var i;let a=e[s],o=a.transform,l=t.data.field(a.field);n.set(a.field,(i=r[s],o instanceof dj?dU(o,l):o instanceof dB?dz(o,l):i))}return n}function d6(e,t,r){let n=new Map;for(let i of e){let e=i.transform,s=r.data.field(i.field);n.set(i.field,function(e,t,r){var n;let i,s,a;return e instanceof dF?(n=t,i={fields:{[co]:{stringValue:ca},[cu]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}},n&&ch(n)&&(n=cc(n)),n&&(i.fields[cl]=n),{mapValue:i}):e instanceof dj?dU(e,t):e instanceof dB?dz(e,t):(a=d$(s=dV(e,t))+d$(e.Ae),cD(s)&&cD(e.Ae)?dM(a):dR(e.serializer,a))}(e,s,t))}return n}class d3 extends dJ{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class d4 extends dJ{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class d8{constructor(e,t,r,n){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=n}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let t=0;t<this.mutations.length;t++){let n=this.mutations[t];n.key.isEqual(e.key)&&function(e,t,r){let n,i;e instanceof d0?(n=e.value.clone(),i=d5(e.fieldTransforms,t,r.transformResults),n.setAll(i),t.convertToFoundDocument(r.version,n).setHasCommittedMutations()):e instanceof d1?function(e,t,r){if(!dQ(e.precondition,t))return t.convertToUnknownDocument(r.version);let n=d5(e.fieldTransforms,t,r.transformResults),i=t.data;i.setAll(d2(e)),i.setAll(n),t.convertToFoundDocument(r.version,i).setHasCommittedMutations()}(e,t,r):t.convertToNoDocument(r.version).setHasCommittedMutations()}(n,e,r[t])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=dX(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=dX(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=dC();return this.mutations.forEach(n=>{let i=e.get(n.key),s=i.overlayedDocument,a=this.applyToLocalView(s,i.mutatedFields),o=dY(s,a=t.has(n.key)?null:a);null!==o&&r.set(n.key,o),s.isValidDocument()||s.convertToNoDocument(uk.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),dN())}isEqual(e){return this.batchId===e.batchId&&uh(this.mutations,e.mutations,(e,t)=>dZ(e,t))&&uh(this.baseMutations,e.baseMutations,(e,t)=>dZ(e,t))}}class d7{constructor(e,t,r,n){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=n}static from(e,t,r){l6(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let n=dA,i=e.mutations;for(let e=0;e<i.length;e++)n=n.insert(i[e].key,r[e].version);return new d7(e,t,r,n)}}class d9{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class fe{constructor(e,t,r){this.alias=e,this.aggregateType=t,this.fieldPath=r}}class ft{constructor(e,t){this.count=e,this.unchangedNames=t}}function fr(e){switch(e){case l3.OK:return l2(64938);case l3.CANCELLED:case l3.UNKNOWN:case l3.DEADLINE_EXCEEDED:case l3.RESOURCE_EXHAUSTED:case l3.INTERNAL:case l3.UNAVAILABLE:case l3.UNAUTHENTICATED:return!1;case l3.INVALID_ARGUMENT:case l3.NOT_FOUND:case l3.ALREADY_EXISTS:case l3.PERMISSION_DENIED:case l3.FAILED_PRECONDITION:case l3.ABORTED:case l3.OUT_OF_RANGE:case l3.UNIMPLEMENTED:case l3.DATA_LOSS:return!0;default:return l2(15467,{code:e})}}function fn(e){if(void 0===e)return lZ("GRPC error has no .code"),l3.UNKNOWN;switch(e){case S.OK:return l3.OK;case S.CANCELLED:return l3.CANCELLED;case S.UNKNOWN:return l3.UNKNOWN;case S.DEADLINE_EXCEEDED:return l3.DEADLINE_EXCEEDED;case S.RESOURCE_EXHAUSTED:return l3.RESOURCE_EXHAUSTED;case S.INTERNAL:return l3.INTERNAL;case S.UNAVAILABLE:return l3.UNAVAILABLE;case S.UNAUTHENTICATED:return l3.UNAUTHENTICATED;case S.INVALID_ARGUMENT:return l3.INVALID_ARGUMENT;case S.NOT_FOUND:return l3.NOT_FOUND;case S.ALREADY_EXISTS:return l3.ALREADY_EXISTS;case S.PERMISSION_DENIED:return l3.PERMISSION_DENIED;case S.FAILED_PRECONDITION:return l3.FAILED_PRECONDITION;case S.ABORTED:return l3.ABORTED;case S.OUT_OF_RANGE:return l3.OUT_OF_RANGE;case S.UNIMPLEMENTED:return l3.UNIMPLEMENTED;case S.DATA_LOSS:return l3.DATA_LOSS;default:return l2(39323,{code:e})}}(_=S||(S={}))[_.OK=0]="OK",_[_.CANCELLED=1]="CANCELLED",_[_.UNKNOWN=2]="UNKNOWN",_[_.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",_[_.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",_[_.NOT_FOUND=5]="NOT_FOUND",_[_.ALREADY_EXISTS=6]="ALREADY_EXISTS",_[_.PERMISSION_DENIED=7]="PERMISSION_DENIED",_[_.UNAUTHENTICATED=16]="UNAUTHENTICATED",_[_.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",_[_.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",_[_.ABORTED=10]="ABORTED",_[_.OUT_OF_RANGE=11]="OUT_OF_RANGE",_[_.UNIMPLEMENTED=12]="UNIMPLEMENTED",_[_.INTERNAL=13]="INTERNAL",_[_.UNAVAILABLE=14]="UNAVAILABLE",_[_.DATA_LOSS=15]="DATA_LOSS";let fi=null;function fs(){return new TextEncoder}let fa=new m([0xffffffff,0xffffffff],0);function fo(e){let t=fs().encode(e),r=new g;return r.update(t),new Uint8Array(r.digest())}function fl(e){let t=new DataView(e.buffer),r=t.getUint32(0,!0),n=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new m([r,n],0),new m([i,s],0)]}class fu{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new fh(`Invalid padding: ${t}`);if(r<0||e.length>0&&0===this.hashCount)throw new fh(`Invalid hash count: ${r}`);if(0===e.length&&0!==t)throw new fh(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=m.fromNumber(this.ge)}ye(e,t,r){let n=e.add(t.multiply(m.fromNumber(r)));return 1===n.compare(fa)&&(n=new m([n.getBits(0),n.getBits(1)],0)),n.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.ge)return!1;let[t,r]=fl(fo(e));for(let e=0;e<this.hashCount;e++){let n=this.ye(t,r,e);if(!this.we(n))return!1}return!0}static create(e,t,r){let n=new fu(new Uint8Array(Math.ceil(e/8)),e%8==0?0:8-e%8,t);return r.forEach(e=>n.insert(e)),n}insert(e){if(0===this.ge)return;let[t,r]=fl(fo(e));for(let e=0;e<this.hashCount;e++){let n=this.ye(t,r,e);this.be(n)}}be(e){let t=Math.floor(e/8);this.bitmap[t]|=1<<e%8}}class fh extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class fc{constructor(e,t,r,n,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=n,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let n=new Map;return n.set(e,fd.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new fc(uk.min(),n,new h5(uo),dE,dN())}}class fd{constructor(e,t,r,n,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=n,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new fd(r,t,dN(),dN(),dN())}}class ff{constructor(e,t,r,n){this.Se=e,this.removedTargetIds=t,this.key=r,this.De=n}}class fp{constructor(e,t){this.targetId=e,this.Ce=t}}class fm{constructor(e,t,r=ct.EMPTY_BYTE_STRING,n=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=n}}class fg{constructor(){this.ve=0,this.Fe=fw(),this.Me=ct.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return 0!==this.ve}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=dN(),t=dN(),r=dN();return this.Fe.forEach((n,i)=>{switch(i){case 0:e=e.add(n);break;case 2:t=t.add(n);break;case 1:r=r.add(n);break;default:l2(38017,{changeType:i})}}),new fd(this.Me,this.xe,e,t,r)}Ke(){this.Oe=!1,this.Fe=fw()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,l6(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class fy{constructor(e){this.Ge=e,this.ze=new Map,this.je=dE,this.He=fv(),this.Je=fv(),this.Ze=new h5(uo)}Xe(e){for(let t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(let t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{let r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.We(),r.Ne||r.Ke(),r.Le(e.resumeToken);break;case 2:r.We(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.Qe(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:l2(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((e,r)=>{this.rt(r)&&t(r)})}st(e){let t=e.targetId,r=e.Ce.count,n=this.ot(t);if(n){let a=n.target;if(dn(a))if(0===r){let e=new ug(a.path);this.et(t,e,cz.newNoDocument(e,uk.min()))}else l6(1===r,20013,{expectedCount:r});else{let n=this._t(t);if(n!==r){var i,s;let r,a,o=this.ut(e),l=o?this.ct(o,e,n):1;0!==l&&(this.it(t),this.Ze=this.Ze.insert(t,2===l?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch")),fi?.lt((i=e.Ce,s=this.Ge.ht(),r={localCacheCount:n,existenceFilterCount:i.count,databaseId:s.database,projectId:s.projectId},(a=i.unchangedNames)&&(r.bloomFilter={applied:0===l,hashCount:a?.hashCount??0,bitmapLength:a?.bits?.bitmap?.length??0,padding:a?.bits?.padding??0,mightContain:e=>o?.mightContain(e)??!1}),r))}}}}ut(e){let t,r,n=e.Ce.unchangedNames;if(!n||!n.bits)return null;let{bits:{bitmap:i="",padding:s=0},hashCount:a=0}=n;try{t=cs(i).toUint8Array()}catch(e){if(e instanceof ce)return l0("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{r=new fu(t,s,a)}catch(e){return l0(e instanceof fh?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===r.ge?null:r}ct(e,t,r){return 2*(t.Ce.count!==r-this.Pt(e,t.targetId))}Pt(e,t){let r=this.Ge.getRemoteKeysForTarget(t),n=0;return r.forEach(r=>{let i=this.Ge.ht(),s=`projects/${i.projectId}/databases/${i.database}/documents/${r.path.canonicalString()}`;e.mightContain(s)||(this.et(t,r,null),n++)}),n}Tt(e){let t=new Map;this.ze.forEach((r,n)=>{let i=this.ot(n);if(i){if(r.current&&dn(i.target)){let t=new ug(i.target.path);this.It(t).has(n)||this.Et(n,t)||this.et(n,t,cz.newNoDocument(t,e))}r.Be&&(t.set(n,r.ke()),r.Ke())}});let r=dN();this.Je.forEach((e,t)=>{let n=!0;t.forEachWhile(e=>{let t=this.ot(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(n=!1,!1)}),n&&(r=r.add(e))}),this.je.forEach((t,r)=>r.setReadTime(e));let n=new fc(e,t,this.Ze,this.je,r);return this.je=dE,this.He=fv(),this.Je=fv(),this.Ze=new h5(uo),n}Ye(e,t){if(!this.rt(e))return;let r=2*!!this.Et(e,t.key);this.nt(e).qe(t.key,r),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;let n=this.nt(e);this.Et(e,t)?n.qe(t,1):n.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){let t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new fg,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new h4(uo),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new h4(uo),this.He=this.He.insert(e,t)),t}rt(e){let t=null!==this.ot(e);return t||lX("WatchChangeAggregator","Detected inactive target",e),t}ot(e){let t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new fg),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function fv(){return new h5(ug.comparator)}function fw(){return new h5(ug.comparator)}let fb={asc:"ASCENDING",desc:"DESCENDING"},fx={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},fI={and:"AND",or:"OR"};class fT{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function fE(e,t){return e.useProto3Json||u5(t)?t:{value:t}}function fS(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function f_(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function fk(e){let t;return l6(!!e,49232),uk.fromTimestamp(new u_((t=cn(e)).seconds,t.nanos))}function fC(e,t){return fA(e,t).canonicalString()}function fA(e,t){let r=new uf(["projects",e.projectId,"databases",e.database]).child("documents");return void 0===t?r:r.child(t)}function fD(e){let t=uf.fromString(e);return l6(fK(t),10190,{key:t.toString()}),t}function fN(e,t){return fC(e.databaseId,t.path)}function fP(e,t){let r=fD(t);if(r.get(1)!==e.databaseId.projectId)throw new l4(l3.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+e.databaseId.projectId);if(r.get(3)!==e.databaseId.database)throw new l4(l3.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+e.databaseId.database);return new ug(fL(r))}function fR(e,t){return fC(e.databaseId,t)}function fM(e){let t=fD(e);return 4===t.length?uf.emptyPath():fL(t)}function fO(e){return new uf(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function fL(e){return l6(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}function fV(e,t,r){return{name:fN(e,t),fields:r.value.mapValue.fields}}function fF(e,t,r){let n=fP(e,t.name),i=fk(t.updateTime),s=t.createTime?fk(t.createTime):uk.min(),a=new cB({mapValue:{fields:t.fields}}),o=cz.newFoundDocument(n,i,s,a);return r&&o.setHasCommittedMutations(),r?o.setHasCommittedMutations():o}function fj(e,t){var r,n;let i;if(t instanceof d0)i={update:fV(e,t.key,t.value)};else if(t instanceof d3)i={delete:fN(e,t.key)};else if(t instanceof d1){let r;i={update:fV(e,t.key,t.data),updateMask:(n=t.fieldMask,r=[],n.fields.forEach(e=>r.push(e.canonicalString())),{fieldPaths:r})}}else{if(!(t instanceof d4))return l2(16599,{dt:t.type});i={verify:fN(e,t.key)}}return t.fieldTransforms.length>0&&(i.updateTransforms=t.fieldTransforms.map(e=>(function(e,t){let r=t.transform;if(r instanceof dF)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(r instanceof dj)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:r.elements}};if(r instanceof dB)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:r.elements}};if(r instanceof dq)return{fieldPath:t.field.canonicalString(),increment:r.Ae};throw l2(20930,{transform:t.transform})})(0,e))),t.precondition.isNone||(i.currentDocument=void 0!==(r=t.precondition).updateTime?{updateTime:fS(e,r.updateTime.toTimestamp())}:void 0!==r.exists?{exists:r.exists}:l2(27497)),i}function fU(e,t){var r;let n=t.currentDocument?void 0!==(r=t.currentDocument).updateTime?dW.updateTime(fk(r.updateTime)):void 0!==r.exists?dW.exists(r.exists):dW.none():dW.none(),i=t.updateTransforms?t.updateTransforms.map(t=>{let r;return r=null,"setToServerValue"in t?(l6("REQUEST_TIME"===t.setToServerValue,16630,{proto:t}),r=new dF):"appendMissingElements"in t?r=new dj(t.appendMissingElements.values||[]):"removeAllFromArray"in t?r=new dB(t.removeAllFromArray.values||[]):"increment"in t?r=new dq(e,t.increment):l2(16584,{proto:t}),new dK(um.fromServerFormat(t.fieldPath),r)}):[];if(t.update){t.update.name;let r=fP(e,t.update.name),s=new cB({mapValue:{fields:t.update.fields}});return t.updateMask?new d1(r,s,new h9((t.updateMask.fieldPaths||[]).map(e=>um.fromServerFormat(e))),n,i):new d0(r,s,n,i)}return t.delete?new d3(fP(e,t.delete),n):t.verify?new d4(fP(e,t.verify),n):l2(1463,{proto:t})}function fB(e,t){return{documents:[fR(e,t.path)]}}function fz(e,t){var r,n;let i,s={structuredQuery:{}},a=t.path;null!==t.collectionGroup?(i=a,s.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=a.popLast(),s.structuredQuery.from=[{collectionId:a.lastSegment()}]),s.parent=fR(e,i);let o=function(e){if(0!==e.length)return function e(t){var r;let n;return t instanceof cW?function(e){if("=="===e.op){if(cR(e.value))return{unaryFilter:{field:f$(e.field),op:"IS_NAN"}};if(cP(e.value))return{unaryFilter:{field:f$(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(cR(e.value))return{unaryFilter:{field:f$(e.field),op:"IS_NOT_NAN"}};if(cP(e.value))return{unaryFilter:{field:f$(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:f$(e.field),op:fx[e.op],value:e.value}}}(t):t instanceof cQ?1===(n=(r=t).getFilters().map(t=>e(t))).length?n[0]:{compositeFilter:{op:fI[r.op],filters:n}}:l2(54877,{filter:t})}(cQ.create(e,"and"))}(t.filters);o&&(s.structuredQuery.where=o);let l=function(e){if(0!==e.length)return e.map(e=>({field:f$(e.field),direction:fb[e.dir]}))}(t.orderBy);l&&(s.structuredQuery.orderBy=l);let u=fE(e,t.limit);return null!==u&&(s.structuredQuery.limit=u),t.startAt&&(s.structuredQuery.startAt={before:(r=t.startAt).inclusive,values:r.position}),t.endAt&&(s.structuredQuery.endAt={before:!(n=t.endAt).inclusive,values:n.position}),{ft:s,parent:i}}function fq(e){var t,r,n;let i,s,a,o,l=fM(e.parent),u=e.structuredQuery,h=u.from?u.from.length:0,c=null;if(h>0){l6(1===h,65062);let e=u.from[0];e.allDescendants?c=e.collectionId:l=l.child(e.collectionId)}let d=[];u.where&&(d=(i=function e(t){return void 0!==t.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":let t=fG(e.unaryFilter.field);return cW.create(t,"==",{doubleValue:NaN});case"IS_NULL":let r=fG(e.unaryFilter.field);return cW.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let n=fG(e.unaryFilter.field);return cW.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let i=fG(e.unaryFilter.field);return cW.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return l2(61313);default:return l2(60726)}}(t):void 0!==t.fieldFilter?cW.create(fG(t.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return l2(58110);default:return l2(50506)}}(t.fieldFilter.op),t.fieldFilter.value):void 0!==t.compositeFilter?cQ.create(t.compositeFilter.filters.map(t=>e(t)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return l2(1026)}}(t.compositeFilter.op)):l2(30097,{filter:t})}(u.where))instanceof cQ&&cX(i)?i.getFilters():[i]);let f=[];u.orderBy&&(f=u.orderBy.map(e=>new cK(fG(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))));let p=null;u.limit&&(p=u5(s="object"==typeof(t=u.limit)?t.value:t)?null:s);let m=null;u.startAt&&(a=!!(r=u.startAt).before,m=new cq(r.values||[],a));let g=null;return u.endAt&&(o=!(n=u.endAt).before,g=new cq(n.values||[],o)),new dl(l,c,f,d,p,"F",m,g)}function f$(e){return{fieldPath:e.canonicalString()}}function fG(e){return um.fromServerFormat(e.fieldPath)}function fK(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}function fH(e){return!!e&&"function"==typeof e._toProto&&"ProtoValue"===e._protoValueType}class fW{constructor(e,t,r,n,i=uk.min(),s=uk.min(),a=ct.EMPTY_BYTE_STRING,o=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=n,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=o}withSequenceNumber(e){return new fW(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new fW(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new fW(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new fW(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class fQ{constructor(e){this.yt=e}}function fJ(e,t){let r=t.key,n={prefixPath:r.getCollectionPath().popLast().toArray(),collectionGroup:r.collectionGroup,documentId:r.path.lastSegment(),readTime:fY(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument()){var i;n.document={name:fN(i=e.yt,t.key),fields:t.data.value.mapValue.fields,updateTime:fS(i,t.version.toTimestamp()),createTime:fS(i,t.createTime.toTimestamp())}}else if(t.isNoDocument())n.noDocument={path:r.path.toArray(),readTime:fX(t.version)};else{if(!t.isUnknownDocument())return l2(57904,{document:t});n.unknownDocument={path:r.path.toArray(),version:fX(t.version)}}return n}function fY(e){let t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function fX(e){let t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function fZ(e){let t=new u_(e.seconds,e.nanoseconds);return uk.fromTimestamp(t)}function f0(e,t){let r=(t.baseMutations||[]).map(t=>fU(e.yt,t));for(let e=0;e<t.mutations.length-1;++e){let r=t.mutations[e];e+1<t.mutations.length&&void 0!==t.mutations[e+1].transform&&(r.updateTransforms=t.mutations[e+1].transform.fieldTransforms,t.mutations.splice(e+1,1),++e)}let n=t.mutations.map(t=>fU(e.yt,t)),i=u_.fromMillis(t.localWriteTimeMs);return new d8(t.batchId,i,r,n)}function f1(e){var t;let r,n=fZ(e.readTime),i=void 0!==e.lastLimboFreeSnapshotVersion?fZ(e.lastLimboFreeSnapshotVersion):uk.min();return new fW(void 0!==e.query.documents?(l6(1===(r=(t=e.query).documents.length),1966,{count:r}),df(du(fM(t.documents[0])))):df(fq(e.query)),e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,n,i,ct.fromBase64String(e.resumeToken))}function f2(e,t){let r,n=fX(t.snapshotVersion),i=fX(t.lastLimboFreeSnapshotVersion);r=dn(t.target)?fB(e.yt,t.target):fz(e.yt,t.target).ft;let s=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:dt(t.target),readTime:n,resumeToken:s,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function f5(e){let t=fq({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?dg(t,t.limit,"L"):t}function f6(e,t){return new d9(t.largestBatchId,fU(e.yt,t.overlayMutation))}function f3(e,t){let r=t.path.lastSegment();return[e,u4(t.path.popLast()),r]}function f4(e,t,r,n){return{indexId:e,uid:t,sequenceNumber:r,readTime:fX(n.readTime),documentKey:u4(n.documentKey.path),largestBatchId:n.largestBatchId}}class f8{getBundleMetadata(e,t){return hZ(e,hC).get(t).next(e=>{if(e)return{id:e.bundleId,createTime:fZ(e.createTime),version:e.version}})}saveBundleMetadata(e,t){return hZ(e,hC).put({bundleId:t.id,createTime:fX(fk(t.createTime)),version:t.version})}getNamedQuery(e,t){return hZ(e,hA).get(t).next(e=>{if(e)return{name:e.name,query:f5(e.bundledQuery),readTime:fZ(e.readTime)}})}saveNamedQuery(e,t){return hZ(e,hA).put({name:t.name,readTime:fX(fk(t.readTime)),bundledQuery:t.bundledQuery})}}class f7{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){return new f7(e,t.uid||"")}getOverlay(e,t){return hZ(e,hU).get(f3(this.userId,t)).next(e=>e?f6(this.serializer,e):null)}getOverlays(e,t){let r=dC();return uB.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&r.set(t,e)})).next(()=>r)}saveOverlays(e,t,r){let n=[];return r.forEach((r,i)=>{let s=new d9(t,i);n.push(this.bt(e,s))}),uB.waitFor(n)}removeOverlaysForBatchId(e,t,r){let n=new Set;t.forEach(e=>n.add(u4(e.getCollectionPath())));let i=[];return n.forEach(t=>{let n=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,r+1],!1,!0);i.push(hZ(e,hU).X(hz,n))}),uB.waitFor(i)}getOverlaysForCollection(e,t,r){let n=dC(),i=u4(t),s=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,1/0],!0);return hZ(e,hU).H(hz,s).next(e=>{for(let t of e){let e=f6(this.serializer,t);n.set(e.getKey(),e)}return n})}getOverlaysForCollectionGroup(e,t,r,n){let i,s=dC(),a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,1/0],!0);return hZ(e,hU).ee({index:h$,range:a},(e,t,r)=>{let a=f6(this.serializer,t);s.size()<n||a.largestBatchId===i?(s.set(a.getKey(),a),i=a.largestBatchId):r.done()}).next(()=>s)}bt(e,t){return hZ(e,hU).put(function(e,t,r){let[n,i,s]=f3(t,r.mutation.key);return{userId:t,collectionPath:i,documentId:s,collectionGroup:r.mutation.key.getCollectionGroup(),largestBatchId:r.largestBatchId,overlayMutation:fj(e.yt,r.mutation)}}(this.serializer,this.userId,t))}}class f9{St(e){return hZ(e,hK)}getSessionToken(e){return this.St(e).get("sessionToken").next(e=>{let t=e?.value;return t?ct.fromUint8Array(t):ct.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.St(e).put({name:"sessionToken",value:t.toUint8Array()})}}class pe{Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(+!!e.booleanValue);else if("integerValue"in e)this.Ft(t,15),t.Mt(ci(e.integerValue));else if("doubleValue"in e){let r=ci(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),u6(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),"string"==typeof r&&(r=cn(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(cs(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?cV(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):cO(e)?this.kt(e.mapValue,t):(this.Kt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Nt(t)):l2(19022,{Ut:e})}Ot(e,t){this.Ft(t,25),this.$t(e,t)}$t(e,t){t.xt(e)}Kt(e,t){let r=e.fields||{};for(let e of(this.Ft(t,55),Object.keys(r)))this.Ot(e,t),this.Ct(r[e],t)}kt(e,t){let r=e.fields||{};this.Ft(t,53);let n=r[cb].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(ci(n)),this.Ot(cb,t),this.Ct(r[cb],t)}qt(e,t){let r=e.values||[];for(let e of(this.Ft(t,50),r))this.Ct(e,t)}Lt(e,t){this.Ft(t,37),ug.fromName(e).path.forEach(e=>{this.Ft(t,60),this.$t(e,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}function pt(e){return Math.ceil((64-function(e){let t=0;for(let r=0;r<8;++r){let n=function(e){if(0===e)return 8;let t=0;return e>>4||(t+=4,e<<=4),e>>6||(t+=2,e<<=2),e>>7||(t+=1),t}(255&e[r]);if(t+=n,8!==n)break}return t}(e))/8)}pe.Wt=new pe;class pr{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Qt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Ht(r.value),r=t.next();this.Jt()}Zt(e){for(let t of e){let e=t.charCodeAt(0);if(e<128)this.Gt(e);else if(e<2048)this.Gt(960|e>>>6),this.Gt(128|63&e);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|e>>>12),this.Gt(128|63&e>>>6),this.Gt(128|63&e);else{let e=t.codePointAt(0);this.Gt(240|e>>>18),this.Gt(128|63&e>>>12),this.Gt(128|63&e>>>6),this.Gt(128|63&e)}}this.zt()}Xt(e){for(let t of e){let e=t.charCodeAt(0);if(e<128)this.Ht(e);else if(e<2048)this.Ht(960|e>>>6),this.Ht(128|63&e);else if(t<"\uD800"||"\uDBFF"<t)this.Ht(480|e>>>12),this.Ht(128|63&e>>>6),this.Ht(128|63&e);else{let e=t.codePointAt(0);this.Ht(240|e>>>18),this.Ht(128|63&e>>>12),this.Ht(128|63&e>>>6),this.Ht(128|63&e)}}this.Jt()}Yt(e){let t=this.en(e),r=pt(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let e=t.length-r;e<t.length;++e)this.buffer[this.position++]=255&t[e]}nn(e){let t=this.en(e),r=pt(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let e=t.length-r;e<t.length;++e)this.buffer[this.position++]=~(255&t[e])}rn(){this.sn(255),this.sn(255)}_n(){this.an(255),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){let t,r=((t=new DataView(new ArrayBuffer(8))).setFloat64(0,e,!1),new Uint8Array(t.buffer)),n=!!(128&r[0]);r[0]^=n?255:128;for(let e=1;e<r.length;++e)r[e]^=255*!!n;return r}Gt(e){let t=255&e;0===t?(this.sn(0),this.sn(255)):255===t?(this.sn(255),this.sn(0)):this.sn(t)}Ht(e){let t=255&e;0===t?(this.an(0),this.an(255)):255===t?(this.an(255),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Jt(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){let t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);let n=new Uint8Array(r);n.set(this.buffer),this.buffer=n}}class pn{constructor(e){this.cn=e}Bt(e){this.cn.Qt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.Yt(e)}vt(){this.cn.rn()}}class pi{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Xt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class ps{constructor(){this.cn=new pr,this.ascending=new pn(this.cn),this.descending=new pi(this.cn)}seed(e){this.cn.seed(e)}ln(e){return 0===e?this.ascending:this.descending}un(){return this.cn.un()}reset(){this.cn.reset()}}class pa{constructor(e,t,r,n){this.hn=e,this.Pn=t,this.Tn=r,this.In=n}En(){let e=this.In.length,t=0===e||255===this.In[e-1]?e+1:e,r=new Uint8Array(t);return r.set(this.In,0),t!==e?r.set([0],this.In.length):++r[r.length-1],new pa(this.hn,this.Pn,this.Tn,r)}Rn(e,t,r){return{indexId:this.hn,uid:e,arrayValue:pu(this.Tn),directionalValue:pu(this.In),orderedDocumentKey:pu(t),documentKey:r.path.toArray()}}An(e,t,r){let n=this.Rn(e,t,r);return[n.indexId,n.uid,n.arrayValue,n.directionalValue,n.orderedDocumentKey,n.documentKey]}}function po(e,t){let r=e.hn-t.hn;return 0!==r||0!==(r=pl(e.Tn,t.Tn))||0!==(r=pl(e.In,t.In))?r:ug.comparator(e.Pn,t.Pn)}function pl(e,t){for(let r=0;r<e.length&&r<t.length;++r){let n=e[r]-t[r];if(0!==n)return n}return e.length-t.length}function pu(e){return ok()?function(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}(e):e}function ph(e){return"string"!=typeof e?e:function(e){let t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(e)}class pc{constructor(e){for(const t of(this.Vn=new h4((e,t)=>um.comparator(e.field,t.field)),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.dn=e.orderBy,this.mn=[],e.filters))t.isInequality()?this.Vn=this.Vn.add(t):this.mn.push(t)}get fn(){return this.Vn.size>1}gn(e){if(l6(e.collectionGroup===this.collectionId,49279),this.fn)return!1;let t=uA(e);if(void 0!==t&&!this.pn(t))return!1;let r=uD(e),n=new Set,i=0,s=0;for(;i<r.length&&this.pn(r[i]);++i)n=n.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.Vn.size>0){let e=this.Vn.getIterator().getNext();if(!n.has(e.field.canonicalString())){let t=r[i];if(!this.yn(e,t)||!this.wn(this.dn[s++],t))return!1}++i}for(;i<r.length;++i){let e=r[i];if(s>=this.dn.length||!this.wn(this.dn[s++],e))return!1}return!0}bn(){if(this.fn)return null;let e=new h4(um.comparator),t=[];for(let r of this.mn)if(!r.field.isKeyField())if("array-contains"===r.op||"array-contains-any"===r.op)t.push(new uP(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new uP(r.field,0))}for(let r of this.dn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new uP(r.field,+("asc"!==r.dir))));return new uC(uC.UNKNOWN_ID,this.collectionId,t,uR.empty())}pn(e){for(let t of this.mn)if(this.yn(t,e))return!0;return!1}yn(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;let r="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===r}wn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function pd(e){return e instanceof cW}function pf(e){return e instanceof cQ&&cX(e)}function pp(e){return pd(e)||pf(e)||function(e){if(e instanceof cQ&&cY(e)){for(let t of e.getFilters())if(!pd(t)&&!pf(t))return!1;return!0}return!1}(e)}function pm(e,t){return l6(e instanceof cW||e instanceof cQ,38388),l6(t instanceof cW||t instanceof cQ,25473),py(e instanceof cW?t instanceof cW?cQ.create([e,t],"and"):pg(e,t):t instanceof cW?pg(t,e):function(e,t){if(l6(e.filters.length>0&&t.filters.length>0,48005),cJ(e)&&cJ(t))return c0(e,t.getFilters());let r=cY(e)?e:t,n=cY(e)?t:e,i=r.filters.map(e=>pm(e,n));return cQ.create(i,"or")}(e,t))}function pg(e,t){if(cJ(t))return c0(t,e.getFilters());{let r=t.filters.map(t=>pm(e,t));return cQ.create(r,"or")}}function py(e){if(l6(e instanceof cW||e instanceof cQ,11850),e instanceof cW)return e;let t=e.getFilters();if(1===t.length)return py(t[0]);if(cZ(e))return e;let r=t.map(e=>py(e)),n=[];return r.forEach(t=>{t instanceof cW?n.push(t):t instanceof cQ&&(t.op===e.op?n.push(...t.filters):n.push(t))}),1===n.length?n[0]:cQ.create(n,e.op)}class pv{constructor(){this.Sn=new pw}addToCollectionParentIndex(e,t){return this.Sn.add(t),uB.resolve()}getCollectionParents(e,t){return uB.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return uB.resolve()}deleteFieldIndex(e,t){return uB.resolve()}deleteAllFieldIndexes(e){return uB.resolve()}createTargetIndexes(e,t){return uB.resolve()}getDocumentsMatchingTarget(e,t){return uB.resolve(null)}getIndexType(e,t){return uB.resolve(0)}getFieldIndexes(e,t){return uB.resolve([])}getNextCollectionGroupToUpdate(e){return uB.resolve(null)}getMinOffset(e,t){return uB.resolve(uL.min())}getMinOffsetFromCollectionGroup(e,t){return uB.resolve(uL.min())}updateCollectionGroup(e,t,r){return uB.resolve()}updateIndexEntries(e,t){return uB.resolve()}}class pw{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),n=this.index[t]||new h4(uf.comparator),i=!n.has(r);return this.index[t]=n.add(r),i}has(e){let t=e.lastSegment(),r=e.popLast(),n=this.index[t];return n&&n.has(r)}getEntries(e){return(this.index[e]||new h4(uf.comparator)).toArray()}}let pb="IndexedDbIndexManager",px=new Uint8Array(0);class pI{constructor(e,t){this.databaseId=t,this.Dn=new pw,this.Cn=new dT(e=>dt(e),(e,t)=>dr(e,t)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Dn.has(t)){let r=t.lastSegment(),n=t.popLast();e.addOnCommittedListener(()=>{this.Dn.add(t)});let i={collectionId:r,parent:u4(n)};return hZ(e,hS).put(i)}return uB.resolve()}getCollectionParents(e,t){let r=[],n=IDBKeyRange.bound([t,""],[t+"\0",""],!1,!0);return hZ(e,hS).H(n).next(e=>{for(let n of e){if(n.collectionId!==t)break;r.push(u8(n.parent))}return r})}addFieldIndex(e,t){let r=hZ(e,hD),n={indexId:t.indexId,collectionGroup:t.collectionGroup,fields:t.fields.map(e=>[e.fieldPath.canonicalString(),e.kind])};delete n.indexId;let i=r.add(n);if(t.indexState){let r=hZ(e,hP);return i.next(e=>{r.put(f4(e,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return i.next()}deleteFieldIndex(e,t){let r=hZ(e,hD),n=hZ(e,hP),i=hZ(e,hL);return r.delete(t.indexId).next(()=>n.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=hZ(e,hD),r=hZ(e,hL),n=hZ(e,hP);return t.X().next(()=>r.X()).next(()=>n.X())}createTargetIndexes(e,t){return uB.forEach(this.vn(t),t=>this.getIndexType(e,t).next(r=>{if(0===r||1===r){let r=new pc(t).bn();if(null!=r)return this.addFieldIndex(e,r)}}))}getDocumentsMatchingTarget(e,t){let r=hZ(e,hL),n=!0,i=new Map;return uB.forEach(this.vn(t),t=>this.Fn(e,t).next(e=>{n&&(n=!!e),i.set(t,e)})).next(()=>{if(n){let e=dN(),n=[];return uB.forEach(i,(i,s)=>{lX(pb,`Using index id=${i.indexId}|cg=${i.collectionGroup}|f=${i.fields.map(e=>`${e.fieldPath}:${e.kind}`).join(",")} to execute ${dt(t)}`);let a=function(e,t){let r=uA(t);if(void 0===r)return null;for(let t of di(e,r.fieldPath))switch(t.op){case"array-contains-any":return t.value.arrayValue.values||[];case"array-contains":return[t.value]}return null}(s,i),o=function(e,t){let r=new Map;for(let n of uD(t))for(let t of di(e,n.fieldPath))switch(t.op){case"==":case"in":r.set(n.fieldPath.canonicalString(),t.value);break;case"not-in":case"!=":return r.set(n.fieldPath.canonicalString(),t.value),Array.from(r.values())}return null}(s,i),l=function(e,t){let r=[],n=!0;for(let i of uD(t)){let t=0===i.kind?ds(e,i.fieldPath,e.startAt):da(e,i.fieldPath,e.startAt);r.push(t.value),n&&(n=t.inclusive)}return new cq(r,n)}(s,i),u=function(e,t){let r=[],n=!0;for(let i of uD(t)){let t=0===i.kind?da(e,i.fieldPath,e.endAt):ds(e,i.fieldPath,e.endAt);r.push(t.value),n&&(n=t.inclusive)}return new cq(r,n)}(s,i),h=this.Mn(i,s,l),c=this.Mn(i,s,u),d=this.xn(i,s,o),f=this.On(i.indexId,a,h,l.inclusive,c,u.inclusive,d);return uB.forEach(f,i=>r.Z(i,t.limit).next(t=>{t.forEach(t=>{let r=ug.fromSegments(t.documentKey);e.has(r)||(e=e.add(r),n.push(r))})}))}).next(()=>n)}return uB.resolve(null)})}vn(e){let t=this.Cn.get(e);return t||(t=0===e.filters.length?[e]:(function(e){if(0===e.getFilters().length)return[];let t=function e(t){if(l6(t instanceof cW||t instanceof cQ,34018),t instanceof cW)return t;if(1===t.filters.length)return e(t.filters[0]);let r=t.filters.map(t=>e(t)),n=cQ.create(r,t.op);return pp(n=py(n))?n:(l6(n instanceof cQ,64498),l6(cJ(n),40251),l6(n.filters.length>1,57927),n.filters.reduce((e,t)=>pm(e,t)))}(function e(t){if(l6(t instanceof cW||t instanceof cQ,20012),t instanceof cW){if(t instanceof c4){let e=t.value.arrayValue?.values?.map(e=>cW.create(t.field,"==",e))||[];return cQ.create(e,"or")}return t}let r=t.filters.map(t=>e(t));return cQ.create(r,t.op)}(e));return l6(pp(t),7391),pd(t)||pf(t)?[t]:t.getFilters()})(cQ.create(e.filters,"and")).map(t=>de(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt)),this.Cn.set(e,t)),t}On(e,t,r,n,i,s,a){let o=(null!=t?t.length:1)*Math.max(r.length,i.length),l=o/(null!=t?t.length:1),u=[];for(let h=0;h<o;++h){let o=t?this.Nn(t[h/l]):px,c=this.Bn(e,o,r[h%l],n),d=this.Ln(e,o,i[h%l],s),f=a.map(t=>this.Bn(e,o,t,!0));u.push(...this.createRange(c,d,f))}return u}Bn(e,t,r,n){let i=new pa(e,ug.empty(),t,r);return n?i:i.En()}Ln(e,t,r,n){let i=new pa(e,ug.empty(),t,r);return n?i.En():i}Fn(e,t){let r=new pc(t),n=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,n).next(e=>{let t=null;for(let n of e)r.gn(n)&&(!t||n.fields.length>t.fields.length)&&(t=n);return t})}getIndexType(e,t){let r=2,n=this.vn(t);return uB.forEach(n,t=>this.Fn(e,t).next(e=>{e?0!==r&&e.fields.length<function(e){let t=new h4(um.comparator),r=!1;for(let n of e.filters)for(let e of n.getFlattenedFilters())e.field.isKeyField()||("array-contains"===e.op||"array-contains-any"===e.op?r=!0:t=t.add(e.field));for(let r of e.orderBy)r.field.isKeyField()||(t=t.add(r.field));return t.size+ +!!r}(t)&&(r=1):r=0})).next(()=>null!==t.limit&&n.length>1&&2===r?1:r)}kn(e,t){let r=new ps;for(let n of uD(e)){let e=t.data.field(n.fieldPath);if(null==e)return null;let i=r.ln(n.kind);pe.Wt.Dt(e,i)}return r.un()}Nn(e){let t=new ps;return pe.Wt.Dt(e,t.ln(0)),t.un()}Kn(e,t){let r,n=new ps;return pe.Wt.Dt(cA(this.databaseId,t),n.ln(0===(r=uD(e)).length?0:r[r.length-1].kind)),n.un()}xn(e,t,r){if(null===r)return[];let n=[];n.push(new ps);let i=0;for(let s of uD(e)){let e=r[i++];for(let r of n)if(this.qn(t,s.fieldPath)&&cN(e))n=this.Un(n,s,e);else{let t=r.ln(s.kind);pe.Wt.Dt(e,t)}}return this.$n(n)}Mn(e,t,r){return this.xn(e,t,r.position)}$n(e){let t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Un(e,t,r){let n=[...e],i=[];for(let e of r.arrayValue.values||[])for(let r of n){let n=new ps;n.seed(r.un()),pe.Wt.Dt(e,n.ln(t.kind)),i.push(n)}return i}qn(e,t){return!!e.filters.find(e=>e instanceof cW&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op))}getFieldIndexes(e,t){let r=hZ(e,hD),n=hZ(e,hP);return(t?r.H(hN,IDBKeyRange.bound(t,t)):r.H()).next(e=>{let t=[];return uB.forEach(e,e=>n.get([e.indexId,this.uid]).next(r=>{let n,i;t.push((n=r?new uR(r.sequenceNumber,new uL(fZ(r.readTime),new ug(u8(r.documentKey)),r.largestBatchId)):uR.empty(),i=e.fields.map(([e,t])=>new uP(um.fromServerFormat(e),t)),new uC(e.indexId,e.collectionGroup,i,n)))})).next(()=>t)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(e=>0===e.length?null:(e.sort((e,t)=>{let r=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==r?r:uo(e.collectionGroup,t.collectionGroup)}),e[0].collectionGroup))}updateCollectionGroup(e,t,r){let n=hZ(e,hD),i=hZ(e,hP);return this.Wn(e).next(e=>n.H(hN,IDBKeyRange.bound(t,t)).next(t=>uB.forEach(t,t=>i.put(f4(t.indexId,this.uid,e,r)))))}updateIndexEntries(e,t){let r=new Map;return uB.forEach(t,(t,n)=>{let i=r.get(t.collectionGroup);return(i?uB.resolve(i):this.getFieldIndexes(e,t.collectionGroup)).next(i=>(r.set(t.collectionGroup,i),uB.forEach(i,r=>this.Qn(e,t,r).next(t=>{let i=this.Gn(n,r);return t.isEqual(i)?uB.resolve():this.zn(e,n,r,t,i)}))))})}jn(e,t,r,n){return hZ(e,hL).put(n.Rn(this.uid,this.Kn(r,t.key),t.key))}Hn(e,t,r,n){return hZ(e,hL).delete(n.An(this.uid,this.Kn(r,t.key),t.key))}Qn(e,t,r){let n=hZ(e,hL),i=new h4(po);return n.ee({index:hF,range:IDBKeyRange.only([r.indexId,this.uid,pu(this.Kn(r,t))])},(e,n)=>{i=i.add(new pa(r.indexId,t,ph(n.arrayValue),ph(n.directionalValue)))}).next(()=>i)}Gn(e,t){let r=new h4(po),n=this.kn(t,e);if(null==n)return r;let i=uA(t);if(null!=i){let s=e.data.field(i.fieldPath);if(cN(s))for(let i of s.arrayValue.values||[])r=r.add(new pa(t.indexId,e.key,this.Nn(i),n))}else r=r.add(new pa(t.indexId,e.key,px,n));return r}zn(e,t,r,n,i){lX(pb,"Updating index entries for document '%s'",t.key);let s=[];return function(e,t,r,n,i){let s=e.getIterator(),a=t.getIterator(),o=h7(s),l=h7(a);for(;o||l;){let e=!1,t=!1;if(o&&l){let n=r(o,l);n<0?t=!0:n>0&&(e=!0)}else null!=o?t=!0:e=!0;e?(n(l),l=h7(a)):t?(i(o),o=h7(s)):(o=h7(s),l=h7(a))}}(n,i,po,n=>{s.push(this.jn(e,t,r,n))},n=>{s.push(this.Hn(e,t,r,n))}),uB.waitFor(s)}Wn(e){let t=1;return hZ(e,hP).ee({index:hM,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(e,r,n)=>{n.done(),t=r.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((e,t)=>po(e,t)).filter((e,t,r)=>!t||0!==po(e,r[t-1]));let n=[];for(let i of(n.push(e),r)){let r=po(i,e),s=po(i,t);if(0===r)n[0]=e.En();else if(r>0&&s<0)n.push(i),n.push(i.En());else if(s>0)break}n.push(t);let i=[];for(let e=0;e<n.length;e+=2){if(this.Jn(n[e],n[e+1]))return[];let t=n[e].An(this.uid,px,ug.empty()),r=n[e+1].An(this.uid,px,ug.empty());i.push(IDBKeyRange.bound(t,r))}return i}Jn(e,t){return po(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(pT)}getMinOffset(e,t){return uB.mapArray(this.vn(t),t=>this.Fn(e,t).next(e=>e||l2(44426))).next(pT)}}function pT(e){l6(0!==e.length,28825);let t=e[0].indexState.offset,r=t.largestBatchId;for(let n=1;n<e.length;n++){let i=e[n].indexState.offset;0>uV(i,t)&&(t=i),r<i.largestBatchId&&(r=i.largestBatchId)}return new uL(t.readTime,t.documentKey,r)}let pE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class pS{static withCacheSize(e){return new pS(e,pS.DEFAULT_COLLECTION_PERCENTILE,pS.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}function p_(e,t,r){let n=e.store(hr),i=e.store(ho),s=[],a=IDBKeyRange.only(r.batchId),o=0,l=n.ee({range:a},(e,t,r)=>(o++,r.delete()));s.push(l.next(()=>{l6(1===o,47070,{batchId:r.batchId})}));let u=[];for(let e of r.mutations){var h,c;let n=(h=e.key.path,c=r.batchId,[t,u4(h),c]);s.push(i.delete(n)),u.push(e.key)}return uB.waitFor(s).next(()=>u)}function pk(e){let t;if(!e)return 0;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw l2(14731);t=e.noDocument}return JSON.stringify(t).length}pS.DEFAULT_COLLECTION_PERCENTILE=10,pS.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,pS.DEFAULT=new pS(0x2800000,pS.DEFAULT_COLLECTION_PERCENTILE,pS.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),pS.DISABLED=new pS(-1,0,0);class pC{constructor(e,t,r,n){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=n,this.Zn={}}static wt(e,t,r,n){return l6(""!==e.uid,64387),new pC(e.isAuthenticated()?e.uid:"",t,r,n)}checkEmpty(e){let t=!0,r=IDBKeyRange.bound([this.userId,-1/0],[this.userId,1/0]);return pD(e).ee({index:hi,range:r},(e,r,n)=>{t=!1,n.done()}).next(()=>t)}addMutationBatch(e,t,r,n){let i=hZ(e,ho),s=pD(e);return s.add({}).next(a=>{var o,l,u,h;let c,d;l6("number"==typeof a,49019);let f=new d8(a,t,r,n),p=(o=this.serializer,l=this.userId,c=f.baseMutations.map(e=>fj(o.yt,e)),d=f.mutations.map(e=>fj(o.yt,e)),{userId:l,batchId:f.batchId,localWriteTimeMs:f.localWriteTime.toMillis(),baseMutations:c,mutations:d}),m=[],g=new h4((e,t)=>uo(e.canonicalString(),t.canonicalString()));for(let e of n){let t=(u=this.userId,h=e.key.path,[u,u4(h),a]);g=g.add(e.key.path.popLast()),m.push(s.put(p)),m.push(i.put(t,ha))}return g.forEach(t=>{m.push(this.indexManager.addToCollectionParentIndex(e,t))}),e.addOnCommittedListener(()=>{this.Zn[a]=f.keys()}),uB.waitFor(m).next(()=>f)})}lookupMutationBatch(e,t){return pD(e).get(t).next(e=>e?(l6(e.userId===this.userId,48,"Unexpected user for mutation batch",{userId:e.userId,batchId:t}),f0(this.serializer,e)):null)}Xn(e,t){return this.Zn[t]?uB.resolve(this.Zn[t]):this.lookupMutationBatch(e,t).next(e=>{if(e){let r=e.keys();return this.Zn[t]=r,r}return null})}getNextMutationBatchAfterBatchId(e,t){let r=t+1,n=IDBKeyRange.lowerBound([this.userId,r]),i=null;return pD(e).ee({index:hi,range:n},(e,t,n)=>{t.userId===this.userId&&(l6(t.batchId>=r,47524,{Yn:r}),i=f0(this.serializer,t)),n.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,1/0]),r=-1;return pD(e).ee({index:hi,range:t,reverse:!0},(e,t,n)=>{r=t.batchId,n.done()}).next(()=>r)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,-1],[this.userId,1/0]);return pD(e).H(hi,t).next(e=>e.map(e=>f0(this.serializer,e)))}getAllMutationBatchesAffectingDocumentKey(e,t){let r=[this.userId,u4(t.path)],n=IDBKeyRange.lowerBound(r),i=[];return hZ(e,ho).ee({range:n},(r,n,s)=>{let[a,o,l]=r,u=u8(o);if(a===this.userId&&t.path.isEqual(u))return pD(e).get(l).next(e=>{if(!e)throw l2(61480,{er:r,batchId:l});l6(e.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:e.userId,batchId:l}),i.push(f0(this.serializer,e))});s.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new h4(uo),n=[];return t.forEach(t=>{let i=[this.userId,u4(t.path)],s=IDBKeyRange.lowerBound(i),a=hZ(e,ho).ee({range:s},(e,n,i)=>{let[s,a,o]=e,l=u8(a);s===this.userId&&t.path.isEqual(l)?r=r.add(o):i.done()});n.push(a)}),uB.waitFor(n).next(()=>this.tr(e,r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,n=r.length+1,i=[this.userId,u4(r)],s=IDBKeyRange.lowerBound(i),a=new h4(uo);return hZ(e,ho).ee({range:s},(e,t,i)=>{let[s,o,l]=e,u=u8(o);s===this.userId&&r.isPrefixOf(u)?u.length===n&&(a=a.add(l)):i.done()}).next(()=>this.tr(e,a))}tr(e,t){let r=[],n=[];return t.forEach(t=>{n.push(pD(e).get(t).next(e=>{if(null===e)throw l2(35274,{batchId:t});l6(e.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:e.userId,batchId:t}),r.push(f0(this.serializer,e))}))}),uB.waitFor(n).next(()=>r)}removeMutationBatch(e,t){return p_(e.le,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.nr(t.batchId)}),uB.forEach(r,t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))}nr(e){delete this.Zn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return uB.resolve();let r=IDBKeyRange.lowerBound([this.userId]),n=[];return hZ(e,ho).ee({range:r},(e,t,r)=>{if(e[0]===this.userId){let t=u8(e[1]);n.push(t)}else r.done()}).next(()=>{l6(0===n.length,56720,{rr:n.map(e=>e.canonicalString())})})})}containsKey(e,t){return pA(e,this.userId,t)}ir(e){return hZ(e,ht).get(this.userId).next(e=>e||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function pA(e,t,r){let n=[t,u4(r.path)],i=n[1],s=IDBKeyRange.lowerBound(n),a=!1;return hZ(e,ho).ee({range:s,Y:!0},(e,r,n)=>{let[s,o,l]=e;s===t&&o===i&&(a=!0),n.done()}).next(()=>a)}function pD(e){return hZ(e,hr)}class pN{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new pN(0)}static ar(){return new pN(-1)}}class pP{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.ur(e).next(t=>{let r=new pN(t.highestTargetId);return t.highestTargetId=r.next(),this.cr(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.ur(e).next(e=>uk.fromTimestamp(new u_(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.ur(e).next(e=>e.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.ur(e).next(n=>(n.highestListenSequenceNumber=t,r&&(n.lastRemoteSnapshotVersion=r.toTimestamp()),t>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=t),this.cr(e,n)))}addTargetData(e,t){return this.lr(e,t).next(()=>this.ur(e).next(r=>(r.targetCount+=1,this.hr(t,r),this.cr(e,r))))}updateTargetData(e,t){return this.lr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>hZ(e,hg).delete(t.targetId)).next(()=>this.ur(e)).next(t=>(l6(t.targetCount>0,8065),t.targetCount-=1,this.cr(e,t)))}removeTargets(e,t,r){let n=0,i=[];return hZ(e,hg).ee((s,a)=>{let o=f1(a);o.sequenceNumber<=t&&null===r.get(o.targetId)&&(n++,i.push(this.removeTargetData(e,o)))}).next(()=>uB.waitFor(i)).next(()=>n)}forEachTarget(e,t){return hZ(e,hg).ee((e,r)=>{t(f1(r))})}ur(e){return hZ(e,hE).get(hT).next(e=>(l6(null!==e,2888),e))}cr(e,t){return hZ(e,hE).put(hT,t)}lr(e,t){return hZ(e,hg).put(f2(this.serializer,t))}hr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.ur(e).next(e=>e.targetCount)}getTargetData(e,t){let r=dt(t),n=IDBKeyRange.bound([r,-1/0],[r,1/0]),i=null;return hZ(e,hg).ee({range:n,index:hy},(e,r,n)=>{let s=f1(r);dr(t,s.target)&&(i=s,n.done())}).next(()=>i)}addMatchingKeys(e,t,r){let n=[],i=pR(e);return t.forEach(t=>{let s=u4(t.path);n.push(i.put({targetId:r,path:s})),n.push(this.referenceDelegate.addReference(e,r,t))}),uB.waitFor(n)}removeMatchingKeys(e,t,r){let n=pR(e);return uB.forEach(t,t=>{let i=u4(t.path);return uB.waitFor([n.delete([r,i]),this.referenceDelegate.removeReference(e,r,t)])})}removeMatchingKeysForTargetId(e,t){let r=pR(e),n=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(n)}getMatchingKeysForTargetId(e,t){let r=IDBKeyRange.bound([t],[t+1],!1,!0),n=pR(e),i=dN();return n.ee({range:r,Y:!0},(e,t,r)=>{let n=new ug(u8(e[1]));i=i.add(n)}).next(()=>i)}containsKey(e,t){let r=u4(t.path),n=IDBKeyRange.bound([r],[r+"\0"],!1,!0),i=0;return pR(e).ee({index:hx,Y:!0,range:n},([e,t],r,n)=>{0!==e&&(i++,n.done())}).next(()=>i>0)}At(e,t){return hZ(e,hg).get(t).next(e=>e?f1(e):null)}}function pR(e){return hZ(e,hw)}let pM="LruGarbageCollector";function pO([e,t],[r,n]){let i=uo(e,r);return 0===i?uo(t,n):i}class pL{constructor(e){this.Pr=e,this.buffer=new h4(pO),this.Tr=0}Ir(){return++this.Tr}Er(e){let t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{let e=this.buffer.last();0>pO(t,e)&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class pV{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return null!==this.Rr}Ar(e){lX(pM,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){uW(e)?lX(pM,"Ignoring IndexedDB error during garbage collection: ",e):await uU(e)}await this.Ar(3e5)})}}class pF{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return uB.resolve(u2.ce);let r=new pL(t);return this.Vr.forEachTarget(e,e=>r.Er(e.sequenceNumber)).next(()=>this.Vr.mr(e,e=>r.Er(e))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Vr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return -1===this.params.cacheSizeCollectionThreshold?(lX("LruGarbageCollector","Garbage collection skipped; disabled"),uB.resolve(pE)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(lX("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),pE):this.gr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let r,n,i,s,a,o,l,u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(lX("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),n=this.params.maximumSequenceNumbersToCollect):n=t,s=Date.now(),this.nthSequenceNumber(e,n))).next(n=>(r=n,a=Date.now(),this.removeTargets(e,r,t))).next(t=>(i=t,o=Date.now(),this.removeOrphanedDocuments(e,r))).next(e=>(l=Date.now(),lY()<=p.DEBUG&&lX("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-u}ms
	Determined least recently used ${n} in `+(a-s)+"ms\n"+`	Removed ${i} targets in `+(o-a)+"ms\n"+`	Removed ${e} documents in `+(l-o)+"ms\n"+`Total Duration: ${l-u}ms`),uB.resolve({didRun:!0,sequenceNumbersCollected:n,targetsRemoved:i,documentsRemoved:e})))}}class pj{constructor(e,t){this.db=e,this.garbageCollector=new pF(this,t)}dr(e){let t=this.pr(e);return this.db.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}pr(e){let t=0;return this.mr(e,e=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}mr(e,t){return this.yr(e,(e,r)=>t(r))}addReference(e,t,r){return pU(e,r)}removeReference(e,t,r){return pU(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return pU(e,t)}wr(e,t){let r;return r=!1,hZ(e,ht).te(n=>pA(e,n,t).next(e=>(e&&(r=!0),uB.resolve(!e)))).next(()=>r)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),n=[],i=0;return this.yr(e,(s,a)=>{if(a<=t){let t=this.wr(e,s).next(t=>{if(!t)return i++,r.getEntry(e,s).next(()=>(r.removeEntry(s,uk.min()),pR(e).delete([0,u4(s.path)])))});n.push(t)}}).next(()=>uB.waitFor(n)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return pU(e,t)}yr(e,t){let r=pR(e),n,i=u2.ce;return r.ee({index:hx},([e,r],{path:s,sequenceNumber:a})=>{0===e?(i!==u2.ce&&t(new ug(u8(n)),i),i=a,n=s):i=u2.ce}).next(()=>{i!==u2.ce&&t(new ug(u8(n)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function pU(e,t){var r;return pR(e).put((r=e.currentSequenceNumber,{targetId:0,path:u4(t.path),sequenceNumber:r}))}class pB{constructor(){this.changes=new dT(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,cz.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return void 0!==r?uB.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class pz{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return hZ(e,hl).put(r)}removeEntry(e,t,r){let n;return hZ(e,hl).delete([(n=t.path.toArray()).slice(0,n.length-2),n[n.length-2],fY(r),n[n.length-1]])}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.br(e,r)))}getEntry(e,t){let r=cz.newInvalidDocument(t);return hZ(e,hl).ee({index:hh,range:IDBKeyRange.only(p$(t))},(e,n)=>{r=this.Sr(t,n)}).next(()=>r)}Dr(e,t){let r={size:0,document:cz.newInvalidDocument(t)};return hZ(e,hl).ee({index:hh,range:IDBKeyRange.only(p$(t))},(e,n)=>{r={document:this.Sr(t,n),size:pk(n)}}).next(()=>r)}getEntries(e,t){let r=dE;return this.Cr(e,t,(e,t)=>{let n=this.Sr(e,t);r=r.insert(e,n)}).next(()=>r)}vr(e,t){let r=dE,n=new h5(ug.comparator);return this.Cr(e,t,(e,t)=>{let i=this.Sr(e,t);r=r.insert(e,i),n=n.insert(e,pk(t))}).next(()=>({documents:r,Fr:n}))}Cr(e,t,r){if(t.isEmpty())return uB.resolve();let n=new h4(pK);t.forEach(e=>n=n.add(e));let i=IDBKeyRange.bound(p$(n.first()),p$(n.last())),s=n.getIterator(),a=s.getNext();return hZ(e,hl).ee({index:hh,range:i},(e,t,n)=>{let i=ug.fromSegments([...t.prefixPath,t.collectionGroup,t.documentId]);for(;a&&0>pK(a,i);)r(a,null),a=s.getNext();a&&a.isEqual(i)&&(r(a,t),a=s.hasNext()?s.getNext():null),a?n.j(p$(a)):n.done()}).next(()=>{for(;a;)r(a,null),a=s.hasNext()?s.getNext():null})}getDocumentsMatchingQuery(e,t,r,n,i){let s=t.path,a=[s.popLast().toArray(),s.lastSegment(),fY(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],o=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return hZ(e,hl).H(IDBKeyRange.bound(a,o,!0)).next(e=>{i?.incrementDocumentReadCount(e.length);let r=dE;for(let i of e){let e=this.Sr(ug.fromSegments(i.prefixPath.concat(i.collectionGroup,i.documentId)),i);e.isFoundDocument()&&(db(t,e)||n.has(e.key))&&(r=r.insert(e.key,e))}return r})}getAllFromCollectionGroup(e,t,r,n){let i=dE,s=pG(t,r),a=pG(t,uL.max());return hZ(e,hl).ee({index:hd,range:IDBKeyRange.bound(s,a,!0)},(e,t,r)=>{let s=this.Sr(ug.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);(i=i.insert(s.key,s)).size===n&&r.done()}).next(()=>i)}newChangeBuffer(e){return new pq(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(e=>e.byteSize)}getMetadata(e){return hZ(e,hp).get(hm).next(e=>(l6(!!e,20021),e))}br(e,t){return hZ(e,hp).put(hm,t)}Sr(e,t){if(t){let e=function(e,t){var r;let n,i;if(t.document)n=fF(e.yt,t.document,!!t.hasCommittedMutations);else if(t.noDocument){let e=ug.fromSegments(t.noDocument.path),r=fZ(t.noDocument.readTime);n=cz.newNoDocument(e,r),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return l2(56709);{let e=ug.fromSegments(t.unknownDocument.path),r=fZ(t.unknownDocument.version);n=cz.newUnknownDocument(e,r)}}return t.readTime&&n.setReadTime((i=new u_((r=t.readTime)[0],r[1]),uk.fromTimestamp(i))),n}(this.serializer,t);if(!(e.isNoDocument()&&e.version.isEqual(uk.min())))return e}return cz.newInvalidDocument(e)}}class pq extends pB{constructor(e,t){super(),this.Mr=e,this.trackRemovals=t,this.Or=new dT(e=>e.toString(),(e,t)=>e.isEqual(t))}applyChanges(e){let t=[],r=0,n=new h4((e,t)=>uo(e.canonicalString(),t.canonicalString()));return this.changes.forEach((i,s)=>{let a=this.Or.get(i);if(t.push(this.Mr.removeEntry(e,i,a.readTime)),s.isValidDocument()){let o=fJ(this.Mr.serializer,s);n=n.add(i.path.popLast());let l=pk(o);r+=l-a.size,t.push(this.Mr.addEntry(e,i,o))}else if(r-=a.size,this.trackRemovals){let r=fJ(this.Mr.serializer,s.convertToNoDocument(uk.min()));t.push(this.Mr.addEntry(e,i,r))}}),n.forEach(r=>{t.push(this.Mr.indexManager.addToCollectionParentIndex(e,r))}),t.push(this.Mr.updateMetadata(e,r)),uB.waitFor(t)}getFromCache(e,t){return this.Mr.Dr(e,t).next(e=>(this.Or.set(t,{size:e.size,readTime:e.document.readTime}),e.document))}getAllFromCache(e,t){return this.Mr.vr(e,t).next(({documents:e,Fr:t})=>(t.forEach((t,r)=>{this.Or.set(t,{size:r,readTime:e.get(t).readTime})}),e))}}function p$(e){let t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function pG(e,t){let r=t.documentKey.path.toArray();return[e,fY(t.readTime),r.slice(0,r.length-2),r.length>0?r[r.length-1]:""]}function pK(e,t){let r=e.path.toArray(),n=t.path.toArray(),i=0;for(let e=0;e<r.length-2&&e<n.length-2;++e)if(i=uo(r[e],n[e]))return i;return(i=uo(r.length,n.length))||(i=uo(r[r.length-2],n[n.length-2]))||uo(r[r.length-1],n[n.length-1])}class pH{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class pW{constructor(e,t,r,n){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=n}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(n=>(r=n,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==r&&dX(r.mutation,e,h9.empty(),u_.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,dN()).next(()=>t))}getLocalViewOfDocuments(e,t,r=dN()){let n=dC();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,r).next(e=>{let t=d_();return e.forEach((e,r)=>{t=t.insert(e,r.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){let r=dC();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,dN()))}populateOverlays(e,t,r){let n=[];return r.forEach(e=>{t.has(e)||n.push(e)}),this.documentOverlayCache.getOverlays(e,n).next(e=>{e.forEach((e,r)=>{t.set(e,r)})})}computeViews(e,t,r,n){let i=dE,s=dC(),a=dC();return t.forEach((e,t)=>{let a=r.get(t.key);n.has(t.key)&&(void 0===a||a.mutation instanceof d1)?i=i.insert(t.key,t):void 0!==a?(s.set(t.key,a.mutation.getFieldMask()),dX(a.mutation,t,a.mutation.getFieldMask(),u_.now())):s.set(t.key,h9.empty())}),this.recalculateAndSaveOverlays(e,i).next(e=>(e.forEach((e,t)=>s.set(e,t)),t.forEach((e,t)=>a.set(e,new pH(t,s.get(e)??null))),a))}recalculateAndSaveOverlays(e,t){let r=dC(),n=new h5((e,t)=>e-t),i=dN();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(let i of e)i.keys().forEach(e=>{let s=t.get(e);if(null===s)return;let a=r.get(e)||h9.empty();a=i.applyToLocalView(s,a),r.set(e,a);let o=(n.get(i.batchId)||dN()).add(e);n=n.insert(i.batchId,o)})}).next(()=>{let s=[],a=n.getReverseIterator();for(;a.hasNext();){let n=a.getNext(),o=n.key,l=n.value,u=dC();l.forEach(e=>{if(!i.has(e)){let n=dY(t.get(e),r.get(e));null!==n&&u.set(e,n),i=i.add(e)}}),s.push(this.documentOverlayCache.saveOverlays(e,o,u))}return uB.waitFor(s)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,r,n){return ug.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):dc(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,n):this.getDocumentsMatchingCollectionQuery(e,t,r,n)}getNextDocuments(e,t,r,n){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,n).next(i=>{let s=n-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,n-i.size):uB.resolve(dC()),a=-1,o=i;return s.next(t=>uB.forEach(t,(t,r)=>(a<r.largestBatchId&&(a=r.largestBatchId),i.get(t)?uB.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{o=o.insert(t,e)}))).next(()=>this.populateOverlays(e,t,i)).next(()=>this.computeViews(e,o,t,dN())).next(e=>({batchId:a,changes:dk(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ug(t)).next(e=>{let t=d_();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,r,n){let i=t.collectionGroup,s=d_();return this.indexManager.getCollectionParents(e,i).next(a=>uB.forEach(a,a=>{let o=new dl(a.child(i),null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt);return this.getDocumentsMatchingCollectionQuery(e,o,r,n).next(e=>{e.forEach((e,t)=>{s=s.insert(e,t)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,r,n){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,n))).next(e=>{i.forEach((t,r)=>{let n=r.getKey();null===e.get(n)&&(e=e.insert(n,cz.newInvalidDocument(n)))});let r=d_();return e.forEach((e,n)=>{let s=i.get(e);void 0!==s&&dX(s.mutation,n,h9.empty(),u_.now()),db(t,n)&&(r=r.insert(e,n))}),r})}}class pQ{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return uB.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,{id:t.id,version:t.version,createTime:fk(t.createTime)}),uB.resolve()}getNamedQuery(e,t){return uB.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,{name:t.name,query:f5(t.bundledQuery),readTime:fk(t.readTime)}),uB.resolve()}}class pJ{constructor(){this.overlays=new h5(ug.comparator),this.Lr=new Map}getOverlay(e,t){return uB.resolve(this.overlays.get(t))}getOverlays(e,t){let r=dC();return uB.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&r.set(t,e)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((r,n)=>{this.bt(e,t,n)}),uB.resolve()}removeOverlaysForBatchId(e,t,r){let n=this.Lr.get(r);return void 0!==n&&(n.forEach(e=>this.overlays=this.overlays.remove(e)),this.Lr.delete(r)),uB.resolve()}getOverlaysForCollection(e,t,r){let n=dC(),i=t.length+1,s=new ug(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){let e=a.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>r&&n.set(e.getKey(),e)}return uB.resolve(n)}getOverlaysForCollectionGroup(e,t,r,n){let i=new h5((e,t)=>e-t),s=this.overlays.getIterator();for(;s.hasNext();){let e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>r){let t=i.get(e.largestBatchId);null===t&&(t=dC(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}let a=dC(),o=i.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach((e,t)=>a.set(e,t)),!(a.size()>=n)););return uB.resolve(a)}bt(e,t,r){let n=this.overlays.get(r.key);if(null!==n){let e=this.Lr.get(n.largestBatchId).delete(r.key);this.Lr.set(n.largestBatchId,e)}this.overlays=this.overlays.insert(r.key,new d9(t,r));let i=this.Lr.get(t);void 0===i&&(i=dN(),this.Lr.set(t,i)),this.Lr.set(t,i.add(r.key))}}class pY{constructor(){this.sessionToken=ct.EMPTY_BYTE_STRING}getSessionToken(e){return uB.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,uB.resolve()}}class pX{constructor(){this.kr=new h4(pZ.Kr),this.qr=new h4(pZ.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){let r=new pZ(e,t);this.kr=this.kr.add(r),this.qr=this.qr.add(r)}$r(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Wr(new pZ(e,t))}Qr(e,t){e.forEach(e=>this.removeReference(e,t))}Gr(e){let t=new ug(new uf([])),r=new pZ(t,e),n=new pZ(t,e+1),i=[];return this.qr.forEachInRange([r,n],e=>{this.Wr(e),i.push(e.key)}),i}zr(){this.kr.forEach(e=>this.Wr(e))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){let t=new ug(new uf([])),r=new pZ(t,e),n=new pZ(t,e+1),i=dN();return this.qr.forEachInRange([r,n],e=>{i=i.add(e.key)}),i}containsKey(e){let t=new pZ(e,0),r=this.kr.firstAfterOrEqual(t);return null!==r&&e.isEqual(r.key)}}class pZ{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return ug.comparator(e.key,t.key)||uo(e.Hr,t.Hr)}static Ur(e,t){return uo(e.Hr,t.Hr)||ug.comparator(e.key,t.key)}}class p0{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new h4(pZ.Kr)}checkEmpty(e){return uB.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,r,n){let i=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let s=new d8(i,t,r,n);for(let t of(this.mutationQueue.push(s),n))this.Jr=this.Jr.add(new pZ(t.key,i)),this.indexManager.addToCollectionParentIndex(e,t.key.path.popLast());return uB.resolve(s)}lookupMutationBatch(e,t){return uB.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){let r=this.Xr(t+1),n=r<0?0:r;return uB.resolve(this.mutationQueue.length>n?this.mutationQueue[n]:null)}getHighestUnacknowledgedBatchId(){return uB.resolve(0===this.mutationQueue.length?-1:this.Yn-1)}getAllMutationBatches(e){return uB.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new pZ(t,0),n=new pZ(t,1/0),i=[];return this.Jr.forEachInRange([r,n],e=>{let t=this.Zr(e.Hr);i.push(t)}),uB.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new h4(uo);return t.forEach(e=>{let t=new pZ(e,0),n=new pZ(e,1/0);this.Jr.forEachInRange([t,n],e=>{r=r.add(e.Hr)})}),uB.resolve(this.Yr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,n=r.length+1,i=r;ug.isDocumentKey(i)||(i=i.child(""));let s=new pZ(new ug(i),0),a=new h4(uo);return this.Jr.forEachWhile(e=>{let t=e.key.path;return!!r.isPrefixOf(t)&&(t.length===n&&(a=a.add(e.Hr)),!0)},s),uB.resolve(this.Yr(a))}Yr(e){let t=[];return e.forEach(e=>{let r=this.Zr(e);null!==r&&t.push(r)}),t}removeMutationBatch(e,t){l6(0===this.ei(t.batchId,"removed"),55003),this.mutationQueue.shift();let r=this.Jr;return uB.forEach(t.mutations,n=>{let i=new pZ(n.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,n.key)}).next(()=>{this.Jr=r})}nr(e){}containsKey(e,t){let r=new pZ(t,0),n=this.Jr.firstAfterOrEqual(r);return uB.resolve(t.isEqual(n&&n.key))}performConsistencyCheck(e){return this.mutationQueue.length,uB.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Zr(e){let t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class p1{constructor(e){this.ti=e,this.docs=new h5(ug.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,n=this.docs.get(r),i=n?n.size:0,s=this.ti(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return uB.resolve(r?r.document.mutableCopy():cz.newInvalidDocument(t))}getEntries(e,t){let r=dE;return t.forEach(e=>{let t=this.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():cz.newInvalidDocument(e))}),uB.resolve(r)}getDocumentsMatchingQuery(e,t,r,n){let i=dE,s=t.path,a=new ug(s.child("__id-9223372036854775808__")),o=this.docs.getIteratorFrom(a);for(;o.hasNext();){let{key:e,value:{document:a}}=o.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||0>=uV(uO(a),r)||(n.has(a.key)||db(t,a))&&(i=i.insert(a.key,a.mutableCopy()))}return uB.resolve(i)}getAllFromCollectionGroup(e,t,r,n){l2(9500)}ni(e,t){return uB.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new p2(this)}getSize(e){return uB.resolve(this.size)}}class p2 extends pB{constructor(e){super(),this.Mr=e}applyChanges(e){let t=[];return this.changes.forEach((r,n)=>{n.isValidDocument()?t.push(this.Mr.addEntry(e,n)):this.Mr.removeEntry(r)}),uB.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class p5{constructor(e){this.persistence=e,this.ri=new dT(e=>dt(e),dr),this.lastRemoteSnapshotVersion=uk.min(),this.highestTargetId=0,this.ii=0,this.si=new pX,this.targetCount=0,this.oi=pN._r()}forEachTarget(e,t){return this.ri.forEach((e,r)=>t(r)),uB.resolve()}getLastRemoteSnapshotVersion(e){return uB.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return uB.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),uB.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.ii&&(this.ii=t),uB.resolve()}lr(e){this.ri.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.oi=new pN(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,uB.resolve()}updateTargetData(e,t){return this.lr(t),uB.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,uB.resolve()}removeTargets(e,t,r){let n=0,i=[];return this.ri.forEach((s,a)=>{a.sequenceNumber<=t&&null===r.get(a.targetId)&&(this.ri.delete(s),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),n++)}),uB.waitFor(i).next(()=>n)}getTargetCount(e){return uB.resolve(this.targetCount)}getTargetData(e,t){let r=this.ri.get(t)||null;return uB.resolve(r)}addMatchingKeys(e,t,r){return this.si.$r(t,r),uB.resolve()}removeMatchingKeys(e,t,r){this.si.Qr(t,r);let n=this.persistence.referenceDelegate,i=[];return n&&t.forEach(t=>{i.push(n.markPotentiallyOrphaned(e,t))}),uB.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),uB.resolve()}getMatchingKeysForTargetId(e,t){let r=this.si.jr(t);return uB.resolve(r)}containsKey(e,t){return uB.resolve(this.si.containsKey(t))}}class p6{constructor(e,t){this._i={},this.overlays={},this.ai=new u2(0),this.ui=!1,this.ui=!0,this.ci=new pY,this.referenceDelegate=e(this),this.li=new p5(this),this.indexManager=new pv,this.remoteDocumentCache=new p1(e=>this.referenceDelegate.hi(e)),this.serializer=new fQ(t),this.Pi=new pQ(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new pJ,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this._i[e.toKey()];return r||(r=new p0(t,this.referenceDelegate),this._i[e.toKey()]=r),r}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,r){lX("MemoryPersistence","Starting transaction:",e);let n=new p3(this.ai.next());return this.referenceDelegate.Ti(),r(n).next(e=>this.referenceDelegate.Ii(n).next(()=>e)).toPromise().then(e=>(n.raiseOnCommittedEvent(),e))}Ei(e,t){return uB.or(Object.values(this._i).map(r=>()=>r.containsKey(e,t)))}}class p3 extends uj{constructor(e){super(),this.currentSequenceNumber=e}}class p4{constructor(e){this.persistence=e,this.Ri=new pX,this.Ai=null}static Vi(e){return new p4(e)}get di(){if(this.Ai)return this.Ai;throw l2(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.di.delete(r.toString()),uB.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.di.add(r.toString()),uB.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),uB.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach(e=>this.di.add(e.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.di.add(e.toString()))}).next(()=>r.removeTargetData(e,t))}Ti(){this.Ai=new Set}Ii(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return uB.forEach(this.di,r=>{let n=ug.fromPath(r);return this.mi(e,n).next(e=>{e||t.removeEntry(n,uk.min())})}).next(()=>(this.Ai=null,t.apply(e)))}updateLimboDocument(e,t){return this.mi(e,t).next(e=>{e?this.di.delete(t.toString()):this.di.add(t.toString())})}hi(e){return 0}mi(e,t){return uB.or([()=>uB.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class p8{constructor(e,t){this.persistence=e,this.fi=new dT(e=>u4(e.path),(e,t)=>e.isEqual(t)),this.garbageCollector=new pF(this,t)}static Vi(e,t){return new p8(e,t)}Ti(){}Ii(e){return uB.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){let t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}pr(e){let t=0;return this.mr(e,e=>{t++}).next(()=>t)}mr(e,t){return uB.forEach(this.fi,(r,n)=>this.wr(e,r,n).next(e=>e?uB.resolve():t(n)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,n=this.persistence.getRemoteDocumentCache(),i=n.newChangeBuffer();return n.ni(e,n=>this.wr(e,n,t).next(e=>{e||(r++,i.removeEntry(n,uk.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),uB.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.fi.set(r,e.currentSequenceNumber),uB.resolve()}removeReference(e,t,r){return this.fi.set(r,e.currentSequenceNumber),uB.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),uB.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=function e(t){switch(cI(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let r=cc(t);return r?16+e(r):16;case 5:return 2*t.stringValue.length;case 6:return cs(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(t.arrayValue.values||[]).reduce((t,r)=>t+e(r),0);case 10:case 11:var n;let i;return n=t.mapValue,i=0,h1(n.fields,(t,r)=>{i+=t.length+e(r)}),i;default:throw l2(13486,{value:t})}}(e.data.value)),t}wr(e,t,r){return uB.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let e=this.fi.get(t);return uB.resolve(void 0!==e&&e>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class p7{constructor(e){this.serializer=e}k(e,t,r,n){let i=new uq("createOrUpgrade",t);r<1&&n>=1&&(e.createObjectStore(u9),e.createObjectStore(ht,{keyPath:"userId"}),e.createObjectStore(hr,{keyPath:hn,autoIncrement:!0}).createIndex(hi,hs,{unique:!0}),e.createObjectStore(ho),p9(e),e.createObjectStore(u7));let s=uB.resolve();return r<3&&n>=3&&(0!==r&&(e.deleteObjectStore(hw),e.deleteObjectStore(hg),e.deleteObjectStore(hE),p9(e)),s=s.next(()=>{let e,t;return e=i.store(hE),t={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:uk.min().toTimestamp(),targetCount:0},e.put(hT,t)})),r<4&&n>=4&&(0!==r&&(s=s.next(()=>i.store(hr).H().next(t=>{e.deleteObjectStore(hr),e.createObjectStore(hr,{keyPath:hn,autoIncrement:!0}).createIndex(hi,hs,{unique:!0});let r=i.store(hr),n=t.map(e=>r.put(e));return uB.waitFor(n)}))),s=s.next(()=>{e.createObjectStore(hk,{keyPath:"clientId"})})),r<5&&n>=5&&(s=s.next(()=>this.gi(i))),r<6&&n>=6&&(s=s.next(()=>(e.createObjectStore(hp),this.pi(i)))),r<7&&n>=7&&(s=s.next(()=>this.yi(i))),r<8&&n>=8&&(s=s.next(()=>this.wi(e,i))),r<9&&n>=9&&(s=s.next(()=>{e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")})),r<10&&n>=10&&(s=s.next(()=>this.bi(i))),r<11&&n>=11&&(s=s.next(()=>{e.createObjectStore(hC,{keyPath:"bundleId"}),e.createObjectStore(hA,{keyPath:"name"})})),r<12&&n>=12&&(s=s.next(()=>{let t;(t=e.createObjectStore(hU,{keyPath:hB})).createIndex(hz,hq,{unique:!1}),t.createIndex(h$,hG,{unique:!1})})),r<13&&n>=13&&(s=s.next(()=>{let t;(t=e.createObjectStore(hl,{keyPath:hu})).createIndex(hh,hc),t.createIndex(hd,hf)}).next(()=>this.Si(e,i)).next(()=>e.deleteObjectStore(u7))),r<14&&n>=14&&(s=s.next(()=>this.Di(e,i))),r<15&&n>=15&&(s=s.next(()=>{e.createObjectStore(hD,{keyPath:"indexId",autoIncrement:!0}).createIndex(hN,"collectionGroup",{unique:!1}),e.createObjectStore(hP,{keyPath:hR}).createIndex(hM,hO,{unique:!1}),e.createObjectStore(hL,{keyPath:hV}).createIndex(hF,hj,{unique:!1})})),r<16&&n>=16&&(s=s.next(()=>{t.objectStore(hP).clear()}).next(()=>{t.objectStore(hL).clear()})),r<17&&n>=17&&(s=s.next(()=>{e.createObjectStore(hK,{keyPath:"name"})})),r<18&&n>=18&&ok()&&(s=s.next(()=>{t.objectStore(hP).clear()}).next(()=>{t.objectStore(hL).clear()})),s}pi(e){let t=0;return e.store(u7).ee((e,r)=>{t+=pk(r)}).next(()=>{let r={byteSize:t};return e.store(hp).put(hm,r)})}gi(e){let t=e.store(ht),r=e.store(hr);return t.H().next(t=>uB.forEach(t,t=>{let n=IDBKeyRange.bound([t.userId,-1],[t.userId,t.lastAcknowledgedBatchId]);return r.H(hi,n).next(r=>uB.forEach(r,r=>{l6(r.userId===t.userId,18650,"Cannot process batch from unexpected user",{batchId:r.batchId});let n=f0(this.serializer,r);return p_(e,t.userId,n).next(()=>{})}))}))}yi(e){let t=e.store(hw),r=e.store(u7);return e.store(hE).get(hT).next(e=>{let n=[];return r.ee((r,i)=>{let s=new uf(r),a=[0,u4(s)];n.push(t.get(a).next(r=>r?uB.resolve():t.put({targetId:0,path:u4(s),sequenceNumber:e.highestListenSequenceNumber})))}).next(()=>uB.waitFor(n))})}wi(e,t){e.createObjectStore(hS,{keyPath:h_});let r=t.store(hS),n=new pw,i=e=>{if(n.add(e)){let t=e.lastSegment(),n=e.popLast();return r.put({collectionId:t,parent:u4(n)})}};return t.store(u7).ee({Y:!0},(e,t)=>i(new uf(e).popLast())).next(()=>t.store(ho).ee({Y:!0},([e,t,r],n)=>i(u8(t).popLast())))}bi(e){let t=e.store(hg);return t.ee((e,r)=>{let n=f1(r),i=f2(this.serializer,n);return t.put(i)})}Si(e,t){let r=t.store(u7),n=[];return r.ee((e,r)=>{let i=t.store(hl),s=(r.document?new ug(uf.fromString(r.document.name).popFirst(5)):r.noDocument?ug.fromSegments(r.noDocument.path):r.unknownDocument?ug.fromSegments(r.unknownDocument.path):l2(36783)).path.toArray(),a={prefixPath:s.slice(0,s.length-2),collectionGroup:s[s.length-2],documentId:s[s.length-1],readTime:r.readTime||[0,0],unknownDocument:r.unknownDocument,noDocument:r.noDocument,document:r.document,hasCommittedMutations:!!r.hasCommittedMutations};n.push(i.put(a))}).next(()=>uB.waitFor(n))}Di(e,t){let r=t.store(hr),n=new pz(this.serializer),i=new p6(p4.Vi,this.serializer.yt);return r.H().next(e=>{let r=new Map;return e.forEach(e=>{let t=r.get(e.userId)??dN();f0(this.serializer,e).keys().forEach(e=>t=t.add(e)),r.set(e.userId,t)}),uB.forEach(r,(e,r)=>{let s=new lW(r),a=f7.wt(this.serializer,s),o=i.getIndexManager(s);return new pW(n,pC.wt(s,this.serializer,o,i.referenceDelegate),a,o).recalculateAndSaveOverlaysForDocumentKeys(new hX(t,u2.ce),e).next()})})}}function p9(e){e.createObjectStore(hw,{keyPath:hb}).createIndex(hx,hI,{unique:!0}),e.createObjectStore(hg,{keyPath:"targetId"}).createIndex(hy,hv,{unique:!0}),e.createObjectStore(hE)}let me="IndexedDbPersistence",mt="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class mr{constructor(e,t,r,n,i,s,a,o,l,u,h=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Ci=i,this.window=s,this.document=a,this.Fi=l,this.Mi=u,this.xi=h,this.ai=null,this.ui=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Oi=null,this.inForeground=!1,this.Ni=null,this.Bi=null,this.Li=-1/0,this.ki=e=>Promise.resolve(),!mr.v())throw new l4(l3.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new pj(this,n),this.Ki=t+"main",this.serializer=new fQ(o),this.qi=new u$(this.Ki,this.xi,new p7(this.serializer)),this.ci=new f9,this.li=new pP(this.referenceDelegate,this.serializer),this.remoteDocumentCache=new pz(this.serializer),this.Pi=new f8,this.window&&this.window.localStorage?this.Ui=this.window.localStorage:(this.Ui=null,!1===u&&lZ(me,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.$i().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new l4(l3.FAILED_PRECONDITION,mt);return this.Wi(),this.Qi(),this.Gi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.li.getHighestSequenceNumber(e))}).then(e=>{this.ai=new u2(e,this.Fi)}).then(()=>{this.ui=!0}).catch(e=>(this.qi&&this.qi.close(),Promise.reject(e)))}zi(e){return this.ki=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.qi.q(async t=>{null===t.newVersion&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ci.enqueueAndForget(async()=>{this.started&&await this.$i()}))}$i(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>hZ(e,hk).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.ji(e).next(e=>{e||(this.isPrimary=!1,this.Ci.enqueueRetryable(()=>this.ki(!1)))})}).next(()=>this.Hi(e)).next(t=>this.isPrimary&&!t?this.Ji(e).next(()=>!1):!!t&&this.Zi(e).next(()=>!0))).catch(e=>{if(uW(e))return lX(me,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return lX(me,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Ci.enqueueRetryable(()=>this.ki(e)),this.isPrimary=e})}ji(e){return hZ(e,u9).get(he).next(e=>uB.resolve(this.Xi(e)))}Yi(e){return hZ(e,hk).delete(this.clientId)}async es(){if(this.isPrimary&&!this.ts(this.Li,18e5)){this.Li=Date.now();let e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",e=>{let t=hZ(e,hk);return t.H().next(e=>{let r=this.ns(e,18e5),n=e.filter(e=>-1===r.indexOf(e));return uB.forEach(n,e=>t.delete(e.clientId)).next(()=>n)})}).catch(()=>[]);if(this.Ui)for(let t of e)this.Ui.removeItem(this.rs(t.clientId))}}Gi(){this.Bi=this.Ci.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.$i().then(()=>this.es()).then(()=>this.Gi()))}Xi(e){return!!e&&e.ownerId===this.clientId}Hi(e){return this.Mi?uB.resolve(!0):hZ(e,u9).get(he).next(t=>{if(null!==t&&this.ts(t.leaseTimestampMs,5e3)&&!this.ss(t.ownerId)){if(this.Xi(t)&&this.networkEnabled)return!0;if(!this.Xi(t)){if(!t.allowTabSynchronization)throw new l4(l3.FAILED_PRECONDITION,mt);return!1}}return!(!this.networkEnabled||!this.inForeground)||hZ(e,hk).H().next(e=>void 0===this.ns(e,5e3).find(e=>{if(this.clientId!==e.clientId){let t=!this.networkEnabled&&e.networkEnabled,r=!this.inForeground&&e.inForeground,n=this.networkEnabled===e.networkEnabled;if(t||r&&n)return!0}return!1}))}).next(e=>(this.isPrimary!==e&&lX(me,`Client ${e?"is":"is not"} eligible for a primary lease.`),e))}async shutdown(){this.ui=!1,this._s(),this.Bi&&(this.Bi.cancel(),this.Bi=null),this.us(),this.cs(),await this.qi.runTransaction("shutdown","readwrite",[u9,hk],e=>{let t=new hX(e,u2.ce);return this.Ji(t).next(()=>this.Yi(t))}),this.qi.close(),this.ls()}ns(e,t){return e.filter(e=>this.ts(e.updateTimeMs,t)&&!this.ss(e.clientId))}hs(){return this.runTransaction("getActiveClients","readonly",e=>hZ(e,hk).H().next(e=>this.ns(e,18e5).map(e=>e.clientId)))}get started(){return this.ui}getGlobalsCache(){return this.ci}getMutationQueue(e,t){return pC.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new pI(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return f7.wt(this.serializer,e)}getBundleCache(){return this.Pi}runTransaction(e,t,r){var n;let i;lX(me,"Starting transaction:",e);let s=18===(n=this.xi)||17===n?hY:16===n||15===n?hJ:14===n||13===n?hQ:12===n?hW:11===n?hH:void l2(60245);return this.qi.runTransaction(e,"readonly"===t?"readonly":"readwrite",s,n=>(i=new hX(n,this.ai?this.ai.next():u2.ce),"readwrite-primary"===t?this.ji(i).next(e=>!!e||this.Hi(i)).next(t=>{if(!t)throw lZ(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ci.enqueueRetryable(()=>this.ki(!1)),new l4(l3.FAILED_PRECONDITION,uF);return r(i)}).next(e=>this.Zi(i).next(()=>e)):this.Ps(i).next(()=>r(i)))).then(e=>(i.raiseOnCommittedEvent(),e))}Ps(e){return hZ(e,u9).get(he).next(e=>{if(null!==e&&this.ts(e.leaseTimestampMs,5e3)&&!this.ss(e.ownerId)&&!this.Xi(e)&&!(this.Mi||this.allowTabSynchronization&&e.allowTabSynchronization))throw new l4(l3.FAILED_PRECONDITION,mt)})}Zi(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return hZ(e,u9).put(he,t)}static v(){return u$.v()}Ji(e){let t=hZ(e,u9);return t.get(he).next(e=>this.Xi(e)?(lX(me,"Releasing primary lease."),t.delete(he)):uB.resolve())}ts(e,t){let r=Date.now();return!(e<r-t)&&(!(e>r)||(lZ(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Wi(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ni=()=>{this.Ci.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.$i()))},this.document.addEventListener("visibilitychange",this.Ni),this.inForeground="visible"===this.document.visibilityState)}us(){this.Ni&&(this.document.removeEventListener("visibilitychange",this.Ni),this.Ni=null)}Qi(){"function"==typeof this.window?.addEventListener&&(this.Oi=()=>{this._s();let e=/(?:Version|Mobile)\/1[456]/;o_()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Ci.enterRestrictedMode(!0),this.Ci.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Oi))}cs(){this.Oi&&(this.window.removeEventListener("pagehide",this.Oi),this.Oi=null)}ss(e){try{let t=null!==this.Ui?.getItem(this.rs(e));return lX(me,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(e){return lZ(me,"Failed to get zombied client id.",e),!1}}_s(){if(this.Ui)try{this.Ui.setItem(this.rs(this.clientId),String(Date.now()))}catch(e){lZ("Failed to set zombie client id.",e)}}ls(){if(this.Ui)try{this.Ui.removeItem(this.rs(this.clientId))}catch(e){}}rs(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function mn(e,t){let r=e.projectId;return e.isDefaultDatabase||(r+="."+e.database),"firestore/"+t+"/"+r+"/"}class mi{constructor(e,t,r,n){this.targetId=e,this.fromCache=t,this.Ts=r,this.Is=n}static Es(e,t){let r=dN(),n=dN();for(let e of t.docChanges)switch(e.type){case 0:r=r.add(e.doc.key);break;case 1:n=n.add(e.doc.key)}return new mi(e,t.fromCache,r,n)}}class ms{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class ma{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=o_()?8:uG(oI())>0?6:4}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,n){let i={result:null};return this.gs(e,t).next(e=>{i.result=e}).next(()=>{if(!i.result)return this.ps(e,t,n,r).next(e=>{i.result=e})}).next(()=>{if(i.result)return;let r=new ms;return this.ys(e,t,r).next(n=>{if(i.result=n,this.As)return this.ws(e,t,r,n.size)})}).next(()=>i.result)}ws(e,t,r,n){return r.documentReadCount<this.Vs?(lY()<=p.DEBUG&&lX("QueryEngine","SDK will not create cache indexes for query:",dw(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),uB.resolve()):(lY()<=p.DEBUG&&lX("QueryEngine","Query:",dw(t),"scans",r.documentReadCount,"local documents and returns",n,"documents as results."),r.documentReadCount>this.ds*n?(lY()<=p.DEBUG&&lX("QueryEngine","The SDK decides to create cache indexes for query:",dw(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,df(t))):uB.resolve())}gs(e,t){if(dh(t))return uB.resolve(null);let r=df(t);return this.indexManager.getIndexType(e,r).next(n=>0===n?null:(null!==t.limit&&1===n&&(r=df(t=dg(t,null,"F"))),this.indexManager.getDocumentsMatchingTarget(e,r).next(n=>{let i=dN(...n);return this.fs.getDocuments(e,i).next(n=>this.indexManager.getMinOffset(e,r).next(r=>{let s=this.bs(t,n);return this.Ss(t,s,i,r.readTime)?this.gs(e,dg(t,null,"F")):this.Ds(e,s,t,r)}))})))}ps(e,t,r,n){return dh(t)||n.isEqual(uk.min())?uB.resolve(null):this.fs.getDocuments(e,r).next(i=>{let s=this.bs(t,i);return this.Ss(t,s,r,n)?uB.resolve(null):(lY()<=p.DEBUG&&lX("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),dw(t)),this.Ds(e,s,t,uM(n,-1)).next(e=>e))})}bs(e,t){let r=new h4(dI(e));return t.forEach((t,n)=>{db(e,n)&&(r=r.add(n))}),r}Ss(e,t,r,n){if(null===e.limit)return!1;if(r.size!==t.size)return!0;let i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(n)>0)}ys(e,t,r){return lY()<=p.DEBUG&&lX("QueryEngine","Using full collection scan to execute query:",dw(t)),this.fs.getDocumentsMatchingQuery(e,t,uL.min(),r)}Ds(e,t,r,n){return this.fs.getDocumentsMatchingQuery(e,r,n).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}let mo="LocalStore";class ml{constructor(e,t,r,n){this.persistence=e,this.Cs=t,this.serializer=n,this.vs=new h5(uo),this.Fs=new dT(e=>dt(e),dr),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(r)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new pW(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.vs))}}async function mu(e,t){return await e.persistence.runTransaction("Handle user change","readonly",r=>{let n;return e.mutationQueue.getAllMutationBatches(r).next(i=>(n=i,e.Os(t),e.mutationQueue.getAllMutationBatches(r))).next(t=>{let i=[],s=[],a=dN();for(let e of n)for(let t of(i.push(e.batchId),e.mutations))a=a.add(t.key);for(let e of t)for(let t of(s.push(e.batchId),e.mutations))a=a.add(t.key);return e.localDocuments.getDocuments(r,a).next(e=>({Ns:e,removedBatchIds:i,addedBatchIds:s}))})})}function mh(e){return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.li.getLastRemoteSnapshotVersion(t))}function mc(e,t,r){let n=dN(),i=dN();return r.forEach(e=>n=n.add(e)),t.getEntries(e,n).next(e=>{let n=dE;return r.forEach((r,s)=>{let a=e.get(r);s.isFoundDocument()!==a.isFoundDocument()&&(i=i.add(r)),s.isNoDocument()&&s.version.isEqual(uk.min())?(t.removeEntry(r,s.readTime),n=n.insert(r,s)):!a.isValidDocument()||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(t.addEntry(s),n=n.insert(r,s)):lX(mo,"Ignoring outdated watch update for ",r,". Current version:",a.version," Watch version:",s.version)}),{Bs:n,Ls:i}})}function md(e,t){return e.persistence.runTransaction("Allocate target","readwrite",r=>{let n;return e.li.getTargetData(r,t).next(i=>i?(n=i,uB.resolve(n)):e.li.allocateTargetId(r).next(i=>(n=new fW(t,i,"TargetPurposeListen",r.currentSequenceNumber),e.li.addTargetData(r,n).next(()=>n))))}).then(r=>{let n=e.vs.get(r.targetId);return(null===n||r.snapshotVersion.compareTo(n.snapshotVersion)>0)&&(e.vs=e.vs.insert(r.targetId,r),e.Fs.set(t,r.targetId)),r})}async function mf(e,t,r){let n=e.vs.get(t);try{r||await e.persistence.runTransaction("Release target",r?"readwrite":"readwrite-primary",t=>e.persistence.referenceDelegate.removeTarget(t,n))}catch(e){if(!uW(e))throw e;lX(mo,`Failed to update sequence numbers for target ${t}: ${e}`)}e.vs=e.vs.remove(t),e.Fs.delete(n.target)}function mp(e,t,r){let n=uk.min(),i=dN();return e.persistence.runTransaction("Execute query","readwrite",s=>{var a;let o;return(a=df(t),void 0!==(o=e.Fs.get(a))?uB.resolve(e.vs.get(o)):e.li.getTargetData(s,a)).next(t=>{if(t)return n=t.lastLimboFreeSnapshotVersion,e.li.getMatchingKeysForTargetId(s,t.targetId).next(e=>{i=e})}).next(()=>e.Cs.getDocumentsMatchingQuery(s,t,r?n:uk.min(),r?i:dN())).next(r=>(my(e,dx(t),r),{documents:r,ks:i}))})}function mm(e,t){let r=e.li,n=e.vs.get(t);return n?Promise.resolve(n.target):e.persistence.runTransaction("Get target data","readonly",e=>r.At(e,t).next(e=>e?e.target:null))}function mg(e,t){let r=e.Ms.get(t)||uk.min();return e.persistence.runTransaction("Get new document changes","readonly",n=>e.xs.getAllFromCollectionGroup(n,t,uM(r,-1),Number.MAX_SAFE_INTEGER)).then(r=>(my(e,t,r),r))}function my(e,t,r){let n=e.Ms.get(t)||uk.min();r.forEach((e,t)=>{t.readTime.compareTo(n)>0&&(n=t.readTime)}),e.Ms.set(t,n)}async function mv(e,t,r,n){let i=dN(),s=dE;for(let e of r){let r=t.Ks(e.metadata.name);e.document&&(i=i.add(r));let n=t.qs(e);n.setReadTime(t.Us(e.metadata.readTime)),s=s.insert(r,n)}let a=e.xs.newChangeBuffer({trackRemovals:!0}),o=await md(e,df(du(uf.fromString(`__bundle__/docs/${n}`))));return e.persistence.runTransaction("Apply bundle documents","readwrite",t=>mc(t,a,s).next(e=>(a.apply(t),e)).next(r=>e.li.removeMatchingKeysForTargetId(t,o.targetId).next(()=>e.li.addMatchingKeys(t,i,o.targetId)).next(()=>e.localDocuments.getLocalViewOfDocuments(t,r.Bs,r.Ls)).next(()=>r.Bs)))}async function mw(e,t,r=dN()){let n=await md(e,df(f5(t.bundledQuery)));return e.persistence.runTransaction("Save named query","readwrite",i=>{let s=fk(t.readTime);if(n.snapshotVersion.compareTo(s)>=0)return e.Pi.saveNamedQuery(i,t);let a=n.withResumeToken(ct.EMPTY_BYTE_STRING,s);return e.vs=e.vs.insert(a.targetId,a),e.li.updateTargetData(i,a).next(()=>e.li.removeMatchingKeysForTargetId(i,n.targetId)).next(()=>e.li.addMatchingKeys(i,r,n.targetId)).next(()=>e.Pi.saveNamedQuery(i,t))})}let mb="firestore_clients";function mx(e,t){return`${mb}_${e}_${t}`}let mI="firestore_mutations";function mT(e,t,r){let n=`${mI}_${e}_${r}`;return t.isAuthenticated()&&(n+=`_${t.uid}`),n}let mE="firestore_targets";function mS(e,t){return`${mE}_${e}_${t}`}let m_="SharedClientState";class mk{constructor(e,t,r,n){this.user=e,this.batchId=t,this.state=r,this.error=n}static $s(e,t,r){let n=JSON.parse(r),i,s="object"==typeof n&&-1!==["pending","acknowledged","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error);return s&&n.error&&(s="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new l4(n.error.code,n.error.message)),s?new mk(e,t,n.state,i):(lZ(m_,`Failed to parse mutation state for ID '${t}': ${r}`),null)}Ws(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class mC{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static $s(e,t){let r=JSON.parse(t),n,i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(n=new l4(r.error.code,r.error.message)),i?new mC(e,r.state,n):(lZ(m_,`Failed to parse target state for ID '${e}': ${t}`),null)}Ws(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class mA{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static $s(e,t){let r=JSON.parse(t),n="object"==typeof r&&r.activeTargetIds instanceof Array,i=dP;for(let e=0;n&&e<r.activeTargetIds.length;++e)n=u3(r.activeTargetIds[e]),i=i.add(r.activeTargetIds[e]);return n?new mA(e,i):(lZ(m_,`Failed to parse client data for instance '${e}': ${t}`),null)}}class mD{constructor(e,t){this.clientId=e,this.onlineState=t}static $s(e){let t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new mD(t.clientId,t.onlineState):(lZ(m_,`Failed to parse online state: ${e}`),null)}}class mN{constructor(){this.activeTargetIds=dP}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){return JSON.stringify({activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()})}}class mP{constructor(e,t,r,n,i){var s,a,o;this.window=e,this.Ci=t,this.persistenceKey=r,this.zs=n,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.js=this.Hs.bind(this),this.Js=new h5(uo),this.started=!1,this.Zs=[];const l=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Xs=mx(this.persistenceKey,this.zs),this.Ys=(s=this.persistenceKey,`firestore_sequence_number_${s}`),this.Js=this.Js.insert(this.zs,new mN),this.eo=RegExp(`^${mb}_${l}_([^_]*)$`),this.no=RegExp(`^${mI}_${l}_(\\d+)(?:_(.*))?$`),this.ro=RegExp(`^${mE}_${l}_(\\d+)$`),this.io=(a=this.persistenceKey,`firestore_online_state_${a}`),this.so=(o=this.persistenceKey,`firestore_bundle_loaded_v2_${o}`),this.window.addEventListener("storage",this.js)}static v(e){return!(!e||!e.localStorage)}async start(){for(let e of(await this.syncEngine.hs())){if(e===this.zs)continue;let t=this.getItem(mx(this.persistenceKey,e));if(t){let r=mA.$s(e,t);r&&(this.Js=this.Js.insert(r.clientId,r))}}this.oo();let e=this.storage.getItem(this.io);if(e){let t=this._o(e);t&&this.ao(t)}for(let e of this.Zs)this.Hs(e);this.Zs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ys,JSON.stringify(e))}getAllActiveQueryTargets(){return this.uo(this.Js)}isActiveQueryTarget(e){let t=!1;return this.Js.forEach((r,n)=>{n.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.co(e,"pending")}updateMutationState(e,t,r){this.co(e,t,r),this.lo(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){let t=this.storage.getItem(mS(this.persistenceKey,e));if(t){let n=mC.$s(e,t);n&&(r=n.state)}}return t&&this.ho.Qs(e),this.oo(),r}removeLocalQueryTarget(e){this.ho.Gs(e),this.oo()}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(mS(this.persistenceKey,e))}updateQueryState(e,t,r){this.Po(e,t,r)}handleUserChange(e,t,r){t.forEach(e=>{this.lo(e)}),this.currentUser=e,r.forEach(e=>{this.addPendingMutation(e)})}setOnlineState(e){this.To(e)}notifyBundleLoaded(e){this.Io(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.js),this.removeItem(this.Xs),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return lX(m_,"READ",e,t),t}setItem(e,t){lX(m_,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){lX(m_,"REMOVE",e),this.storage.removeItem(e)}Hs(e){if(e.storageArea===this.storage){if(lX(m_,"EVENT",e.key,e.newValue),e.key===this.Xs)return void lZ("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ci.enqueueRetryable(async()=>{if(this.started){if(null!==e.key){if(this.eo.test(e.key)){if(null==e.newValue){let t=this.Eo(e.key);return this.Ro(t,null)}{let t=this.Ao(e.key,e.newValue);if(t)return this.Ro(t.clientId,t)}}else if(this.no.test(e.key)){if(null!==e.newValue){let t=this.Vo(e.key,e.newValue);if(t)return this.mo(t)}}else if(this.ro.test(e.key)){if(null!==e.newValue){let t=this.fo(e.key,e.newValue);if(t)return this.po(t)}}else if(e.key===this.io){if(null!==e.newValue){let t=this._o(e.newValue);if(t)return this.ao(t)}}else if(e.key===this.Ys){let t=function(e){let t=u2.ce;if(null!=e)try{let r=JSON.parse(e);l6("number"==typeof r,30636,{yo:e}),t=r}catch(e){lZ(m_,"Failed to read sequence number from WebStorage",e)}return t}(e.newValue);t!==u2.ce&&this.sequenceNumberHandler(t)}else if(e.key===this.so){let t=this.wo(e.newValue);await Promise.all(t.map(e=>this.syncEngine.bo(e)))}}}else this.Zs.push(e)})}}get ho(){return this.Js.get(this.zs)}oo(){this.setItem(this.Xs,this.ho.Ws())}co(e,t,r){let n=new mk(this.currentUser,e,t,r),i=mT(this.persistenceKey,this.currentUser,e);this.setItem(i,n.Ws())}lo(e){let t=mT(this.persistenceKey,this.currentUser,e);this.removeItem(t)}To(e){let t={clientId:this.zs,onlineState:e};this.storage.setItem(this.io,JSON.stringify(t))}Po(e,t,r){let n=mS(this.persistenceKey,e),i=new mC(e,t,r);this.setItem(n,i.Ws())}Io(e){let t=JSON.stringify(Array.from(e));this.setItem(this.so,t)}Eo(e){let t=this.eo.exec(e);return t?t[1]:null}Ao(e,t){let r=this.Eo(e);return mA.$s(r,t)}Vo(e,t){let r=this.no.exec(e),n=Number(r[1]),i=void 0!==r[2]?r[2]:null;return mk.$s(new lW(i),n,t)}fo(e,t){let r=Number(this.ro.exec(e)[1]);return mC.$s(r,t)}_o(e){return mD.$s(e)}wo(e){return JSON.parse(e)}async mo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.So(e.batchId,e.state,e.error);lX(m_,`Ignoring mutation for non-active user ${e.user.uid}`)}po(e){return this.syncEngine.Do(e.targetId,e.state,e.error)}Ro(e,t){let r=t?this.Js.insert(e,t):this.Js.remove(e),n=this.uo(this.Js),i=this.uo(r),s=[],a=[];return i.forEach(e=>{n.has(e)||s.push(e)}),n.forEach(e=>{i.has(e)||a.push(e)}),this.syncEngine.Co(s,a).then(()=>{this.Js=r})}ao(e){this.Js.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}uo(e){let t=dP;return e.forEach((e,r)=>{t=t.unionWith(r.activeTargetIds)}),t}}class mR{constructor(){this.vo=new mN,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,r){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new mN,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class mM{Mo(e){}shutdown(){}}let mO="ConnectivityMonitor";class mL{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){for(let e of(lX(mO,"Network connectivity changed: AVAILABLE"),this.Lo))e(0)}Bo(){for(let e of(lX(mO,"Network connectivity changed: UNAVAILABLE"),this.Lo))e(1)}static v(){return"u">typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let mV=null;function mF(){return null===mV?mV=0x10000000+Math.round(0x80000000*Math.random()):mV++,"0x"+mV.toString(16)}let mj="RestConnection",mU={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class mB{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),n=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${r}/databases/${n}`,this.$o=this.databaseId.database===cp?`project_id=${r}`:`project_id=${r}&database_id=${n}`}Wo(e,t,r,n,i){let s=mF(),a=this.Qo(e,t.toUriEncodedString());lX(mj,`Sending RPC '${e}' ${s}:`,a,r);let o={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(o,n,i);let{host:l}=new URL(a),u=oy(l);return this.zo(e,a,o,r,u).then(t=>(lX(mj,`Received RPC '${e}' ${s}: `,t),t),t=>{throw l0(mj,`RPC '${e}' ${s} failed with error: `,t,"url: ",a,"request:",r),t})}jo(e,t,r,n,i,s){return this.Wo(e,t,r,n,i)}Go(e,t,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+lQ,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,r)=>e[r]=t),r&&r.headers.forEach((t,r)=>e[r]=t)}Qo(e,t){let r=mU[e],n=`${this.qo}/v1/${t}:${r}`;return this.databaseInfo.apiKey&&(n=`${n}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),n}terminate(){}}class mz{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}let mq="WebChannelConnection",m$=(e,t,r)=>{e.listen(t,e=>{try{r(e)}catch(e){setTimeout(()=>{throw e},0)}})};class mG extends mB{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){mG.c_||(m$(T(),I.STAT_EVENT,e=>{e.stat===x.PROXY?lX(mq,"STAT_EVENT: detected buffering proxy"):e.stat===x.NOPROXY&&lX(mq,"STAT_EVENT: detected no buffering proxy")}),mG.c_=!0)}zo(e,t,r,n,i){let s=mF();return new Promise((i,a)=>{let o=new y;o.setWithCredentials(!0),o.listenOnce(w.COMPLETE,()=>{try{switch(o.getLastErrorCode()){case b.NO_ERROR:let t=o.getResponseJson();lX(mq,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(t)),i(t);break;case b.TIMEOUT:lX(mq,`RPC '${e}' ${s} timed out`),a(new l4(l3.DEADLINE_EXCEEDED,"Request time out"));break;case b.HTTP_ERROR:let r=o.getStatus();if(lX(mq,`RPC '${e}' ${s} failed with status:`,r,"response text:",o.getResponseText()),r>0){let e=o.getResponseJson();Array.isArray(e)&&(e=e[0]);let t=e?.error;if(t&&t.status&&t.message){let e,r=(e=t.status.toLowerCase().replace(/_/g,"-"),Object.values(l3).indexOf(e)>=0?e:l3.UNKNOWN);a(new l4(r,t.message))}else a(new l4(l3.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new l4(l3.UNAVAILABLE,"Connection failed."));break;default:l2(9055,{l_:e,streamId:s,h_:o.getLastErrorCode(),P_:o.getLastError()})}}finally{lX(mq,`RPC '${e}' ${s} completed.`)}});let l=JSON.stringify(n);lX(mq,`RPC '${e}' ${s} sending request:`,n),o.send(t,"POST",l,r,15)})}T_(e,t,r){let n=mF(),i=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=this.createWebChannelTransport(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},o=this.longPollingOptions.timeoutSeconds;void 0!==o&&(a.longPollingTimeout=Math.round(1e3*o)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Go(a.initMessageHeaders,t,r),a.encodeInitMessageHeaders=!0;let l=i.join("");lX(mq,`Creating RPC '${e}' stream ${n}: ${l}`,a);let u=s.createWebChannel(l,a);this.I_(u);let h=!1,c=!1,d=new mz({Ho:t=>{c?lX(mq,`Not sending because RPC '${e}' stream ${n} is closed:`,t):(h||(lX(mq,`Opening RPC '${e}' stream ${n} transport.`),u.open(),h=!0),lX(mq,`RPC '${e}' stream ${n} sending:`,t),u.send(t))},Jo:()=>u.close()});return m$(u,v.EventType.OPEN,()=>{c||(lX(mq,`RPC '${e}' stream ${n} transport opened.`),d.i_())}),m$(u,v.EventType.CLOSE,()=>{c||(c=!0,lX(mq,`RPC '${e}' stream ${n} transport closed`),d.o_(),this.E_(u))}),m$(u,v.EventType.ERROR,t=>{c||(c=!0,l0(mq,`RPC '${e}' stream ${n} transport errored. Name:`,t.name,"Message:",t.message),d.o_(new l4(l3.UNAVAILABLE,"The operation could not be completed")))}),m$(u,v.EventType.MESSAGE,t=>{if(!c){let r=t.data[0];l6(!!r,16349);let i=r?.error||r[0]?.error;if(i){lX(mq,`RPC '${e}' stream ${n} received error:`,i);let t=i.status,r=function(e){let t=S[e];if(void 0!==t)return fn(t)}(t),s=i.message;void 0===r&&(r=l3.INTERNAL,s="Unknown error status: "+t+" with message "+i.message),c=!0,d.o_(new l4(r,s)),u.close()}else lX(mq,`RPC '${e}' stream ${n} received:`,r),d.__(r)}}),mG.u_(),setTimeout(()=>{d.s_()},0),d}terminate(){this.a_.forEach(e=>e.close()),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter(t=>t===e)}Go(e,t,r){super.Go(e,t,r),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return E()}}function mK(){return"u">typeof window?window:null}function mH(){return"u">typeof document?document:null}function mW(e){return new fT(e,!0)}mG.c_=!1;class mQ{constructor(e,t,r=1e3,n=1.5,i=6e4){this.Ci=e,this.timerId=t,this.R_=r,this.A_=n,this.V_=i,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();let t=Math.floor(this.d_+this.y_()),r=Math.max(0,Date.now()-this.f_),n=Math.max(0,t-r);n>0&&lX("ExponentialBackoff",`Backing off for ${n} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,n,()=>(this.f_=Date.now(),e())),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){null!==this.m_&&(this.m_.skipDelay(),this.m_=null)}cancel(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}let mJ="PersistentStream";class mY{constructor(e,t,r,n,i,s,a,o){this.Ci=e,this.b_=r,this.S_=n,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=o,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new mQ(e,t)}x_(){return 1===this.state||5===this.state||this.O_()}O_(){return 2===this.state||3===this.state}start(){this.F_=0,4!==this.state?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&null===this.C_&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,()=>this.k_()))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,4!==e?this.M_.reset():t&&t.code===l3.RESOURCE_EXHAUSTED?(lZ(t.toString()),lZ("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===l3.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;let e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([e,r])=>{this.D_===t&&this.G_(e,r)},t=>{e(()=>{let e=new l4(l3.UNKNOWN,"Fetching auth token failed: "+t.message);return this.z_(e)})})}G_(e,t){let r=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.Yo(()=>{r(()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.Yo()))}),this.stream.t_(e=>{r(()=>this.z_(e))}),this.stream.onMessage(e=>{r(()=>1==++this.F_?this.H_(e):this.onNext(e))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return lX(mJ,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget(()=>this.D_===e?t():(lX(mJ,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class mX extends mY{constructor(e,t,r,n,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,n,s),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();let t=function(e,t){let r;if("targetChange"in t){var n,i;t.targetChange;let s="NO_CHANGE"===(n=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===n?1:"REMOVE"===n?2:"CURRENT"===n?3:"RESET"===n?4:l2(39313,{state:n}),a=t.targetChange.targetIds||[],o=(i=t.targetChange.resumeToken,e.useProto3Json?(l6(void 0===i||"string"==typeof i,58123),ct.fromBase64String(i||"")):(l6(void 0===i||i instanceof lq.Buffer||i instanceof Uint8Array,16193),ct.fromUint8Array(i||new Uint8Array))),l=t.targetChange.cause;r=new fm(s,a,o,l&&new l4(void 0===l.code?l3.UNKNOWN:fn(l.code),l.message||"")||null)}else if("documentChange"in t){t.documentChange;let n=t.documentChange;n.document,n.document.name,n.document.updateTime;let i=fP(e,n.document.name),s=fk(n.document.updateTime),a=n.document.createTime?fk(n.document.createTime):uk.min(),o=new cB({mapValue:{fields:n.document.fields}}),l=cz.newFoundDocument(i,s,a,o);r=new ff(n.targetIds||[],n.removedTargetIds||[],l.key,l)}else if("documentDelete"in t){t.documentDelete;let n=t.documentDelete;n.document;let i=fP(e,n.document),s=n.readTime?fk(n.readTime):uk.min(),a=cz.newNoDocument(i,s);r=new ff([],n.removedTargetIds||[],a.key,a)}else if("documentRemove"in t){t.documentRemove;let n=t.documentRemove;n.document;let i=fP(e,n.document);r=new ff([],n.removedTargetIds||[],i,null)}else{if(!("filter"in t))return l2(11601,{Vt:t});{t.filter;let e=t.filter;e.targetId;let{count:n=0,unchangedNames:i}=e,s=new ft(n,i);r=new fp(e.targetId,s)}}return r}(this.serializer,e),r=function(e){if(!("targetChange"in e))return uk.min();let t=e.targetChange;return t.targetIds&&t.targetIds.length?uk.min():t.readTime?fk(t.readTime):uk.min()}(e);return this.listener.J_(t,r)}Z_(e){let t,r={};r.database=fO(this.serializer),r.addTarget=function(e,t){let r,n=t.target;if((r=dn(n)?{documents:fB(e,n)}:{query:fz(e,n).ft}).targetId=t.targetId,t.resumeToken.approximateByteSize()>0){r.resumeToken=f_(e,t.resumeToken);let n=fE(e,t.expectedCount);null!==n&&(r.expectedCount=n)}else if(t.snapshotVersion.compareTo(uk.min())>0){r.readTime=fS(e,t.snapshotVersion.toTimestamp());let n=fE(e,t.expectedCount);null!==n&&(r.expectedCount=n)}return r}(this.serializer,e);let n=(this.serializer,null==(t=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return l2(28987,{purpose:e})}}(e.purpose))?null:{"goog-listen-tags":t});n&&(r.labels=n),this.K_(r)}X_(e){let t={};t.database=fO(this.serializer),t.removeTarget=e,this.K_(t)}}class mZ extends mY{constructor(e,t,r,n,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,n,s),this.serializer=i}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return l6(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,l6(!e.writeResults||0===e.writeResults.length,55816),this.listener.ta()}onNext(e){var t,r;l6(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();let n=(t=e.writeResults,r=e.commitTime,t&&t.length>0?(l6(void 0!==r,14353),t.map(e=>{let t;return(t=e.updateTime?fk(e.updateTime):fk(r)).isEqual(uk.min())&&(t=fk(r)),new dH(t,e.transformResults||[])})):[]),i=fk(e.commitTime);return this.listener.na(i,n)}ra(){let e={};e.database=fO(this.serializer),this.K_(e)}ea(e){let t={streamToken:this.lastStreamToken,writes:e.map(e=>fj(this.serializer,e))};this.K_(t)}}class m0{}class m1 extends m0{constructor(e,t,r,n){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=n,this.ia=!1}sa(){if(this.ia)throw new l4(l3.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,r,n){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.Wo(e,fA(t,r),n,i,s)).catch(e=>{throw"FirebaseError"===e.name?(e.code===l3.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new l4(l3.UNKNOWN,e.toString())})}jo(e,t,r,n,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.jo(e,fA(t,r),n,s,a,i)).catch(e=>{throw"FirebaseError"===e.name?(e.code===l3.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new l4(l3.UNKNOWN,e.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class m2{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){0===this.oa&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){"Online"===this.state?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,"Online"===e&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(lZ(t),this.aa=!1):lX("OnlineStateTracker",t)}Pa(){null!==this._a&&(this._a.cancel(),this._a=null)}}let m5="RemoteStore";class m6{constructor(e,t,r,n,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=i,this.Aa.Mo(e=>{r.enqueueAndForget(async()=>{gn(this)&&(lX(m5,"Restarting streams for network reachability change."),await async function(e){e.Ea.add(4),await m4(e),e.Va.set("Unknown"),e.Ea.delete(4),await m3(e)}(this))})}),this.Va=new m2(r,n)}}async function m3(e){if(gn(e))for(let t of e.Ra)await t(!0)}async function m4(e){for(let t of e.Ra)await t(!1)}function m8(e,t){e.Ia.has(t.targetId)||(e.Ia.set(t.targetId,t),gr(e)?gt(e):gw(e).O_()&&m9(e,t))}function m7(e,t){let r=gw(e);e.Ia.delete(t),r.O_()&&ge(e,t),0===e.Ia.size&&(r.O_()?r.L_():gn(e)&&e.Va.set("Unknown"))}function m9(e,t){if(e.da.$e(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(uk.min())>0){let r=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(r)}gw(e).Z_(t)}function ge(e,t){e.da.$e(t),gw(e).X_(t)}function gt(e){e.da=new fy({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),At:t=>e.Ia.get(t)||null,ht:()=>e.datastore.serializer.databaseId}),gw(e).start(),e.Va.ua()}function gr(e){return gn(e)&&!gw(e).x_()&&e.Ia.size>0}function gn(e){return 0===e.Ea.size}async function gi(e){e.Va.set("Online")}async function gs(e){e.Ia.forEach((t,r)=>{m9(e,t)})}async function ga(e,t){e.da=void 0,gr(e)?(e.Va.ha(t),gt(e)):e.Va.set("Unknown")}async function go(e,t,r){if(e.Va.set("Online"),t instanceof fm&&2===t.state&&t.cause)try{await async function(e,t){let r=t.cause;for(let n of t.targetIds)e.Ia.has(n)&&(await e.remoteSyncer.rejectListen(n,r),e.Ia.delete(n),e.da.removeTarget(n))}(e,t)}catch(r){lX(m5,"Failed to remove targets %s: %s ",t.targetIds.join(","),r),await gl(e,r)}else if(t instanceof ff?e.da.Xe(t):t instanceof fp?e.da.st(t):e.da.tt(t),!r.isEqual(uk.min()))try{let t,n=await mh(e.localStore);r.compareTo(n)>=0&&await ((t=e.da.Tt(r)).targetChanges.forEach((t,n)=>{if(t.resumeToken.approximateByteSize()>0){let i=e.Ia.get(n);i&&e.Ia.set(n,i.withResumeToken(t.resumeToken,r))}}),t.targetMismatches.forEach((t,r)=>{let n=e.Ia.get(t);if(!n)return;e.Ia.set(t,n.withResumeToken(ct.EMPTY_BYTE_STRING,n.snapshotVersion)),ge(e,t);let i=new fW(n.target,t,r,n.sequenceNumber);m9(e,i)}),e.remoteSyncer.applyRemoteEvent(t))}catch(t){lX(m5,"Failed to raise snapshot:",t),await gl(e,t)}}async function gl(e,t,r){if(!uW(t))throw t;e.Ea.add(1),await m4(e),e.Va.set("Offline"),r||(r=()=>mh(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{lX(m5,"Retrying IndexedDB access"),await r(),e.Ea.delete(1),await m3(e)})}function gu(e,t){return t().catch(r=>gl(e,r,t))}async function gh(e){var t;let r=gb(e),n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:-1;for(;gn(t=e)&&t.Ta.length<10;)try{let t=await function(e,t){return e.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===t&&(t=-1),e.mutationQueue.getNextMutationBatchAfterBatchId(r,t)))}(e.localStore,n);if(null===t){0===e.Ta.length&&r.L_();break}n=t.batchId,function(e,t){e.Ta.push(t);let r=gb(e);r.O_()&&r.Y_&&r.ea(t.mutations)}(e,t)}catch(t){await gl(e,t)}gc(e)&&gd(e)}function gc(e){return gn(e)&&!gb(e).x_()&&e.Ta.length>0}function gd(e){gb(e).start()}async function gf(e){gb(e).ra()}async function gp(e){let t=gb(e);for(let r of e.Ta)t.ea(r.mutations)}async function gm(e,t,r){let n=e.Ta.shift(),i=d7.from(n,t,r);await gu(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await gh(e)}async function gg(e,t){t&&gb(e).Y_&&await async function(e,t){var r;if(fr(r=t.code)&&r!==l3.ABORTED){let r=e.Ta.shift();gb(e).B_(),await gu(e,()=>e.remoteSyncer.rejectFailedWrite(r.batchId,t)),await gh(e)}}(e,t),gc(e)&&gd(e)}async function gy(e,t){e.asyncQueue.verifyOperationInProgress(),lX(m5,"RemoteStore received new credentials");let r=gn(e);e.Ea.add(3),await m4(e),r&&e.Va.set("Unknown"),await e.remoteSyncer.handleCredentialChange(t),e.Ea.delete(3),await m3(e)}async function gv(e,t){t?(e.Ea.delete(2),await m3(e)):t||(e.Ea.add(2),await m4(e),e.Va.set("Unknown"))}function gw(e){var t,r,n;return e.ma||(t=e.datastore,r=e.asyncQueue,n={Zo:gi.bind(null,e),Yo:gs.bind(null,e),t_:ga.bind(null,e),J_:go.bind(null,e)},t.sa(),e.ma=new mX(r,t.connection,t.authCredentials,t.appCheckCredentials,t.serializer,n),e.Ra.push(async t=>{t?(e.ma.B_(),gr(e)?gt(e):e.Va.set("Unknown")):(await e.ma.stop(),e.da=void 0)})),e.ma}function gb(e){var t,r,n;return e.fa||(t=e.datastore,r=e.asyncQueue,n={Zo:()=>Promise.resolve(),Yo:gf.bind(null,e),t_:gg.bind(null,e),ta:gp.bind(null,e),na:gm.bind(null,e)},t.sa(),e.fa=new mZ(r,t.connection,t.authCredentials,t.appCheckCredentials,t.serializer,n),e.Ra.push(async t=>{t?(e.fa.B_(),await gh(e)):(await e.fa.stop(),e.Ta.length>0&&(lX(m5,`Stopping write stream with ${e.Ta.length} pending writes`),e.Ta=[]))})),e.fa}class gx{constructor(e,t,r,n,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=n,this.removalCallback=i,this.deferred=new l8,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,n,i){let s=new gx(e,t,Date.now()+r,n,i);return s.start(r),s}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new l4(l3.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function gI(e,t){if(lZ("AsyncQueue",`${t}: ${e}`),uW(e))return new l4(l3.UNAVAILABLE,`${t}: ${e}`);throw e}class gT{static emptySet(e){return new gT(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||ug.comparator(t.key,r.key):(e,t)=>ug.comparator(e.key,t.key),this.keyedMap=d_(),this.sortedSet=new h5(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof gT)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let e=t.getNext().key,n=r.getNext().key;if(!e.isEqual(n))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){let r=new gT;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class gE{constructor(){this.ga=new h5(ug.comparator)}track(e){let t=e.doc.key,r=this.ga.get(t);r?0!==e.type&&3===r.type?this.ga=this.ga.insert(t,e):3===e.type&&1!==r.type?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.ga=this.ga.remove(t):1===e.type&&2===r.type?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):l2(63341,{Vt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){let e=[];return this.ga.inorderTraversal((t,r)=>{e.push(r)}),e}}class gS{constructor(e,t,r,n,i,s,a,o,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=n,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=o,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,n,i){let s=[];return t.forEach(e=>{s.push({type:0,doc:e})}),new gS(e,t,gT.emptySet(t),s,r,n,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&dy(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let e=0;e<t.length;e++)if(t[e].type!==r[e].type||!t[e].doc.isEqual(r[e].doc))return!1;return!0}}class g_{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some(e=>e.Da())}}class gk{constructor(){this.queries=gC(),this.onlineState="Unknown",this.Ca=new Set}terminate(){var e;let t;e=new l4(l3.ABORTED,"Firestore shutting down"),t=this.queries,this.queries=gC(),t.forEach((t,r)=>{for(let t of r.ba)t.onError(e)})}}function gC(){return new dT(e=>dv(e),dy)}async function gA(e,t){let r=3,n=t.query,i=e.queries.get(n);i?!i.Sa()&&t.Da()&&(r=2):(i=new g_,r=+!t.Da());try{switch(r){case 0:i.wa=await e.onListen(n,!0);break;case 1:i.wa=await e.onListen(n,!1);break;case 2:await e.onFirstRemoteStoreListen(n)}}catch(r){let e=gI(r,`Initialization of query '${dw(t.query)}' failed`);return void t.onError(e)}e.queries.set(n,i),i.ba.push(t),t.va(e.onlineState),i.wa&&t.Fa(i.wa)&&gR(e)}async function gD(e,t){let r=t.query,n=3,i=e.queries.get(r);if(i){let e=i.ba.indexOf(t);e>=0&&(i.ba.splice(e,1),0===i.ba.length?n=+!t.Da():!i.Sa()&&t.Da()&&(n=2))}switch(n){case 0:return e.queries.delete(r),e.onUnlisten(r,!0);case 1:return e.queries.delete(r),e.onUnlisten(r,!1);case 2:return e.onLastRemoteStoreUnlisten(r);default:return}}function gN(e,t){let r=!1;for(let n of t){let t=n.query,i=e.queries.get(t);if(i){for(let e of i.ba)e.Fa(n)&&(r=!0);i.wa=n}}r&&gR(e)}function gP(e,t,r){let n=e.queries.get(t);if(n)for(let e of n.ba)e.onError(r);e.queries.delete(t)}function gR(e){e.Ca.forEach(e=>{e.next()})}(C=k||(k={})).Ma="default",C.Cache="cache";class gM{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){let t=[];for(let r of e.docChanges)3!==r.type&&t.push(r);e=new gS(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){return!(e.fromCache&&this.Da())||(!this.options.Ka||"Offline"===t)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Ba(e){if(e.docChanges.length>0)return!0;let t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}ka(e){e=gS.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==k.Cache}}class gO{constructor(e,t){this.qa=e,this.byteLength=t}Ua(){return"metadata"in this.qa}}class gL{constructor(e){this.serializer=e}Ks(e){return fP(this.serializer,e)}qs(e){return e.metadata.exists?fF(this.serializer,e.document,!1):cz.newNoDocument(this.Ks(e.metadata.name),this.Us(e.metadata.readTime))}Us(e){return fk(e)}}class gV{constructor(e,t){this.$a=e,this.serializer=t,this.Wa=[],this.Qa=[],this.collectionGroups=new Set,this.progress=gF(e)}get queries(){return this.Wa}get documents(){return this.Qa}Ga(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.qa.namedQuery)this.Wa.push(e.qa.namedQuery);else if(e.qa.documentMetadata){this.Qa.push({metadata:e.qa.documentMetadata}),e.qa.documentMetadata.exists||++t;let r=uf.fromString(e.qa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.qa.document&&(this.Qa[this.Qa.length-1].document=e.qa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,{...this.progress}):null}za(e){let t=new Map,r=new gL(this.serializer);for(let n of e)if(n.metadata.queries){let e=r.Ks(n.metadata.name);for(let r of n.metadata.queries){let n=(t.get(r)||dN()).add(e);t.set(r,n)}}return t}async ja(e){let t=await mv(e,new gL(this.serializer),this.Qa,this.$a.id),r=this.za(this.documents);for(let t of this.Wa)await mw(e,t,r.get(t.name));return this.progress.taskState="Success",{progress:this.progress,Ha:this.collectionGroups,Ja:t}}}function gF(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}class gj{constructor(e){this.key=e}}class gU{constructor(e){this.key=e}}class gB{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=dN(),this.mutatedKeys=dN(),this.eu=dI(e),this.tu=new gT(this.eu)}get nu(){return this.Za}ru(e,t){let r=t?t.iu:new gE,n=t?t.tu:this.tu,i=t?t.mutatedKeys:this.mutatedKeys,s=n,a=!1,o="F"===this.query.limitType&&n.size===this.query.limit?n.last():null,l="L"===this.query.limitType&&n.size===this.query.limit?n.first():null;if(e.inorderTraversal((e,t)=>{let u=n.get(e),h=db(this.query,t)?t:null,c=!!u&&this.mutatedKeys.has(u.key),d=!!h&&(h.hasLocalMutations||this.mutatedKeys.has(h.key)&&h.hasCommittedMutations),f=!1;u&&h?u.data.isEqual(h.data)?c!==d&&(r.track({type:3,doc:h}),f=!0):this.su(u,h)||(r.track({type:2,doc:h}),f=!0,(o&&this.eu(h,o)>0||l&&0>this.eu(h,l))&&(a=!0)):!u&&h?(r.track({type:0,doc:h}),f=!0):u&&!h&&(r.track({type:1,doc:u}),f=!0,(o||l)&&(a=!0)),f&&(h?(s=s.add(h),i=d?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))}),null!==this.query.limit)for(;s.size>this.query.limit;){let e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),r.track({type:1,doc:e})}return{tu:s,iu:r,Ss:a,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,n){let i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;let s=e.iu.ya();s.sort((e,t)=>{var r,n;let i;return r=e.type,n=t.type,(i=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return l2(20277,{Vt:e})}})(r)-i(n)||this.eu(e.doc,t.doc)}),this.ou(r),n=n??!1;let a=t&&!n?this._u():[],o=0===this.Ya.size&&this.current&&!n?1:0,l=o!==this.Xa;return(this.Xa=o,0!==s.length||l)?{snapshot:new gS(this.query,e.tu,i,s,e.mutatedKeys,0===o,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({tu:this.tu,iu:new gE,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(e=>this.Za=this.Za.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Za=this.Za.delete(e)),this.current=e.current)}_u(){if(!this.current)return[];let e=this.Ya;this.Ya=dN(),this.tu.forEach(e=>{this.uu(e.key)&&(this.Ya=this.Ya.add(e.key))});let t=[];return e.forEach(e=>{this.Ya.has(e)||t.push(new gU(e))}),this.Ya.forEach(r=>{e.has(r)||t.push(new gj(r))}),t}cu(e){this.Za=e.ks,this.Ya=dN();let t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return gS.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,0===this.Xa,this.hasCachedResults)}}let gz="SyncEngine";class gq{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class g${constructor(e){this.key=e,this.hu=!1}}class gG{constructor(e,t,r,n,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=n,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new dT(e=>dv(e),dy),this.Iu=new Map,this.Eu=new Set,this.Ru=new h5(ug.comparator),this.Au=new Map,this.Vu=new pX,this.du={},this.mu=new Map,this.fu=pN.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return!0===this.gu}}async function gK(e,t,r=!0){let n,i=yd(e),s=i.Tu.get(t);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),n=s.view.lu()):n=await gW(i,t,r,!0),n}async function gH(e,t){let r=yd(e);await gW(r,t,!0,!1)}async function gW(e,t,r,n){let i,s=await md(e.localStore,df(t)),a=s.targetId,o=e.sharedClientState.addLocalQueryTarget(a,r);return n&&(i=await gQ(e,t,a,"current"===o,s.resumeToken)),e.isPrimaryClient&&r&&m8(e.remoteStore,s),i}async function gQ(e,t,r,n,i){e.pu=(t,r,n)=>(async function(e,t,r,n){let i=t.view.ru(r);i.Ss&&(i=await mp(e.localStore,t.query,!1).then(({documents:e})=>t.view.ru(e,i)));let s=n&&n.targetChanges.get(t.targetId),a=n&&null!=n.targetMismatches.get(t.targetId),o=t.view.applyChanges(i,e.isPrimaryClient,s,a);return g7(e,t.targetId,o.au),o.snapshot})(e,t,r,n);let s=await mp(e.localStore,t,!0),a=new gB(t,s.ks),o=a.ru(s.documents),l=fd.createSynthesizedTargetChangeForCurrentChange(r,n&&"Offline"!==e.onlineState,i),u=a.applyChanges(o,e.isPrimaryClient,l);g7(e,r,u.au);let h=new gq(t,r,a);return e.Tu.set(t,h),e.Iu.has(r)?e.Iu.get(r).push(t):e.Iu.set(r,[t]),u.snapshot}async function gJ(e,t,r){let n=e.Tu.get(t),i=e.Iu.get(n.targetId);i.length>1?(e.Iu.set(n.targetId,i.filter(e=>!dy(e,t))),e.Tu.delete(t)):e.isPrimaryClient?(e.sharedClientState.removeLocalQueryTarget(n.targetId),e.sharedClientState.isActiveQueryTarget(n.targetId)||await mf(e.localStore,n.targetId,!1).then(()=>{e.sharedClientState.clearQueryState(n.targetId),r&&m7(e.remoteStore,n.targetId),g4(e,n.targetId)}).catch(uU)):(g4(e,n.targetId),await mf(e.localStore,n.targetId,!0))}async function gY(e,t){let r=e.Tu.get(t),n=e.Iu.get(r.targetId);e.isPrimaryClient&&1===n.length&&(e.sharedClientState.removeLocalQueryTarget(r.targetId),m7(e.remoteStore,r.targetId))}async function gX(e,t,r){let n=yf(e);try{var i,s;let e,a,o,l,u,h=await (i=n.localStore,o=u_.now(),l=t.reduce((e,t)=>e.add(t.key),dN()),i.persistence.runTransaction("Locally write mutations","readwrite",r=>{let n=dE,s=dN();return i.xs.getEntries(r,l).next(e=>{(n=e).forEach((e,t)=>{t.isValidDocument()||(s=s.add(e))})}).next(()=>i.localDocuments.getOverlayedDocuments(r,n)).next(n=>{e=n;let s=[];for(let r of t){let t=function(e,t){let r=null;for(let n of e.fieldTransforms){let e=t.data.field(n.field),i=dV(n.transform,e||null);null!=i&&(null===r&&(r=cB.empty()),r.set(n.field,i))}return r||null}(r,e.get(r.key).overlayedDocument);null!=t&&s.push(new d1(r.key,t,function e(t){let r=[];return h1(t.fields,(t,n)=>{let i=new um([t]);if(cM(n)){let t=e(n.mapValue).fields;if(0===t.length)r.push(i);else for(let e of t)r.push(i.child(e))}else r.push(i)}),new h9(r)}(t.value.mapValue),dW.exists(!0)))}return i.mutationQueue.addMutationBatch(r,o,s,t)}).next(t=>{a=t;let n=t.applyToLocalDocumentSet(e,s);return i.documentOverlayCache.saveOverlays(r,t.batchId,n)})}).then(()=>({batchId:a.batchId,changes:dk(e)})));n.sharedClientState.addPendingMutation(h.batchId),s=h.batchId,(u=n.du[n.currentUser.toKey()])||(u=new h5(uo)),u=u.insert(s,r),n.du[n.currentUser.toKey()]=u,await ye(n,h.changes),await gh(n.remoteStore)}catch(t){let e=gI(t,"Failed to persist write");r.reject(e)}}async function gZ(e,t){var r;try{let n,i,s=await (r=e.localStore,n=t.snapshotVersion,i=r.vs,r.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{let s=r.xs.newChangeBuffer({trackRemovals:!0});i=r.vs;let a=[];t.targetChanges.forEach((s,o)=>{var l;let u=i.get(o);if(!u)return;a.push(r.li.removeMatchingKeys(e,s.removedDocuments,o).next(()=>r.li.addMatchingKeys(e,s.addedDocuments,o)));let h=u.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(o)?h=h.withResumeToken(ct.EMPTY_BYTE_STRING,uk.min()).withLastLimboFreeSnapshotVersion(uk.min()):s.resumeToken.approximateByteSize()>0&&(h=h.withResumeToken(s.resumeToken,n)),i=i.insert(o,h),l=h,(0===u.resumeToken.approximateByteSize()||l.snapshotVersion.toMicroseconds()-u.snapshotVersion.toMicroseconds()>=3e8||s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size>0)&&a.push(r.li.updateTargetData(e,h))});let o=dE,l=dN();if(t.documentUpdates.forEach(n=>{t.resolvedLimboDocuments.has(n)&&a.push(r.persistence.referenceDelegate.updateLimboDocument(e,n))}),a.push(mc(e,s,t.documentUpdates).next(e=>{o=e.Bs,l=e.Ls})),!n.isEqual(uk.min())){let t=r.li.getLastRemoteSnapshotVersion(e).next(t=>r.li.setTargetsMetadata(e,e.currentSequenceNumber,n));a.push(t)}return uB.waitFor(a).next(()=>s.apply(e)).next(()=>r.localDocuments.getLocalViewOfDocuments(e,o,l)).next(()=>o)}).then(e=>(r.vs=i,e)));t.targetChanges.forEach((t,r)=>{let n=e.Au.get(r);n&&(l6(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1,22616),t.addedDocuments.size>0?n.hu=!0:t.modifiedDocuments.size>0?l6(n.hu,14607):t.removedDocuments.size>0&&(l6(n.hu,42227),n.hu=!1))}),await ye(e,s,t)}catch(e){await uU(e)}}function g0(e,t,r){var n;if(e.isPrimaryClient&&0===r||!e.isPrimaryClient&&1===r){let r,i=[];e.Tu.forEach((e,r)=>{let n=r.view.va(t);n.snapshot&&i.push(n.snapshot)}),(n=e.eventManager).onlineState=t,r=!1,n.queries.forEach((e,n)=>{for(let e of n.ba)e.va(t)&&(r=!0)}),r&&gR(n),i.length&&e.Pu.J_(i),e.onlineState=t,e.isPrimaryClient&&e.sharedClientState.setOnlineState(t)}}async function g1(e,t,r){e.sharedClientState.updateQueryState(t,"rejected",r);let n=e.Au.get(t),i=n&&n.key;if(i){let r=new h5(ug.comparator);r=r.insert(i,cz.newNoDocument(i,uk.min()));let n=dN().add(i),s=new fc(uk.min(),new Map,new h5(uo),r,n);await gZ(e,s),e.Ru=e.Ru.remove(i),e.Au.delete(t),g9(e)}else await mf(e.localStore,t,!1).then(()=>g4(e,t,r)).catch(uU)}async function g2(e,t){var r;let n=t.batch.batchId;try{let i=await (r=e.localStore,r.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{let n,i,s,a=t.batch.keys(),o=r.xs.newChangeBuffer({trackRemovals:!0});return(i=(n=t.batch).keys(),s=uB.resolve(),i.forEach(r=>{s=s.next(()=>o.getEntry(e,r)).next(e=>{let i=t.docVersions.get(r);l6(null!==i,48541),0>e.version.compareTo(i)&&(n.applyToRemoteDocument(e,t),e.isValidDocument()&&(e.setReadTime(t.commitVersion),o.addEntry(e)))})}),s.next(()=>r.mutationQueue.removeMutationBatch(e,n))).next(()=>o.apply(e)).next(()=>r.mutationQueue.performConsistencyCheck(e)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(e,a,t.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=dN();for(let r=0;r<e.mutationResults.length;++r)e.mutationResults[r].transformResults.length>0&&(t=t.add(e.batch.mutations[r].key));return t}(t))).next(()=>r.localDocuments.getDocuments(e,a))}));g3(e,n,null),g6(e,n),e.sharedClientState.updateMutationState(n,"acknowledged"),await ye(e,i)}catch(e){await uU(e)}}async function g5(e,t,r){var n;try{let i=await (n=e.localStore,n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(l6(null!==t,37113),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)).next(()=>n.localDocuments.getDocuments(e,r))}));g3(e,t,r),g6(e,t),e.sharedClientState.updateMutationState(t,"rejected",r),await ye(e,i)}catch(e){await uU(e)}}function g6(e,t){(e.mu.get(t)||[]).forEach(e=>{e.resolve()}),e.mu.delete(t)}function g3(e,t,r){let n=e.du[e.currentUser.toKey()];if(n){let i=n.get(t);i&&(r?i.reject(r):i.resolve(),n=n.remove(t)),e.du[e.currentUser.toKey()]=n}}function g4(e,t,r=null){for(let n of(e.sharedClientState.removeLocalQueryTarget(t),e.Iu.get(t)))e.Tu.delete(n),r&&e.Pu.yu(n,r);e.Iu.delete(t),e.isPrimaryClient&&e.Vu.Gr(t).forEach(t=>{e.Vu.containsKey(t)||g8(e,t)})}function g8(e,t){e.Eu.delete(t.path.canonicalString());let r=e.Ru.get(t);null!==r&&(m7(e.remoteStore,r),e.Ru=e.Ru.remove(t),e.Au.delete(r),g9(e))}function g7(e,t,r){for(let n of r)n instanceof gj?(e.Vu.addReference(n.key,t),function(e,t){let r=t.key,n=r.path.canonicalString();e.Ru.get(r)||e.Eu.has(n)||(lX(gz,"New document in limbo: "+r),e.Eu.add(n),g9(e))}(e,n)):n instanceof gU?(lX(gz,"Document no longer in limbo: "+n.key),e.Vu.removeReference(n.key,t),e.Vu.containsKey(n.key)||g8(e,n.key)):l2(19791,{wu:n})}function g9(e){for(;e.Eu.size>0&&e.Ru.size<e.maxConcurrentLimboResolutions;){let t=e.Eu.values().next().value;e.Eu.delete(t);let r=new ug(uf.fromString(t)),n=e.fu.next();e.Au.set(n,new g$(r)),e.Ru=e.Ru.insert(r,n),m8(e.remoteStore,new fW(df(du(r.path)),n,"TargetPurposeLimboResolution",u2.ce))}}async function ye(e,t,r){let n=[],i=[],s=[];e.Tu.isEmpty()||(e.Tu.forEach((a,o)=>{s.push(e.pu(o,t,r).then(t=>{if((t||r)&&e.isPrimaryClient){let n=t?!t.fromCache:r?.targetChanges.get(o.targetId)?.current;e.sharedClientState.updateQueryState(o.targetId,n?"current":"not-current")}if(t){n.push(t);let e=mi.Es(o.targetId,t);i.push(e)}}))}),await Promise.all(s),e.Pu.J_(n),await async function(e,t){try{await e.persistence.runTransaction("notifyLocalViewChanges","readwrite",r=>uB.forEach(t,t=>uB.forEach(t.Ts,n=>e.persistence.referenceDelegate.addReference(r,t.targetId,n)).next(()=>uB.forEach(t.Is,n=>e.persistence.referenceDelegate.removeReference(r,t.targetId,n)))))}catch(e){if(!uW(e))throw e;lX(mo,"Failed to update sequence numbers: "+e)}for(let r of t){let t=r.targetId;if(!r.fromCache){let r=e.vs.get(t),n=r.snapshotVersion,i=r.withLastLimboFreeSnapshotVersion(n);e.vs=e.vs.insert(t,i)}}}(e.localStore,i))}async function yt(e,t){if(!e.currentUser.isEqual(t)){lX(gz,"User change. New user:",t.toKey());let r=await mu(e.localStore,t);e.currentUser=t,e.mu.forEach(e=>{e.forEach(e=>{e.reject(new l4(l3.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.mu.clear(),e.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),await ye(e,r.Ns)}}function yr(e,t){let r=e.Au.get(t);if(r&&r.hu)return dN().add(r.key);{let r=dN(),n=e.Iu.get(t);if(!n)return r;for(let t of n){let n=e.Tu.get(t);r=r.unionWith(n.view.nu)}return r}}async function yn(e,t){let r=await mp(e.localStore,t.query,!0),n=t.view.cu(r);return e.isPrimaryClient&&g7(e,t.targetId,n.au),n}async function yi(e,t){return mg(e.localStore,t).then(t=>ye(e,t))}async function ys(e,t,r,n){var i,s;let a,o=await (i=e.localStore,a=i.mutationQueue,i.persistence.runTransaction("Lookup mutation documents","readonly",e=>a.Xn(e,t).next(t=>t?i.localDocuments.getDocuments(e,t):uB.resolve(null))));null!==o?("pending"===r?await gh(e.remoteStore):"acknowledged"===r||"rejected"===r?(g3(e,t,n||null),g6(e,t),s=e.localStore,s.mutationQueue.nr(t)):l2(6720,"Unknown batchState",{bu:r}),await ye(e,o)):lX(gz,"Cannot apply mutation batch with id: "+t)}async function ya(e,t){if(yd(e),yf(e),!0===t&&!0!==e.gu){let t=e.sharedClientState.getAllActiveQueryTargets(),r=await yo(e,t.toArray());for(let t of(e.gu=!0,await gv(e.remoteStore,!0),r))m8(e.remoteStore,t)}else if(!1===t&&!1!==e.gu){let t=[],r=Promise.resolve();e.Iu.forEach((n,i)=>{e.sharedClientState.isLocalQueryTarget(i)?t.push(i):r=r.then(()=>(g4(e,i),mf(e.localStore,i,!0))),m7(e.remoteStore,i)}),await r,await yo(e,t),e.Au.forEach((t,r)=>{m7(e.remoteStore,r)}),e.Vu.zr(),e.Au=new Map,e.Ru=new h5(ug.comparator),e.gu=!1,await gv(e.remoteStore,!1)}}async function yo(e,t,r){let n=[],i=[];for(let r of t){let t,s=e.Iu.get(r);if(s&&0!==s.length)for(let r of(t=await md(e.localStore,df(s[0])),s)){let t=e.Tu.get(r),n=await yn(e,t);n.snapshot&&i.push(n.snapshot)}else{let n=await mm(e.localStore,r);t=await md(e.localStore,n),await gQ(e,yl(n),r,!1,t.resumeToken)}n.push(t)}return e.Pu.J_(i),n}function yl(e){var t,r,n,i,s;return t=e.path,r=e.collectionGroup,n=e.orderBy,i=e.filters,s=e.limit,new dl(t,r,n,i,s,"F",e.startAt,e.endAt)}function yu(e){return e.localStore.persistence.hs()}async function yh(e,t,r,n){if(e.gu)return void lX(gz,"Ignoring unexpected query state notification.");let i=e.Iu.get(t);if(i&&i.length>0)switch(r){case"current":case"not-current":{let n=await mg(e.localStore,dx(i[0])),s=fc.createSynthesizedRemoteEventForCurrentChange(t,"current"===r,ct.EMPTY_BYTE_STRING);await ye(e,n,s);break}case"rejected":await mf(e.localStore,t,!0),g4(e,t,n);break;default:l2(64155,r)}}async function yc(e,t,r){let n=yd(e);if(n.gu){for(let e of t){if(n.Iu.has(e)&&n.sharedClientState.isActiveQueryTarget(e)){lX(gz,"Adding an already active target "+e);continue}let t=await mm(n.localStore,e),r=await md(n.localStore,t);await gQ(n,yl(t),r.targetId,!1,r.resumeToken),m8(n.remoteStore,r)}for(let e of r)n.Iu.has(e)&&await mf(n.localStore,e,!1).then(()=>{m7(n.remoteStore,e),g4(n,e)}).catch(uU)}}function yd(e){return e.remoteStore.remoteSyncer.applyRemoteEvent=gZ.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=yr.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=g1.bind(null,e),e.Pu.J_=gN.bind(null,e.eventManager),e.Pu.yu=gP.bind(null,e.eventManager),e}function yf(e){return e.remoteStore.remoteSyncer.applySuccessfulWrite=g2.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=g5.bind(null,e),e}class yp{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=mW(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){var t,r;return t=this.persistence,r=new ma,new ml(t,r,e.initialUser,this.serializer)}Cu(e){return new p6(p4.Vi,this.serializer)}Du(e){return new mR}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}yp.provider={build:()=>new yp};class ym extends yp{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){return l6(this.persistence.referenceDelegate instanceof p8,46915),new pV(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}Cu(e){let t=void 0!==this.cacheSizeBytes?pS.withCacheSize(this.cacheSizeBytes):pS.DEFAULT;return new p6(e=>p8.Vi(e,t),this.serializer)}}class yg extends yp{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await yf(this.xu.syncEngine),await gh(this.xu.remoteStore),await this.persistence.zi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){var t,r;return t=this.persistence,r=new ma,new ml(t,r,e.initialUser,this.serializer)}Fu(e,t){return new pV(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}Mu(e,t){let r=new u1(t,this.persistence);return new u0(e.asyncQueue,r)}Cu(e){let t=mn(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=void 0!==this.cacheSizeBytes?pS.withCacheSize(this.cacheSizeBytes):pS.DEFAULT;return new mr(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,mK(),mH(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new mR}}class yy extends yg{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);let t=this.xu.syncEngine;this.sharedClientState instanceof mP&&(this.sharedClientState.syncEngine={So:ys.bind(null,t),Do:yh.bind(null,t),Co:yc.bind(null,t),hs:yu.bind(null,t),bo:yi.bind(null,t)},await this.sharedClientState.start()),await this.persistence.zi(async e=>{await ya(this.xu.syncEngine,e),this.gcScheduler&&(e&&!this.gcScheduler.started?this.gcScheduler.start():e||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(e&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():e||this.indexBackfillerScheduler.stop())})}Du(e){let t=mK();if(!mP.v(t))throw new l4(l3.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=mn(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new mP(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class yv{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>g0(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=yt.bind(null,this.syncEngine),await gv(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new gk}createDatastore(e){var t;let r=mW(e.databaseInfo.databaseId),n=new mG(e.databaseInfo);return t=e.authCredentials,new m1(t,e.appCheckCredentials,n,r)}createRemoteStore(e){var t,r;return t=this.localStore,r=this.datastore,new m6(t,r,e.asyncQueue,e=>g0(this.syncEngine,e,0),mL.v()?new mL:new mM)}createSyncEngine(e,t){var r,n,i,s,a,o;let l;return r=this.localStore,n=this.remoteStore,i=this.eventManager,s=this.sharedClientState,a=e.initialUser,o=e.maxConcurrentLimboResolutions,l=new gG(r,n,i,s,a,o),t&&(l.gu=!0),l}async terminate(){await async function(e){lX(m5,"RemoteStore shutting down."),e.Ea.add(5),await m4(e),e.Aa.shutdown(),e.Va.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}function yw(e,t=10240){let r=0;return{async read(){if(r<e.byteLength){let n={value:e.slice(r,r+t),done:!1};return r+=t,n}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}yv.provider={build:()=>new yv};class yb{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):lZ("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}class yx{constructor(e,t){this.Bu=e,this.serializer=t,this.metadata=new l8,this.buffer=new Uint8Array,this.Lu=new TextDecoder("utf-8"),this.ku().then(e=>{e&&e.Ua()?this.metadata.resolve(e.qa.metadata):this.metadata.reject(Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(e?.qa)}`))},e=>this.metadata.reject(e))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async Su(){return await this.getMetadata(),this.ku()}async ku(){let e=await this.Ku();if(null===e)return null;let t=this.Lu.decode(e),r=Number(t);return isNaN(r)&&this.qu(`length string (${t}) is not valid number`),new gO(JSON.parse(await this.Uu(r)),e.length+r)}$u(){return this.buffer.findIndex(e=>123===e)}async Ku(){for(;0>this.$u()&&!await this.Wu(););if(0===this.buffer.length)return null;let e=this.$u();e<0&&this.qu("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async Uu(e){for(;this.buffer.length<e;)await this.Wu()&&this.qu("Reached the end of bundle when more is expected.");let t=this.Lu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}qu(e){throw this.Bu.cancel(),Error(`Invalid bundle format: ${e}`)}async Wu(){let e=await this.Bu.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}class yI{constructor(e,t){this.bundleData=e,this.serializer=t,this.cursor=0,this.elements=[];let r=this.Su();if(!r||!r.Ua())throw Error(`The first element of the bundle is not a metadata object, it is
         ${JSON.stringify(r?.qa)}`);this.metadata=r;do null!==(r=this.Su())&&this.elements.push(r);while(null!==r)}getMetadata(){return this.metadata}Qu(){return this.elements}Su(){if(this.cursor===this.bundleData.length)return null;let e=this.Ku();return new gO(JSON.parse(this.Uu(e)),e)}Uu(e){if(this.cursor+e>this.bundleData.length)throw new l4(l3.INTERNAL,"Reached the end of bundle when more is expected.");return this.bundleData.slice(this.cursor,this.cursor+=e)}Ku(){let e=this.cursor,t=this.cursor;for(;t<this.bundleData.length;){if("{"===this.bundleData[t]){if(t===e)throw Error("First character is a bracket and not a number");return this.cursor=t,Number(this.bundleData.slice(e,t))}t++}throw Error("Reached the end of bundle when more is expected.")}}class yT{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new l4(l3.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=await async function(e,t){let r={documents:t.map(t=>fN(e.serializer,t))},n=await e.jo("BatchGetDocuments",e.serializer.databaseId,uf.emptyPath(),r,t.length),i=new Map;n.forEach(t=>{var r;let n,s,a,o,l,u,h=(r=e.serializer,"found"in t?(l6(!!t.found,43571),t.found.name,t.found.updateTime,n=fP(r,t.found.name),s=fk(t.found.updateTime),a=t.found.createTime?fk(t.found.createTime):uk.min(),o=new cB({mapValue:{fields:t.found.fields}}),cz.newFoundDocument(n,s,a,o)):"missing"in t?(l6(!!t.missing,3894),l6(!!t.readTime,22933),l=fP(r,t.missing),u=fk(t.readTime),cz.newNoDocument(l,u)):l2(7234,{result:t}));i.set(h.key.toString(),h)});let s=[];return t.forEach(e=>{let t=i.get(e.toString());l6(!!t,55234,{key:e}),s.push(t)}),s}(this.datastore,e);return t.forEach(e=>this.recordVersion(e)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastTransactionError=e}this.writtenDocs.add(e.toString())}delete(e){this.write(new d3(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((e,t)=>{let r=ug.fromPath(t);this.mutations.push(new d4(r,this.precondition(r)))}),await async function(e,t){let r={writes:t.map(t=>fj(e.serializer,t))};await e.Wo("Commit",e.serializer.databaseId,uf.emptyPath(),r)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw l2(50498,{Gu:e.constructor.name});t=uk.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new l4(l3.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(uk.min())?dW.exists(!1):dW.updateTime(t):dW.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(uk.min()))throw new l4(l3.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return dW.updateTime(t)}return dW.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class yE{constructor(e,t,r,n,i){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=n,this.deferred=i,this.zu=r.maxAttempts,this.M_=new mQ(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Hu()}Hu(){this.M_.p_(async()=>{let e=new yT(this.datastore),t=this.Ju(e);t&&t.then(t=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(t)}).catch(e=>{this.Zu(e)}))}).catch(e=>{this.Zu(e)})})}Ju(e){try{let t=this.updateFunction(e);return!u5(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}Zu(e){this.zu>0&&this.Xu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget(()=>(this.Hu(),Promise.resolve()))):this.deferred.reject(e)}Xu(e){if("FirebaseError"===e?.name){let t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!fr(t)}return!1}}let yS="FirestoreClient";class y_{constructor(e,t,r,n,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this._databaseInfo=n,this.user=lW.UNAUTHENTICATED,this.clientId=ua.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async e=>{lX(yS,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(r,e=>(lX(yS,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new l8;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){let t=gI(r,"Failed to shutdown persistence");e.reject(t)}}),e.promise}}async function yk(e,t){e.asyncQueue.verifyOperationInProgress(),lX(yS,"Initializing OfflineComponentProvider");let r=e.configuration;await t.initialize(r);let n=r.initialUser;e.setCredentialChangeListener(async e=>{n.isEqual(e)||(await mu(t.localStore,e),n=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function yC(e,t){e.asyncQueue.verifyOperationInProgress();let r=await yA(e);lX(yS,"Initializing OnlineComponentProvider"),await t.initialize(r,e.configuration),e.setCredentialChangeListener(e=>gy(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,r)=>gy(t.remoteStore,r)),e._onlineComponents=t}async function yA(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){lX(yS,"Using user provided OfflineComponentProvider");try{await yk(e,e._uninitializedComponentsProvider._offline)}catch(t){if(!("FirebaseError"===t.name?t.code===l3.FAILED_PRECONDITION||t.code===l3.UNIMPLEMENTED:!("u">typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code))throw t;l0("Error using user provided cache. Falling back to memory cache: "+t),await yk(e,new yp)}}else lX(yS,"Using default OfflineComponentProvider"),await yk(e,new ym(void 0));return e._offlineComponents}async function yD(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(lX(yS,"Using user provided OnlineComponentProvider"),await yC(e,e._uninitializedComponentsProvider._online)):(lX(yS,"Using default OnlineComponentProvider"),await yC(e,new yv))),e._onlineComponents}function yN(e){return yA(e).then(e=>e.localStore)}function yP(e){return yD(e).then(e=>e.syncEngine)}function yR(e){return yD(e).then(e=>e.datastore)}async function yM(e){let t=await yD(e),r=t.eventManager;return r.onListen=gK.bind(null,t.syncEngine),r.onUnlisten=gJ.bind(null,t.syncEngine),r.onFirstRemoteStoreListen=gH.bind(null,t.syncEngine),r.onLastRemoteStoreUnlisten=gY.bind(null,t.syncEngine),r}function yO(e,t,r={}){let n=new l8;return e.asyncQueue.enqueueAndForget(async()=>{var i,s;let a,o;return i=await yM(e),s=e.asyncQueue,a=new yb({next:e=>{a.Nu(),s.enqueueAndForget(()=>gD(i,o));let l=e.docs.has(t);!l&&e.fromCache?n.reject(new l4(l3.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&e.fromCache&&r&&"server"===r.source?n.reject(new l4(l3.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):n.resolve(e)},error:e=>n.reject(e)}),gA(i,o=new gM(du(t.path),a,{includeMetadataChanges:!0,Ka:!0}))}),n.promise}function yL(e,t,r={}){let n=new l8;return e.asyncQueue.enqueueAndForget(async()=>{var i,s;let a,o;return i=await yM(e),s=e.asyncQueue,o=new gM(t,a=new yb({next:e=>{a.Nu(),s.enqueueAndForget(()=>gD(i,o)),e.fromCache&&"server"===r.source?n.reject(new l4(l3.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):n.resolve(e)},error:e=>n.reject(e)}),{includeMetadataChanges:!0,Ka:!0}),gA(i,o)}),n.promise}function yV(e){let t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}let yF=new Map,yj="firestore.googleapis.com";class yU{constructor(e){if(void 0===e.host){if(void 0!==e.ssl)throw new l4(l3.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=yj,this.ssl=!0}else this.host=e.host,this.ssl=e.ssl??!0;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=0x2800000;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new l4(l3.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,r,n){if(!0===t&&!0===n)throw new l4(l3.INVALID_ARGUMENT,`${e} and ${r} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=yV(e.experimentalLongPollingOptions??{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new l4(l3.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new l4(l3.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new l4(l3.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){var t,r;return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(t=this.experimentalLongPollingOptions,r=e.experimentalLongPollingOptions,t.timeoutSeconds===r.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class yB{constructor(e,t,r,n){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=n,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new yU({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new l4(l3.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new l4(l3.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new yU(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new l9;switch(e.type){case"firstParty":return new un(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new l4(l3.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){let e;return(e=yF.get(this))&&(lX("ComponentProvider","Removing Datastore"),yF.delete(this),e.terminate()),Promise.resolve()}}class yz{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new yz(this.firestore,e,this._query)}}class yq{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new y$(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new yq(this.firestore,e,this._key)}toJSON(){return{type:yq._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(uS(t,yq._jsonSchema))return new yq(e,r||null,new ug(uf.fromString(t.referencePath)))}}yq._jsonSchemaVersion="firestore/documentReference/1.0",yq._jsonSchema={type:uE("string",yq._jsonSchemaVersion),referencePath:uE("string")};class y$ extends yz{constructor(e,t,r){super(e,t,du(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new yq(this.firestore,null,new ug(e))}withConverter(e){return new y$(this.firestore,e,this._path)}}function yG(e,t,...r){if(e=oz(e),uy("collection","path",t),e instanceof yB){let n=uf.fromString(t,...r);return uw(n),new y$(e,null,n)}{if(!(e instanceof yq||e instanceof y$))throw new l4(l3.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let n=e._path.child(uf.fromString(t,...r));return uw(n),new y$(e.firestore,null,n)}}function yK(e,t,...r){if(e=oz(e),1==arguments.length&&(t=ua.newId()),uy("doc","path",t),e instanceof yB){let n=uf.fromString(t,...r);return uv(n),new yq(e,null,new ug(n))}{if(!(e instanceof yq||e instanceof y$))throw new l4(l3.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let n=e._path.child(uf.fromString(t,...r));return uv(n),new yq(e.firestore,e instanceof y$?e.converter:null,new ug(n))}}function yH(e,t){return e=oz(e),t=oz(t),e instanceof yz&&t instanceof yz&&e.firestore===t.firestore&&dy(e._query,t._query)&&e.converter===t.converter}let yW="AsyncQueue";class yQ{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new mQ(this,"async_queue_retry"),this._c=()=>{let e=mH();e&&lX(yW,"Visibility state changed to "+e.visibilityState),this.M_.w_()},this.ac=e;const t=mH();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;let t=mH();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});let t=new l8;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Yu.push(e),this.lc()))}async lc(){if(0!==this.Yu.length){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!uW(e))throw e;lX(yW,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){let t=this.ac.then(()=>(this.rc=!0,e().catch(e=>{throw this.nc=e,this.rc=!1,lZ("INTERNAL UNHANDLED ERROR: ",yJ(e)),e}).then(e=>(this.rc=!1,e))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);let n=gx.createAndSchedule(this,e,t,r,e=>this.hc(e));return this.tc.push(n),n}uc(){this.nc&&l2(47125,{Pc:yJ(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(let t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{for(let t of(this.tc.sort((e,t)=>e.targetTimeMs-t.targetTimeMs),this.tc))if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Tc()})}Rc(e){this.oc.push(e)}hc(e){let t=this.tc.indexOf(e);this.tc.splice(t,1)}}function yJ(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}class yY{constructor(){this._progressObserver={},this._taskCompletionResolver=new l8,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class yX extends yB{constructor(e,t,r,n){super(e,t,r,n),this.type="firestore",this._queue=new yQ,this._persistenceKey=n?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new yQ(e),this._firestoreClient=void 0,await e}}}function yZ(e){if(e._terminated)throw new l4(l3.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||function(e){var t,r,n,i,s;let a,o=e._freezeSettings(),l=(t=e._databaseId,r=e._app?.options.appId||"",n=e._persistenceKey,i=e._app?.options.apiKey,new cf(t,r,n,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,yV(o.experimentalLongPollingOptions),o.useFetchStreams,o.isUsingEmulator,i));e._componentsProvider||o.localCache?._offlineComponentProvider&&o.localCache?._onlineComponentProvider&&(e._componentsProvider={_offline:o.localCache._offlineComponentProvider,_online:o.localCache._onlineComponentProvider}),e._firestoreClient=new y_(e._authCredentials,e._appCheckCredentials,e._queue,l,e._componentsProvider&&(s=e._componentsProvider,a=s?._online.build(),{_offline:s?._offline.build(a),_online:a}))}(e),e._firestoreClient}function y0(e,t){let r=yZ(e=uI(e,yX)),n=new yY;return function(e,t,r,n){var i;let s=(i=mW(t),new yx(function(e,t){if(e instanceof Uint8Array)return yw(e,void 0);if(e instanceof ArrayBuffer)return yw(new Uint8Array(e),void 0);if(e instanceof ReadableStream)return e.getReader();throw Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof r?fs().encode(r):r),i));e.asyncQueue.enqueueAndForget(async()=>{var t;(async function(e,t,r){try{var n,i;let s,a=await t.getMetadata();if(await (n=e.localStore,s=fk(a.createTime),n.persistence.runTransaction("hasNewerBundle","readonly",e=>n.Pi.getBundleMetadata(e,a.id)).then(e=>!!e&&e.createTime.compareTo(s)>=0)))return await t.close(),r._completeWith({taskState:"Success",documentsLoaded:a.totalDocuments,bytesLoaded:a.totalBytes,totalDocuments:a.totalDocuments,totalBytes:a.totalBytes}),Promise.resolve(new Set);r._updateProgress(gF(a));let o=new gV(a,t.serializer),l=await t.Su();for(;l;){let e=await o.Ga(l);e&&r._updateProgress(e),l=await t.Su()}let u=await o.ja(e.localStore);return await ye(e,u.Ja,void 0),await (i=e.localStore,i.persistence.runTransaction("Save bundle","readwrite",e=>i.Pi.saveBundleMetadata(e,a))),r._completeWith(u.progress),Promise.resolve(u.Ha)}catch(e){return l0(gz,`Loading bundle failed with ${e}`),r._failWith(e),Promise.resolve(new Set)}})(t=await yP(e),s,n).then(e=>{t.sharedClientState.notifyBundleLoaded(e)})})}(r,e._databaseId,t,n),n}class y1{constructor(e){this._byteString=e}static fromBase64String(e){try{return new y1(ct.fromBase64String(e))}catch(e){throw new l4(l3.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new y1(ct.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:y1._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(uS(e,y1._jsonSchema))return y1.fromBase64String(e.bytes)}}y1._jsonSchemaVersion="firestore/bytes/1.0",y1._jsonSchema={type:uE("string",y1._jsonSchemaVersion),bytes:uE("string")};class y2{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new l4(l3.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new um(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class y5{constructor(e){this._methodName=e}}class y6{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new l4(l3.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new l4(l3.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return uo(this._lat,e._lat)||uo(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:y6._jsonSchemaVersion}}static fromJSON(e){if(uS(e,y6._jsonSchema))return new y6(e.latitude,e.longitude)}}y6._jsonSchemaVersion="firestore/geoPoint/1.0",y6._jsonSchema={type:uE("string",y6._jsonSchemaVersion),latitude:uE("number"),longitude:uE("number")};class y3{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}(this._values,e._values)}toJSON(){return{type:y3._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(uS(e,y3._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(e=>"number"==typeof e))return new y3(e.vectorValues);throw new l4(l3.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}y3._jsonSchemaVersion="firestore/vectorValue/1.0",y3._jsonSchema={type:uE("string",y3._jsonSchemaVersion),vectorValues:uE("object")};let y4=/^__.*__$/;class y8{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return null!==this.fieldMask?new d1(e,this.data,this.fieldMask,t,this.fieldTransforms):new d0(e,this.data,t,this.fieldTransforms)}}class y7{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new d1(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function y9(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw l2(40011,{dataSource:e})}}class ve{constructor(e,t,r,n,i,s){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=n,void 0===i&&this.validatePath(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new ve({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){let t=this.path?.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePathSegment(e),r}childContextForFieldPath(e){let t=this.path?.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePath(),r}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return vy(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(0===e.length)throw this.createError("Document fields must not be empty");if(y9(this.dataSource)&&y4.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class vt{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||mW(e)}createContext(e,t,r,n=!1){return new ve({dataSource:e,methodName:t,targetDoc:r,path:um.emptyPath(),arrayElement:!1,hasConverter:n},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function vr(e){let t=e._freezeSettings(),r=mW(e._databaseId);return new vt(e._databaseId,!!t.ignoreUndefinedProperties,r)}function vn(e,t,r,n,i,s={}){let a,o,l=e.createContext(s.merge||s.mergeFields?2:0,t,r,i);vf("Data must be an object, but it was:",l,n);let u=vc(n,l);if(s.merge)a=new h9(l.fieldMask),o=l.fieldTransforms;else if(s.mergeFields){let e=[];for(let n of s.mergeFields){let i=vp(t,n,r);if(!l.contains(i))throw new l4(l3.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);vv(e,i)||e.push(i)}a=new h9(e),o=l.fieldTransforms.filter(e=>a.covers(e.field))}else a=null,o=l.fieldTransforms;return new y8(new cB(u),a,o)}class vi extends y5{_toFieldTransform(e){if(2!==e.dataSource)throw 1===e.dataSource?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof vi}}class vs extends y5{_toFieldTransform(e){return new dK(e.path,new dF)}isEqual(e){return e instanceof vs}}class va extends y5{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){let t=new dq(e.serializer,dO(e.serializer,this.Vc));return new dK(e.path,t)}isEqual(e){return e instanceof va&&this.Vc===e.Vc}}function vo(e,t,r,n){let i=e.createContext(1,t,r);vf("Data must be an object, but it was:",i,n);let s=[],a=cB.empty();return h1(n,(e,n)=>{let o=vg(t,e,r);n=oz(n);let l=i.childContextForFieldPath(o);if(n instanceof vi)s.push(o);else{let e=vh(n,l);null!=e&&(s.push(o),a.set(o,e))}}),new y7(a,new h9(s),i.fieldTransforms)}function vl(e,t,r,n,i,s){let a=e.createContext(1,t,r),o=[vp(t,n,r)],l=[i];if(s.length%2!=0)throw new l4(l3.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let e=0;e<s.length;e+=2)o.push(vp(t,s[e])),l.push(s[e+1]);let u=[],h=cB.empty();for(let e=o.length-1;e>=0;--e)if(!vv(u,o[e])){let t=o[e],r=l[e];r=oz(r);let n=a.childContextForFieldPath(t);if(r instanceof vi)u.push(t);else{let e=vh(r,n);null!=e&&(u.push(t),h.set(t,e))}}return new y7(h,new h9(u),a.fieldTransforms)}function vu(e,t,r,n=!1){return vh(r,e.createContext(n?4:3,t))}function vh(e,t){if(vd(e=oz(e)))return vf("Unsupported field value:",t,e),vc(e,t);if(e instanceof y5)return function(e,t){if(!y9(t.dataSource))throw t.createError(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.createError(`${e._methodName}() is not currently supported inside arrays`);let r=e._toFieldTransform(t);r&&t.fieldTransforms.push(r)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.arrayElement&&4!==t.dataSource)throw t.createError("Nested arrays are not supported");let r=[],n=0;for(let i of e){let e=vh(i,t.childContextForArray(n));null==e&&(e={nullValue:"NULL_VALUE"}),r.push(e),n++}return{arrayValue:{values:r}}}return function(e,t){if(null===(e=oz(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return dO(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){let r=u_.fromDate(e);return{timestampValue:fS(t.serializer,r)}}if(e instanceof u_){let r=new u_(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:fS(t.serializer,r)}}if(e instanceof y6)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof y1)return{bytesValue:f_(t.serializer,e._byteString)};if(e instanceof yq){let r=t.databaseId,n=e.firestore._databaseId;if(!n.isEqual(r))throw t.createError(`Document reference is for database ${n.projectId}/${n.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:fC(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof y3){var r;return{mapValue:{fields:{[cg]:{stringValue:cw},[cb]:{arrayValue:{values:((r=e)instanceof y3?r.toArray():r).map(e=>{if("number"!=typeof e)throw t.createError("VectorValues must only contain numeric values.");return dR(t.serializer,e)})}}}}}}if(fH(e))return e._toProto(t.serializer);throw t.createError(`Unsupported field value: ${ux(e)}`)}(e,t)}function vc(e,t){let r={};return h2(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):h1(e,(e,n)=>{let i=vh(n,t.childContextForField(e));null!=i&&(r[e]=i)}),{mapValue:{fields:r}}}function vd(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof u_||e instanceof y6||e instanceof y1||e instanceof yq||e instanceof y5||e instanceof y3||fH(e))}function vf(e,t,r){if(!vd(r)||!ub(r)){let n=ux(r);throw"an object"===n?t.createError(e+" a custom object"):t.createError(e+" "+n)}}function vp(e,t,r){if((t=oz(t))instanceof y2)return t._internalPath;if("string"==typeof t)return vg(e,t);throw vy("Field path arguments must be of type string or ",e,!1,void 0,r)}let vm=RegExp("[~\\*/\\[\\]]");function vg(e,t,r){if(t.search(vm)>=0)throw vy(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,r);try{return new y2(...t.split("."))._internalPath}catch(n){throw vy(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,r)}}function vy(e,t,r,n,i){let s=n&&!n.isEmpty(),a=void 0!==i,o=`Function ${t}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${n}`),a&&(l+=` in document ${i}`),l+=")"),new l4(l3.INVALID_ARGUMENT,o+e+l)}function vv(e,t){return e.some(e=>e.isEqual(t))}class vw{convertValue(e,t="none"){switch(cI(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ci(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(cs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw l2(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return h1(e,(e,n)=>{r[e]=this.convertValue(n,t)}),r}convertVectorValue(e){return new y3(e.fields?.[cb].arrayValue?.values?.map(e=>ci(e.doubleValue)))}convertGeoPoint(e){return new y6(ci(e.latitude),ci(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=cc(e);return null==r?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(cd(e));default:return null}}convertTimestamp(e){let t=cn(e);return new u_(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=uf.fromString(e);l6(fK(r),9688,{name:e});let n=new cm(r.get(1),r.get(3)),i=new ug(r.popFirst(5));return n.isEqual(t)||lZ(`Document ${i} contains a document reference within a different database (${n.projectId}/${n.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}class vb extends vw{constructor(e){super(),this.firestore=e}convertBytes(e){return new y1(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new yq(this.firestore,null,t)}}function vx(){return new vs("serverTimestamp")}let vI="@firebase/firestore",vT="4.10.0";function vE(e){if("object"!=typeof e||null===e)return!1;for(let t of["next","error","complete"])if(t in e&&"function"==typeof e[t])return!0;return!1}class vS{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}}class v_{constructor(e,t,r){this._userDataWriter=t,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}_fieldsProto(){return new cB({mapValue:{fields:this._data}}).clone().value.mapValue.fields}}class vk{constructor(e,t,r,n,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=n,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new yq(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){let e=new vC(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){let t=this._document.data.field(vp("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class vC extends vk{data(){return super.data()}}function vA(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new l4(l3.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class vD{}class vN extends vD{}function vP(e,t,...r){let n=[];for(let i of(t instanceof vD&&n.push(t),function(e){let t=e.filter(e=>e instanceof vO).length,r=e.filter(e=>e instanceof vR).length;if(t>1||t>0&&r>0)throw new l4(l3.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n=n.concat(r)),n))e=i._apply(e);return e}class vR extends vN{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new vR(e,t,r)}_apply(e){let t=this._parse(e);return vX(e._query,t),new yz(e.firestore,e.converter,dm(e._query,t))}_parse(e){let t=vr(e.firestore);return function(e,t,r,n,i,s,a){let o;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new l4(l3.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if("in"===s||"not-in"===s){vY(a,s);let t=[];for(let r of a)t.push(vJ(n,e,r));o={arrayValue:{values:t}}}else o=vJ(n,e,a)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||vY(a,s),o=vu(r,t,a,"in"===s||"not-in"===s);return cW.create(i,s,o)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function vM(e,t,r){let n=vp("where",e);return vR._create(n,t,r)}class vO extends vD{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new vO(e,t)}_parse(e){let t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:cQ.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let r=e;for(let e of t.getFlattenedFilters())vX(r,e),r=dm(r,e)}(e._query,t),new yz(e.firestore,e.converter,dm(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}function vL(...e){return e.forEach(e=>vZ("or",e)),vO._create("or",e)}function vV(...e){return e.forEach(e=>vZ("and",e)),vO._create("and",e)}class vF extends vN{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new vF(e,t)}_apply(e){var t;let r,n=function(e,t,r){if(null!==e.startAt)throw new l4(l3.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new l4(l3.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new cK(t,r)}(e._query,this._field,this._direction);return new yz(e.firestore,e.converter,(t=e._query,r=t.explicitOrderBy.concat([n]),new dl(t.path,t.collectionGroup,r,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))}}function vj(e,t="asc"){let r=vp("orderBy",e);return vF._create(r,t)}class vU extends vN{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new vU(e,t,r)}_apply(e){return new yz(e.firestore,e.converter,dg(e._query,this._limit,this._limitType))}}function vB(e){return uT("limit",e),vU._create("limit",e,"F")}function vz(e){return uT("limitToLast",e),vU._create("limitToLast",e,"L")}class vq extends vN{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new vq(e,t,r)}_apply(e){var t;let r=vQ(e,this.type,this._docOrFields,this._inclusive);return new yz(e.firestore,e.converter,(t=e._query,new dl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,r,t.endAt)))}}function v$(...e){return vq._create("startAt",e,!0)}function vG(...e){return vq._create("startAfter",e,!1)}class vK extends vN{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new vK(e,t,r)}_apply(e){var t;let r=vQ(e,this.type,this._docOrFields,this._inclusive);return new yz(e.firestore,e.converter,(t=e._query,new dl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,r)))}}function vH(...e){return vK._create("endBefore",e,!1)}function vW(...e){return vK._create("endAt",e,!0)}function vQ(e,t,r,n){if(r[0]=oz(r[0]),r[0]instanceof vk)return function(e,t,r,n,i){if(!n)throw new l4(l3.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${r}().`);let s=[];for(let r of dd(e))if(r.field.isKeyField())s.push(cA(t,n.key));else{let e=n.data.field(r.field);if(ch(e))throw new l4(l3.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+r.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===e){let e=r.field.canonicalString();throw new l4(l3.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${e}' (used as the orderBy) does not exist.`)}s.push(e)}return new cq(s,i)}(e._query,e.firestore._databaseId,t,r[0]._document,n);{let i=vr(e.firestore);return function(e,t,r,n,i,s){let a=e.explicitOrderBy;if(i.length>a.length)throw new l4(l3.INVALID_ARGUMENT,`Too many arguments provided to ${n}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let o=[];for(let s=0;s<i.length;s++){let l=i[s];if(a[s].field.isKeyField()){if("string"!=typeof l)throw new l4(l3.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${n}(), but got a ${typeof l}`);if(!dc(e)&&-1!==l.indexOf("/"))throw new l4(l3.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${n}() must be a plain document ID, but '${l}' contains a slash.`);let r=e.path.child(uf.fromString(l));if(!ug.isDocumentKey(r))throw new l4(l3.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${n}() must result in a valid document path, but '${r}' is not because it contains an odd number of segments.`);let i=new ug(r);o.push(cA(t,i))}else{let e=vu(r,n,l);o.push(e)}}return new cq(o,s)}(e._query,e.firestore._databaseId,i,t,r,n)}}function vJ(e,t,r){if("string"==typeof(r=oz(r))){if(""===r)throw new l4(l3.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!dc(t)&&-1!==r.indexOf("/"))throw new l4(l3.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);let n=t.path.child(uf.fromString(r));if(!ug.isDocumentKey(n))throw new l4(l3.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return cA(e,new ug(n))}if(r instanceof yq)return cA(e,r._key);throw new l4(l3.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ux(r)}.`)}function vY(e,t){if(!Array.isArray(e)||0===e.length)throw new l4(l3.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function vX(e,t){let r=function(e,t){for(let r of e)for(let e of r.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==r)throw r===t.op?new l4(l3.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new l4(l3.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${r.toString()}' filters.`)}function vZ(e,t){if(!(t instanceof vR||t instanceof vO))throw new l4(l3.INVALID_ARGUMENT,`Function ${e}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}function v0(e,t,r){return e?r&&(r.merge||r.mergeFields)?e.toFirestore(t,r):e.toFirestore(t):t}class v1 extends vw{constructor(e){super(),this.firestore=e}convertBytes(e){return new y1(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new yq(this.firestore,null,t)}}function v2(e){return new vS("sum",vp("sum",e))}function v5(e){return new vS("avg",vp("average",e))}function v6(){return new vS("count")}function v3(e,t){return e instanceof vS&&t instanceof vS&&e.aggregateType===t.aggregateType&&e._internalFieldPath?.canonicalString()===t._internalFieldPath?.canonicalString()}function v4(e,t){return yH(e.query,t.query)&&oM(e.data(),t.data())}function v8(e){return v7(e,{count:v6()})}function v7(e,t){var r;let n,i=uI(e.firestore,yX),s=yZ(i),a=function(e,t){let r=[];for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.push(t(e[n],n,e));return r}(t,(e,t)=>new fe(t,e.aggregateType,e._internalFieldPath));return(r=e._query,n=new l8,s.asyncQueue.enqueueAndForget(async()=>{try{let e=await yR(s);n.resolve(async function(e,t,r){let{request:n,gt:i,parent:s}=function(e,t,r,n){let{ft:i,parent:s}=fz(e,t),a={},o=[],l=0;return r.forEach(e=>{let t="aggregate_"+l++;a[t]=e.alias,"count"===e.aggregateType?o.push({alias:t,count:{}}):"avg"===e.aggregateType?o.push({alias:t,avg:{field:f$(e.fieldPath)}}):"sum"===e.aggregateType&&o.push({alias:t,sum:{field:f$(e.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:o,structuredQuery:i.structuredQuery},parent:i.parent},gt:a,parent:s}}(e.serializer,(t.Re||(t.Re=dp(t,t.explicitOrderBy)),t.Re),r);e.connection.Ko||delete n.parent;let a=(await e.jo("RunAggregationQuery",e.serializer.databaseId,s,n,1)).filter(e=>!!e.result);l6(1===a.length,64727);let o=a[0].result?.aggregateFields;return Object.keys(o).reduce((e,t)=>(e[i[t]]=o[t],e),{})}(e,r,a))}catch(e){n.reject(e)}}),n.promise).then(t=>new v_(e,new vb(i),t))}class v9{constructor(e){this.kind="memory",this._onlineComponentProvider=yv.provider,this._offlineComponentProvider=e?.garbageCollector?e.garbageCollector._offlineComponentProvider:{build:()=>new ym(void 0)}}toJSON(){return{kind:this.kind}}}class we{constructor(e){let t;this.kind="persistent",e?.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=wu(void 0))._initialize(e),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class wt{constructor(){this.kind="memoryEager",this._offlineComponentProvider=yp.provider}toJSON(){return{kind:this.kind}}}class wr{constructor(e){this.kind="memoryLru",this._offlineComponentProvider={build:()=>new ym(e)}}toJSON(){return{kind:this.kind}}}function wn(){return new wt}function wi(e){return new wr(e?.cacheSizeBytes)}function ws(e){return new v9(e)}function wa(e){return new we(e)}class wo{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=yv.provider,this._offlineComponentProvider={build:t=>new yg(t,e?.cacheSizeBytes,this.forceOwnership)}}}class wl{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=yv.provider,this._offlineComponentProvider={build:t=>new yy(t,e?.cacheSizeBytes)}}}function wu(e){return new wo(e?.forceOwnership)}function wh(){return new wl}let wc="NOT SUPPORTED";class wd{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class wf extends vk{constructor(e,t,r,n,i,s){super(e,t,r,n,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new wm(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(vp("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new l4(l3.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};return t.type=wf._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),e&&e.isValidDocument()&&e.isFoundDocument()&&(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),this._firestore,this.ref.path,t.bundle="NOT SUPPORTED"),t}}function wp(e,t,r){if(uS(t,wf._jsonSchema)){var n;if(t.bundle===wc)throw new l4(l3.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");let i=mW(e._databaseId),s=(n=t.bundle,new yI(n,i)),a=s.t(),o=new gV(s.getMetadata(),i);for(let e of a)o.o(e);let l=o.documents;if(1!==l.length)throw new l4(l3.INVALID_ARGUMENT,`Expected bundle data to contain 1 document, but it contains ${l.length} documents.`);let u=fF(i,l[0].document),h=new ug(uf.fromString(t.bundleName));return new wf(e,new v1(e),h,u,new wd(!1,!1),r||null)}}wf._jsonSchemaVersion="firestore/documentSnapshot/1.0",wf._jsonSchema={type:uE("string",wf._jsonSchemaVersion),bundleSource:uE("string","DocumentSnapshot"),bundleName:uE("string"),bundle:uE("string")};class wm extends wf{data(e={}){return super.data(e)}}class wg{constructor(e,t,r,n){this._firestore=e,this._userDataWriter=t,this._snapshot=n,this.metadata=new wd(n.hasPendingWrites,n.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new wm(this._firestore,this._userDataWriter,r.key,r,new wd(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new l4(l3.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(r=>{let n=new wm(e._firestore,e._userDataWriter,r.doc.key,r.doc,new wd(e._snapshot.mutatedKeys.has(r.doc.key),e._snapshot.fromCache),e.query.converter);return r.doc,{type:"added",doc:n,oldIndex:-1,newIndex:t++}})}{let r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{let n=new wm(e._firestore,e._userDataWriter,t.doc.key,t.doc,new wd(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),i=-1,s=-1;return 0!==t.type&&(i=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(s=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:function(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return l2(61501,{type:e})}}(t.type),doc:n,oldIndex:i,newIndex:s}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new l4(l3.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=wg._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=ua.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let t=[],r=[],n=[];return this.docs.forEach(e=>{null!==e._document&&(t.push(e._document),r.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,"previous")),n.push(e.ref.path))}),this._firestore,this.query._query,e.bundleName,e.bundle="NOT SUPPORTED",e}}function wy(e,t,r){if(uS(t,wg._jsonSchema)){var n;if(t.bundle===wc)throw new l4(l3.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");let i=mW(e._databaseId),s=(n=t.bundle,new yI(n,i)),a=s.t(),o=new gV(s.getMetadata(),i);for(let e of a)o.o(e);if(1!==o.queries.length)throw new l4(l3.INVALID_ARGUMENT,`Snapshot data expected 1 query but found ${o.queries.length} queries.`);let l=f5(o.queries[0].bundledQuery),u=o.documents,h=new gT;u.map(e=>{let t=fF(i,e.document);h=h.add(t)});let c=gS.fromInitialDocuments(l,h,dN(),!1,!1),d=new yz(e,r||null,l);return new wg(e,new v1(e),d,c)}}function wv(e,t){return e instanceof wf&&t instanceof wf?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof wg&&t instanceof wg&&e._firestore===t._firestore&&yH(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}wg._jsonSchemaVersion="firestore/querySnapshot/1.0",wg._jsonSchema={type:uE("string",wg._jsonSchemaVersion),bundleSource:uE("string","QuerySnapshot"),bundleName:uE("string"),bundle:uE("string")};let ww={maxAttempts:5};class wb{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=vr(e)}set(e,t,r){this._verifyNotCommitted();let n=wx(e,this._firestore),i=v0(n.converter,t,r),s=vn(this._dataReader,"WriteBatch.set",n._key,i,null!==n.converter,r);return this._mutations.push(s.toMutation(n._key,dW.none())),this}update(e,t,r,...n){let i;this._verifyNotCommitted();let s=wx(e,this._firestore);return i="string"==typeof(t=oz(t))||t instanceof y2?vl(this._dataReader,"WriteBatch.update",s._key,t,r,n):vo(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(i.toMutation(s._key,dW.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=wx(e,this._firestore);return this._mutations=this._mutations.concat(new d3(t._key,dW.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new l4(l3.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function wx(e,t){if((e=oz(e)).firestore!==t)throw new l4(l3.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}class wI{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=vr(e)}get(e){let t=wx(e,this._firestore),r=new v1(this._firestore);return this._transaction.lookup([t._key]).then(e=>{if(!e||1!==e.length)return l2(24041);let n=e[0];if(n.isFoundDocument())return new vk(this._firestore,r,n.key,n,t.converter);if(n.isNoDocument())return new vk(this._firestore,r,t._key,null,t.converter);throw l2(18433,{doc:n})})}set(e,t,r){let n=wx(e,this._firestore),i=v0(n.converter,t,r),s=vn(this._dataReader,"Transaction.set",n._key,i,null!==n.converter,r);return this._transaction.set(n._key,s),this}update(e,t,r,...n){let i,s=wx(e,this._firestore);return i="string"==typeof(t=oz(t))||t instanceof y2?vl(this._dataReader,"Transaction.update",s._key,t,r,n):vo(this._dataReader,"Transaction.update",s._key,t),this._transaction.update(s._key,i),this}delete(e){let t=wx(e,this._firestore);return this._transaction.delete(t._key),this}}class wT extends wI{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=wx(e,this._firestore),r=new vb(this._firestore);return super.get(e).then(e=>new wf(this._firestore,r,t._key,e._document,new wd(!1,!1),t.converter))}}function wE(e,t,r){var n,i;let s;e=uI(e,yX);let a={...ww,...r};if(a.maxAttempts<1)throw new l4(l3.INVALID_ARGUMENT,"Max attempts must be at least 1");return n=yZ(e),i=r=>t(new wT(e,r)),s=new l8,n.asyncQueue.enqueueAndForget(async()=>{let e=await yR(n);new yE(n.asyncQueue,e,a,i,s).ju()}),s.promise}function wS(e){e=uI(e,yq);let t=uI(e.firestore,yX);return yO(yZ(t),e._key).then(r=>wj(t,e,r))}function w_(e){var t;let r;e=uI(e,yq);let n=uI(e.firestore,yX),i=yZ(n),s=new vb(n);return(t=e._key,r=new l8,i.asyncQueue.enqueueAndForget(async()=>(async function(e,t,r){try{let n=await e.persistence.runTransaction("read document","readonly",r=>e.localDocuments.getDocument(r,t));n.isFoundDocument()?r.resolve(n):n.isNoDocument()?r.resolve(null):r.reject(new l4(l3.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(n){let e=gI(n,`Failed to get document '${t} from cache`);r.reject(e)}})(await yN(i),t,r)),r.promise).then(t=>new wf(n,s,e._key,t,new wd(null!==t&&t.hasLocalMutations,!0),e.converter))}function wk(e){e=uI(e,yq);let t=uI(e.firestore,yX);return yO(yZ(t),e._key,{source:"server"}).then(r=>wj(t,e,r))}function wC(e){e=uI(e,yz);let t=uI(e.firestore,yX),r=yZ(t),n=new vb(t);return vA(e._query),yL(r,e._query).then(r=>new wg(t,n,e,r))}function wA(e){var t;let r;e=uI(e,yz);let n=uI(e.firestore,yX),i=yZ(n),s=new vb(n);return(t=e._query,r=new l8,i.asyncQueue.enqueueAndForget(async()=>(async function(e,t,r){try{let n=await mp(e,t,!0),i=new gB(t,n.ks),s=i.ru(n.documents),a=i.applyChanges(s,!1);r.resolve(a.snapshot)}catch(n){let e=gI(n,`Failed to execute query '${t} against cache`);r.reject(e)}})(await yN(i),t,r)),r.promise).then(t=>new wg(n,s,e,t))}function wD(e){e=uI(e,yz);let t=uI(e.firestore,yX),r=yZ(t),n=new vb(t);return yL(r,e._query,{source:"server"}).then(r=>new wg(t,n,e,r))}function wN(e,t,r){e=uI(e,yq);let n=uI(e.firestore,yX),i=v0(e.converter,t,r),s=vr(n);return wF(n,[vn(s,"setDoc",e._key,i,null!==e.converter,r).toMutation(e._key,dW.none())])}function wP(e,t,r,...n){e=uI(e,yq);let i=uI(e.firestore,yX),s=vr(i);return wF(i,[("string"==typeof(t=oz(t))||t instanceof y2?vl(s,"updateDoc",e._key,t,r,n):vo(s,"updateDoc",e._key,t)).toMutation(e._key,dW.exists(!0))])}function wR(e){return wF(uI(e.firestore,yX),[new d3(e._key,dW.none())])}function wM(e,t){let r=uI(e.firestore,yX),n=yK(e),i=v0(e.converter,t);return wF(r,[vn(vr(e.firestore),"addDoc",n._key,i,null!==e.converter,{}).toMutation(n._key,dW.exists(!1))]).then(()=>n)}function wO(e,...t){var r;let n,i,s,a,o;e=oz(e);let l={includeMetadataChanges:!1,source:"default"},u=0;"object"!=typeof t[0]||vE(t[u])||(l=t[u++]);let h={includeMetadataChanges:l.includeMetadataChanges,source:l.source};if(vE(t[u])){let e=t[u];t[u]=e.next?.bind(e),t[u+1]=e.error?.bind(e),t[u+2]=e.complete?.bind(e)}if(e instanceof yq)i=uI(e.firestore,yX),s=du(e._key.path),n={next:r=>{t[u]&&t[u](wj(i,e,r))},error:t[u+1],complete:t[u+2]};else{let r=uI(e,yz);i=uI(r.firestore,yX),s=r._query;let a=new vb(i);n={next:e=>{t[u]&&t[u](new wg(i,a,r,e))},error:t[u+1],complete:t[u+2]},vA(e._query)}return r=yZ(i),o=new gM(s,a=new yb(n),h),r.asyncQueue.enqueueAndForget(async()=>gA(await yM(r),o)),()=>{a.Nu(),r.asyncQueue.enqueueAndForget(async()=>gD(await yM(r),o))}}function wL(e,t,...r){var n,i,s,a,o,l;let u=oz(e),h=function(e){let t={bundle:"",bundleName:"",bundleSource:""};for(let r of["bundle","bundleName","bundleSource"]){if(!(r in e)){t.error=`snapshotJson missing required field: ${r}`;break}let n=e[r];if("string"!=typeof n){t.error=`snapshotJson field '${r}' must be a string.`;break}if(0===n.length){t.error=`snapshotJson field '${r}' cannot be an empty string.`;break}"bundle"===r?t.bundle=n:"bundleName"===r?t.bundleName=n:"bundleSource"===r&&(t.bundleSource=n)}return t}(t);if(h.error)throw new l4(l3.INVALID_ARGUMENT,h.error);let c,d=0;if("object"!=typeof r[0]||vE(r[d])||(c=r[d++]),"QuerySnapshot"===h.bundleSource){let e,t,a=null;if("object"==typeof r[d]&&vE(r[d])){let e=r[d++];a={next:e.next,error:e.error,complete:e.complete}}else a={next:r[d++],error:r[d++],complete:r[d++]};return n=c,i=a,s=r[d],t=!1,y0(u,h.bundle).then(()=>{var e,t,r;return e=u,t=h.bundleName,(r=yZ(e=uI(e,yX)),r.asyncQueue.enqueue(async()=>{var e;return e=await yN(r),e.persistence.runTransaction("Get named query","readonly",r=>e.Pi.getNamedQuery(r,t))})).then(t=>t?new yz(e,null,t.query):null)}).then(r=>{r&&!t&&(s&&r.withConverter(s),e=wO(r,n||{},i))}).catch(e=>(i.error&&i.error(e),()=>{})),()=>{t||(t=!0,e&&e())}}if("DocumentSnapshot"===h.bundleSource){let e,t,n=null;if("object"==typeof r[d]&&vE(r[d])){let e=r[d++];n={next:e.next,error:e.error,complete:e.complete}}else n={next:r[d++],error:r[d++],complete:r[d++]};return a=c,o=n,l=r[d],t=!1,y0(u,h.bundle).then(()=>{t||(e=wO(new yq(u,l||null,ug.fromPath(h.bundleName)),a||{},o))}).catch(e=>(o.error&&o.error(e),()=>{})),()=>{t||(t=!0,e&&e())}}throw new l4(l3.INVALID_ARGUMENT,`unsupported bundle source: ${h.bundleSource}`)}function wV(e,t){let r,n=yZ(e=uI(e,yX));return r=new yb(vE(t)?t:{next:t}),n.asyncQueue.enqueueAndForget(async()=>{var e;return e=await yM(n),void(e.Ca.add(r),r.next())}),()=>{r.Nu(),n.asyncQueue.enqueueAndForget(async()=>{var e;return e=await yM(n),void e.Ca.delete(r)})}}function wF(e,t){var r;let n;return r=yZ(e),n=new l8,r.asyncQueue.enqueueAndForget(async()=>gX(await yP(r),t,n)),n.promise}function wj(e,t,r){let n=r.docs.get(t._key),i=new vb(e);return new wf(e,i,t._key,n,new wd(r.hasPendingWrites,r.fromCache),t.converter)}function wU(e){return yZ(e=uI(e,yX)),new wb(e,t=>wF(e,t))}function wB(e,t){let r=yZ(e=uI(e,yX));if(!r._uninitializedComponentsProvider||"memory"===r._uninitializedComponentsProvider._offline.kind)return l0("Cannot enable indexes when persistence is disabled"),Promise.resolve();let n=function(e){let t="string"==typeof e?function(e){try{return JSON.parse(e)}catch(e){throw new l4(l3.INVALID_ARGUMENT,"Failed to parse JSON: "+e?.message)}}(e):e,r=[];if(Array.isArray(t.indexes))for(let e of t.indexes){let t=wz(e,"collectionGroup"),n=[];if(Array.isArray(e.fields))for(let t of e.fields){let e=vg("setIndexConfiguration",wz(t,"fieldPath"));"CONTAINS"===t.arrayConfig?n.push(new uP(e,2)):"ASCENDING"===t.order?n.push(new uP(e,0)):"DESCENDING"===t.order&&n.push(new uP(e,1))}r.push(new uC(uC.UNKNOWN_ID,t,n,uR.empty()))}return r}(t);return r.asyncQueue.enqueue(async()=>(async function(e,t){let r=e.indexManager,n=[];return e.persistence.runTransaction("Configure indexes","readwrite",e=>r.getFieldIndexes(e).next(i=>(function(e,t,r,n,i){t=[...t],(e=[...e]).sort(r),t.sort(r);let s=e.length,a=t.length,o=0,l=0;for(;o<a&&l<s;){let s=r(e[l],t[o]);s<0?i(e[l++]):s>0?n(t[o++]):(o++,l++)}for(;o<a;)n(t[o++]);for(;l<s;)i(e[l++])})(i,t,uN,t=>{n.push(r.addFieldIndex(e,t))},t=>{n.push(r.deleteFieldIndex(e,t))})).next(()=>uB.waitFor(n)))})(await yN(r),n))}function wz(e,t){if("string"!=typeof e[t])throw new l4(l3.INVALID_ARGUMENT,"Missing string value for: "+t);return e[t]}class wq{constructor(e){this._firestore=e,this.type="PersistentCacheIndexManager"}}function w$(e){e=uI(e,yX);let t=wQ.get(e);if(t)return t;let r=yZ(e);if("persistent"!==r._uninitializedComponentsProvider?._offline.kind)return null;let n=new wq(e);return wQ.set(e,n),n}function wG(e){wW(e,!0)}function wK(e){wW(e,!1)}function wH(e){var t;(t=yZ(e._firestore)).asyncQueue.enqueue(async()=>{var e;let r;return r=(e=await yN(t)).indexManager,e.persistence.runTransaction("Delete All Indexes","readwrite",e=>r.deleteAllFieldIndexes(e))}).then(e=>lX("deleting all persistent cache indexes succeeded")).catch(e=>l0("deleting all persistent cache indexes failed",e))}function wW(e,t){var r;(r=yZ(e._firestore),r.asyncQueue.enqueue(async()=>{var e;return e=await yN(r),void(e.Cs.As=t)})).then(e=>lX(`setting persistent cache index auto creation isEnabled=${t} succeeded`)).catch(e=>l0(`setting persistent cache index auto creation isEnabled=${t} failed`,e))}let wQ=new WeakMap;class wJ{constructor(){throw Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return wY.instance.onExistenceFilterMismatch(e)}}class wY{constructor(){this.i=new Map}static get instance(){return wX||function(e){if(fi)throw Error("a TestingHooksSpi instance is already set");fi=e}(wX=new wY),wX}u(e){this.i.forEach(t=>t(e))}onExistenceFilterMismatch(e){let t=Symbol(),r=this.i;return r.set(t,e),()=>r.delete(t)}}let wX=null;function wZ(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}!function(e=!0){lQ=lE,lf(new oq("firestore",(t,{instanceIdentifier:r,options:n})=>{let i=t.getProvider("app").getImmediate(),s=new yX(new ut(t.getProvider("auth-internal")),new us(i,t.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new l4(l3.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new cm(e.options.projectId,t)}(i,r),i);return n={useFetchStreams:e,...n},s._setSettings(n),s},"PUBLIC").setMultipleInstances(!0)),lD(vI,vT,void 0),lD(vI,vT,"esm2020")}(),e.s(["AggregateField",()=>vS,"AggregateQuerySnapshot",()=>v_,"DocumentSnapshot",()=>wf,"PersistentCacheIndexManager",()=>wq,"QueryCompositeFilterConstraint",()=>vO,"QueryConstraint",()=>vN,"QueryDocumentSnapshot",()=>wm,"QueryEndAtConstraint",()=>vK,"QueryFieldFilterConstraint",()=>vR,"QueryLimitConstraint",()=>vU,"QueryOrderByConstraint",()=>vF,"QuerySnapshot",()=>wg,"QueryStartAtConstraint",()=>vq,"SnapshotMetadata",()=>wd,"Transaction",()=>wT,"WriteBatch",()=>wb,"_TestingHooks",()=>wJ,"addDoc",()=>wM,"aggregateFieldEqual",()=>v3,"aggregateQuerySnapshotEqual",()=>v4,"and",()=>vV,"average",()=>v5,"count",()=>v6,"deleteAllPersistentCacheIndexes",()=>wH,"deleteDoc",()=>wR,"disablePersistentCacheIndexAutoCreation",()=>wK,"documentSnapshotFromJSON",()=>wp,"enablePersistentCacheIndexAutoCreation",()=>wG,"endAt",()=>vW,"endBefore",()=>vH,"executeWrite",()=>wF,"getAggregateFromServer",()=>v7,"getCountFromServer",()=>v8,"getDoc",()=>wS,"getDocFromCache",()=>w_,"getDocFromServer",()=>wk,"getDocs",()=>wC,"getDocsFromCache",()=>wA,"getDocsFromServer",()=>wD,"getPersistentCacheIndexManager",()=>w$,"limit",()=>vB,"limitToLast",()=>vz,"memoryEagerGarbageCollector",()=>wn,"memoryLocalCache",()=>ws,"memoryLruGarbageCollector",()=>wi,"onSnapshot",()=>wO,"onSnapshotResume",()=>wL,"onSnapshotsInSync",()=>wV,"or",()=>vL,"orderBy",()=>vj,"persistentLocalCache",()=>wa,"persistentMultipleTabManager",()=>wh,"persistentSingleTabManager",()=>wu,"query",()=>vP,"querySnapshotFromJSON",()=>wy,"runTransaction",()=>wE,"setDoc",()=>wN,"setIndexConfiguration",()=>wB,"snapshotEqual",()=>wv,"startAfter",()=>vG,"startAt",()=>v$,"sum",()=>v2,"updateDoc",()=>wP,"where",()=>vM,"writeBatch",()=>wU],63802),e.i(63802);let w0=new oP("auth","Firebase",wZ()),w1=new oX("@firebase/auth");function w2(e,...t){w1.logLevel<=p.ERROR&&w1.error(`Auth (${lE}): ${e}`,...t)}function w5(e,...t){throw w8(e,...t)}function w6(e,...t){return w8(e,...t)}function w3(e,t,r){return new oP("auth","Firebase",{...wZ(),[t]:r}).create(t,{appName:e.name})}function w4(e){return w3(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function w8(e,...t){if("string"!=typeof e){let r=t[0],n=[...t.slice(1)];return n[0]&&(n[0].appName=e.name),e._errorFactory.create(r,...n)}return w0.create(e,...t)}function w7(e,t,...r){if(!e)throw w8(t,...r)}function w9(e){let t="INTERNAL ASSERTION FAILED: "+e;throw w2(t),Error(t)}function be(){return"u">typeof self&&self.location?.href||""}function bt(){return"u">typeof self&&self.location?.protocol||null}class br{constructor(e,t){var r;this.shortDelay=e,this.longDelay=t,r="Short delay should be less than long delay!",t>e||w9(r),this.isMobile="u">typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(oI())||"object"==typeof navigator&&"ReactNative"===navigator.product}get(){return!("u">typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===bt()||"https:"===bt()||oS()||"connection"in navigator))||navigator.onLine?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function bn(e,t){var r,n;r=e.emulator,n="Emulator should always be set here",r||w9(n);let{url:i}=e.emulator;return t?`${i}${t.startsWith("/")?t.slice(1):t}`:i}class bi{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){return this.fetchImpl?this.fetchImpl:"u">typeof self&&"fetch"in self?self.fetch:"u">typeof globalThis&&globalThis.fetch?globalThis.fetch:"u">typeof fetch?fetch:void w9("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"u">typeof self&&"Headers"in self?self.Headers:"u">typeof globalThis&&globalThis.Headers?globalThis.Headers:"u">typeof Headers?Headers:void w9("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"u">typeof self&&"Response"in self?self.Response:"u">typeof globalThis&&globalThis.Response?globalThis.Response:"u">typeof Response?Response:void w9("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}let bs={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},ba=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],bo=new br(3e4,6e4);function bl(e,t){return e.tenantId&&!t.tenantId?{...t,tenantId:e.tenantId}:t}async function bu(e,t,r,n,i={}){return bh(e,i,async()=>{let i={},s={};n&&("GET"===t?s=n:i={body:JSON.stringify(n)});let a=oL({key:e.config.apiKey,...s}).slice(1),o=await e._getAdditionalHeaders();o["Content-Type"]="application/json",e.languageCode&&(o["X-Firebase-Locale"]=e.languageCode);let l={method:t,headers:o,...i};return"u">typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(l.referrerPolicy="no-referrer"),e.emulatorConfig&&oy(e.emulatorConfig.host)&&(l.credentials="include"),bi.fetch()(await bd(e,e.config.apiHost,r,a),l)})}async function bh(e,t,r){e._canInitEmulator=!1;let n={...bs,...t};try{let t=new bf(e),i=await Promise.race([r(),t.promise]);t.clearNetworkTimeout();let s=await i.json();if("needConfirmation"in s)throw bp(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{let[t,r]=(i.ok?s.errorMessage:s.error.message).split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===t)throw bp(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===t)throw bp(e,"email-already-in-use",s);if("USER_DISABLED"===t)throw bp(e,"user-disabled",s);let a=n[t]||t.toLowerCase().replace(/[_\s]+/g,"-");if(r)throw w3(e,a,r);w5(e,a)}}catch(t){if(t instanceof oN)throw t;w5(e,"network-request-failed",{message:String(t)})}}async function bc(e,t,r,n,i={}){let s=await bu(e,t,r,n,i);return"mfaPendingCredential"in s&&w5(e,"multi-factor-auth-required",{_serverResponse:s}),s}async function bd(e,t,r,n){let i=`${t}${r}?${n}`,s=e.config.emulator?bn(e.config,i):`${e.config.apiScheme}://${i}`;return ba.includes(r)&&(await e._persistenceManagerAvailable,"COOKIE"===e._getPersistenceType())?e._getPersistence()._getFinalTarget(s).toString():s}class bf{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(w6(this.auth,"network-request-failed")),bo.get())})}}function bp(e,t,r){let n={appName:e.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);let i=w6(e,t,n);return i.customData._tokenResponse=r,i}function bm(e){return void 0!==e&&void 0!==e.enterprise}class bg{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)switch(t.enforcementState){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function by(e,t){return bu(e,"GET","/v2/recaptchaConfig",bl(e,t))}async function bv(e,t){return bu(e,"POST","/v1/accounts:delete",t)}async function bw(e,t){return bu(e,"POST","/v1/accounts:lookup",t)}function bb(e){if(e)try{let t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}async function bx(e,t=!1){let r=oz(e),n=await r.getIdToken(t),i=bT(n);w7(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");let s="object"==typeof i.firebase?i.firebase:void 0,a=s?.sign_in_provider;return{claims:i,token:n,authTime:bb(bI(i.auth_time)),issuedAtTime:bb(bI(i.iat)),expirationTime:bb(bI(i.exp)),signInProvider:a||null,signInSecondFactor:s?.sign_in_second_factor||null}}function bI(e){return 1e3*Number(e)}function bT(e){let[t,r,n]=e.split(".");if(void 0===t||void 0===r||void 0===n)return w2("JWT malformed, contained fewer than 3 sections"),null;try{let e=oh(r);if(!e)return w2("Failed to decode base64 JWT payload"),null;return JSON.parse(e)}catch(e){return w2("Caught error parsing JWT payload as JSON",e?.toString()),null}}function bE(e){let t=bT(e);return w7(t,"internal-error"),w7(void 0!==t.exp,"internal-error"),w7(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function bS(e,t,r=!1){if(r)return t;try{return await t}catch(t){throw t instanceof oN&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}class b_{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){if(!e)return this.errorBackoff=3e4,Math.max(0,(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5);{let e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class bk{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=bb(this.lastLoginAt),this.creationTime=bb(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function bC(e){var t,r;let n=e.auth,i=await e.getIdToken(),s=await bS(e,bw(n,{idToken:i}));w7(s?.users.length,n,"internal-error");let a=s.users[0];e._notifyReloadListener(a);let o=a.providerUserInfo?.length?bD(a.providerUserInfo):[],l=(t=e.providerData,r=o,[...t.filter(e=>!r.some(t=>t.providerId===e.providerId)),...r]),u=e.isAnonymous,h=!(e.email&&a.passwordHash)&&!l?.length;Object.assign(e,{uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new bk(a.createdAt,a.lastLoginAt),isAnonymous:!!u&&h})}async function bA(e){let t=oz(e);await bC(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function bD(e){return e.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function bN(e,t){let r=await bh(e,{},async()=>{let r=oL({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:n,apiKey:i}=e.config,s=await bd(e,n,"/v1/token",`key=${i}`),a=await e._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";let o={method:"POST",headers:a,body:r};return e.emulatorConfig&&oy(e.emulatorConfig.host)&&(o.credentials="include"),bi.fetch()(s,o)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function bP(e,t){return bu(e,"POST","/v2/accounts:revokeToken",bl(e,t))}class bR{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){w7(e.idToken,"internal-error"),w7(void 0!==e.idToken,"internal-error"),w7(void 0!==e.refreshToken,"internal-error");let t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):bE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){w7(0!==e.length,"internal-error");let t=bE(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return t||!this.accessToken||this.isExpired?(w7(this.refreshToken,e,"user-token-expired"),this.refreshToken)?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){let{accessToken:r,refreshToken:n,expiresIn:i}=await bN(e,t);this.updateTokensAndExpiration(r,n,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*r}static fromJSON(e,t){let{refreshToken:r,accessToken:n,expirationTime:i}=t,s=new bR;return r&&(w7("string"==typeof r,"internal-error",{appName:e}),s.refreshToken=r),n&&(w7("string"==typeof n,"internal-error",{appName:e}),s.accessToken=n),i&&(w7("number"==typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new bR,this.toJSON())}_performRefresh(){return w9("not implemented")}}function bM(e,t){w7("string"==typeof e||void 0===e,"internal-error",{appName:t})}class bO{constructor({uid:e,auth:t,stsTokenManager:r,...n}){this.providerId="firebase",this.proactiveRefresh=new b_(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=n.displayName||null,this.email=n.email||null,this.emailVerified=n.emailVerified||!1,this.phoneNumber=n.phoneNumber||null,this.photoURL=n.photoURL||null,this.isAnonymous=n.isAnonymous||!1,this.tenantId=n.tenantId||null,this.providerData=n.providerData?[...n.providerData]:[],this.metadata=new bk(n.createdAt||void 0,n.lastLoginAt||void 0)}async getIdToken(e){let t=await bS(this,this.stsTokenManager.getToken(this.auth,e));return w7(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return bx(this,e)}reload(){return bA(this)}_assign(e){this!==e&&(w7(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>({...e})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new bO({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){w7(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await bC(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(lv(this.auth.app))return Promise.reject(w4(this.auth));let e=await this.getIdToken();return await bS(this,bv(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){let r=t.displayName??void 0,n=t.email??void 0,i=t.phoneNumber??void 0,s=t.photoURL??void 0,a=t.tenantId??void 0,o=t._redirectEventId??void 0,l=t.createdAt??void 0,u=t.lastLoginAt??void 0,{uid:h,emailVerified:c,isAnonymous:d,providerData:f,stsTokenManager:p}=t;w7(h&&p,e,"internal-error");let m=bR.fromJSON(this.name,p);w7("string"==typeof h,e,"internal-error"),bM(r,e.name),bM(n,e.name),w7("boolean"==typeof c,e,"internal-error"),w7("boolean"==typeof d,e,"internal-error"),bM(i,e.name),bM(s,e.name),bM(a,e.name),bM(o,e.name),bM(l,e.name),bM(u,e.name);let g=new bO({uid:h,auth:e,email:n,emailVerified:c,displayName:r,isAnonymous:d,photoURL:s,phoneNumber:i,tenantId:a,stsTokenManager:m,createdAt:l,lastLoginAt:u});return f&&Array.isArray(f)&&(g.providerData=f.map(e=>({...e}))),o&&(g._redirectEventId=o),g}static async _fromIdTokenResponse(e,t,r=!1){let n=new bR;n.updateFromServerResponse(t);let i=new bO({uid:t.localId,auth:e,stsTokenManager:n,isAnonymous:r});return await bC(i),i}static async _fromGetAccountInfoResponse(e,t,r){let n=t.users[0];w7(void 0!==n.localId,"internal-error");let i=void 0!==n.providerUserInfo?bD(n.providerUserInfo):[],s=!(n.email&&n.passwordHash)&&!i?.length,a=new bR;a.updateFromIdToken(r);let o=new bO({uid:n.localId,auth:e,stsTokenManager:a,isAnonymous:s});return Object.assign(o,{uid:n.localId,displayName:n.displayName||null,photoURL:n.photoUrl||null,email:n.email||null,emailVerified:n.emailVerified||!1,phoneNumber:n.phoneNumber||null,tenantId:n.tenantId||null,providerData:i,metadata:new bk(n.createdAt,n.lastLoginAt),isAnonymous:!(n.email&&n.passwordHash)&&!i?.length}),o}}let bL=new Map;function bV(e){var t,r;t="Expected a class definition",e instanceof Function||w9(t);let n=bL.get(e);return n?(r="Instance stored in cache mismatched with class",n instanceof e||w9(r)):(n=new e,bL.set(e,n)),n}class bF{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){let t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}function bj(e,t,r){return`firebase:${e}:${t}:${r}`}bF.type="NONE";class bU{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:n,name:i}=this.auth;this.fullUserKey=bj(this.userKey,n.apiKey,i),this.fullPersistenceKey=bj("persistence",n.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"==typeof e){let t=await bw(this.auth,{idToken:e}).catch(()=>void 0);return t?bO._fromGetAccountInfoResponse(this.auth,t,e):null}return bO._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new bU(bV(bF),e,r);let n=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e),i=n[0]||bV(bF),s=bj(r,e.config.apiKey,e.name),a=null;for(let r of t)try{let t=await r._get(s);if(t){let n;if("string"==typeof t){let r=await bw(e,{idToken:t}).catch(()=>void 0);if(!r)break;n=await bO._fromGetAccountInfoResponse(e,r,t)}else n=bO._fromJSON(e,t);r!==i&&(a=n),i=r;break}}catch{}let o=n.filter(e=>e._shouldAllowMigration);return i._shouldAllowMigration&&o.length&&(i=o[0],a&&await i._set(s,a.toJSON()),await Promise.all(t.map(async e=>{if(e!==i)try{await e._remove(s)}catch{}}))),new bU(i,e,r)}}function bB(e){let t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";{if(bG(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(bz(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(bH(t))return"Blackberry";if(bW(t))return"Webos";if(bq(t))return"Safari";if((t.includes("chrome/")||b$(t))&&!t.includes("edge/"))return"Chrome";if(bK(t))return"Android";let r=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(r?.length===2)return r[1]}return"Other"}function bz(e=oI()){return/firefox\//i.test(e)}function bq(e=oI()){let t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function b$(e=oI()){return/crios\//i.test(e)}function bG(e=oI()){return/iemobile/i.test(e)}function bK(e=oI()){return/android/i.test(e)}function bH(e=oI()){return/blackberry/i.test(e)}function bW(e=oI()){return/webos/i.test(e)}function bQ(e=oI()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function bJ(e=oI()){return bQ(e)||bK(e)||bW(e)||bH(e)||/windows phone/i.test(e)||bG(e)}function bY(e,t=[]){let r;switch(e){case"Browser":r=bB(oI());break;case"Worker":r=`${bB(oI())}-${e}`;break;default:r=e}let n=t.length?t.join(","):"FirebaseCore-web";return`${r}/JsCore/${lE}/${n}`}class bX{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=t=>new Promise((r,n)=>{try{let n=e(t);r(n)}catch(e){n(e)}});r.onAbort=t,this.queue.push(r);let n=this.queue.length-1;return()=>{this.queue[n]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(e){for(let e of(t.reverse(),t))try{e()}catch(e){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:e?.message})}}}async function bZ(e,t={}){return bu(e,"GET","/v2/passwordPolicy",bl(e,t))}class b0{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??6,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),void 0!==t.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),void 0!==t.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),void 0!==t.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),void 0!==t.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){let t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,n=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),n&&(t.meetsMaxPasswordLength=e.length<=n)}validatePasswordCharacterOptions(e,t){let r;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let n=0;n<e.length;n++)r=e.charAt(n),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,n,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=n)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class b1{constructor(e,t,r,n){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=n,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new b2(this),this.idTokenSubscription=new b2(this),this.beforeStateQueue=new bX(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=w0,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=n.sdkClientVersion,this._persistenceManagerAvailable=new Promise(e=>this._resolvePersistenceManagerAvailable=e)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=bV(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted){if(this.persistenceManager=await bU.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(e){}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,this._deleted||(this._isInitialized=!0)}}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(this.currentUser||e){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{let t=await bw(this,{idToken:e}),r=await bO._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(lv(this.app)){let e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}let t=await this.assertedPersistence.getCurrentUser(),r=t,n=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let t=this.redirectUser?._redirectEventId,i=r?._redirectEventId,s=await this.tryRedirectSignIn(e);(!t||t===i)&&s?.user&&(r=s.user,n=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(n)try{await this.beforeStateQueue.runMiddleware(r)}catch(e){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(e))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return(w7(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId)?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await bC(e)}catch(e){if(e?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("u"<typeof navigator)return null;let e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(lv(this.app))return Promise.reject(w4(this));let t=e?oz(e):null;return t&&w7(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&w7(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return lv(this.app)?Promise.reject(w4(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return lv(this.app)?Promise.reject(w4(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(bV(e))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let e=new b0(await bZ(this));null===this.tenantId?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new oP("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){let t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await bP(this,t)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){let r=await this.getOrInitRedirectPersistenceManager(t);return null===e?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let t=e&&bV(e)||this._popupRedirectResolver;w7(t,this,"argument-error"),this.redirectPersistenceManager=await bU.create(this,[bV(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return(this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e)?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,n){if(this._deleted)return()=>{};let i="function"==typeof t?t:t.next.bind(t),s=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(w7(a,this,"internal-error"),a.then(()=>{s||i(this.currentUser)}),"function"==typeof t){let i=e.addObserver(t,r,n);return()=>{s=!0,i()}}{let r=e.addObserver(t);return()=>{s=!0,r()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return w7(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=bY(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){let e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);let t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);let r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(lv(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&function(e,...t){w1.logLevel<=p.WARN&&w1.warn(`Auth (${lE}): ${e}`,...t)}(`Error while retrieving App Check token: ${e.error}`),e?.token}}class b2{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){let r=new oj(e,void 0);return r.subscribe.bind(r)}(e=>this.observer=e)}get next(){return w7(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let b5={async loadJS(){throw Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function b6(e){return`__${e}${Math.floor(1e6*Math.random())}`}class b3{constructor(){this.enterprise=new b4}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class b4{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}let b8="NO_RECAPTCHA";class b7{constructor(e){this.type="recaptcha-enterprise",this.auth=oz(e)}async verify(e="verify",t=!1){async function r(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,r)=>{by(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(n=>{if(void 0===n.recaptchaKey)r(Error("recaptcha Enterprise site key undefined"));else{let r=new bg(n);return null==e.tenantId?e._agentRecaptchaConfig=r:e._tenantRecaptchaConfigs[e.tenantId]=r,t(r.siteKey)}}).catch(e=>{r(e)})})}function n(t,r,n){let i=window.grecaptcha;bm(i)?i.enterprise.ready(()=>{i.enterprise.execute(t,{action:e}).then(e=>{r(e)}).catch(()=>{r(b8)})}):n(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new b3().execute("siteKey",{action:"verify"}):new Promise((e,i)=>{r(this.auth).then(r=>{if(!t&&bm(window.grecaptcha))n(r,e,i);else{var s;if("u"<typeof window)return void i(Error("RecaptchaVerifier is only supported in browser"));let t=b5.recaptchaEnterpriseScript;0!==t.length&&(t+=r),(s=t,b5.loadJS(s)).then(()=>{n(r,e,i)}).catch(e=>{i(e)})}}).catch(e=>{i(e)})})}}async function b9(e,t,r,n=!1,i=!1){let s,a=new b7(e);if(i)s=b8;else try{s=await a.verify(r)}catch(e){s=await a.verify(r,!0)}let o={...t};if("mfaSmsEnrollment"===r||"mfaSmsSignIn"===r){if("phoneEnrollmentInfo"in o){let e=o.phoneEnrollmentInfo.phoneNumber,t=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){let e=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return n?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function xe(e,t,r,n,i){if("EMAIL_PASSWORD_PROVIDER"===i)if(!e._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER"))return n(e,t).catch(async i=>{if("auth/missing-recaptcha-token"!==i.code)return Promise.reject(i);{console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let i=await b9(e,t,r,"getOobCode"===r);return n(e,i)}});else{let i=await b9(e,t,r,"getOobCode"===r);return n(e,i)}if("PHONE_PROVIDER"!==i)return Promise.reject(i+" provider is not supported.");if(e._getRecaptchaConfig()?.isProviderEnabled("PHONE_PROVIDER")){let i=await b9(e,t,r);return n(e,i).catch(async i=>{if(e._getRecaptchaConfig()?.getProviderEnforcementState("PHONE_PROVIDER")==="AUDIT"&&("auth/missing-recaptcha-token"===i.code||"auth/invalid-app-credential"===i.code)){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${r} flow.`);let i=await b9(e,t,r,!1,!0);return n(e,i)}return Promise.reject(i)})}{let i=await b9(e,t,r,!1,!0);return n(e,i)}}async function xt(e){let t=oz(e),r=new bg(await by(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}));null==t.tenantId?t._agentRecaptchaConfig=r:t._tenantRecaptchaConfigs[t.tenantId]=r,r.isAnyProviderEnabled()&&new b7(t).verify()}function xr(e){let t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function xn(e){if(!e)return null;let t=Number(e);return isNaN(t)?null:t}class xi{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return w9("not implemented")}_getIdTokenResponse(e){return w9("not implemented")}_linkToIdToken(e,t){return w9("not implemented")}_getReauthenticationResolver(e){return w9("not implemented")}}async function xs(e,t){return bu(e,"POST","/v1/accounts:signUp",t)}async function xa(e,t){return bc(e,"POST","/v1/accounts:signInWithPassword",bl(e,t))}async function xo(e,t){return bc(e,"POST","/v1/accounts:signInWithEmailLink",bl(e,t))}async function xl(e,t){return bc(e,"POST","/v1/accounts:signInWithEmailLink",bl(e,t))}class xu extends xi{constructor(e,t,r,n=null){super("password",r),this._email=e,this._password=t,this._tenantId=n}static _fromEmailAndPassword(e,t){return new xu(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new xu(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t="string"==typeof e?JSON.parse(e):e;if(t?.email&&t?.password){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);else if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return xe(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",xa,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return xo(e,{email:this._email,oobCode:this._password});default:w5(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return xe(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",xs,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return xl(e,{idToken:t,email:this._email,oobCode:this._password});default:w5(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function xh(e,t){return bc(e,"POST","/v1/accounts:signInWithIdp",bl(e,t))}class xc extends xi{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new xc(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):w5("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let{providerId:t,signInMethod:r,...n}="string"==typeof e?JSON.parse(e):e;if(!t||!r)return null;let i=new xc(t,r);return i.idToken=n.idToken||void 0,i.accessToken=n.accessToken||void 0,i.secret=n.secret,i.nonce=n.nonce,i.pendingToken=n.pendingToken||null,i}_getIdTokenResponse(e){return xh(e,this.buildRequest())}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,xh(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,xh(e,t)}buildRequest(){let e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=oL(t)}return e}}async function xd(e,t){return bu(e,"POST","/v1/accounts:sendVerificationCode",bl(e,t))}async function xf(e,t){return bc(e,"POST","/v1/accounts:signInWithPhoneNumber",bl(e,t))}async function xp(e,t){let r=await bc(e,"POST","/v1/accounts:signInWithPhoneNumber",bl(e,t));if(r.temporaryProof)throw bp(e,"account-exists-with-different-credential",r);return r}let xm={USER_NOT_FOUND:"user-not-found"};async function xg(e,t){return bc(e,"POST","/v1/accounts:signInWithPhoneNumber",bl(e,{...t,operation:"REAUTH"}),xm)}class xy extends xi{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new xy({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new xy({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return xf(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return xp(e,{idToken:t,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return xg(e,this._makeVerificationRequest())}_makeVerificationRequest(){let{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:n}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:n}}toJSON(){let e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));let{verificationId:t,verificationCode:r,phoneNumber:n,temporaryProof:i}=e;return r||t||n||i?new xy({verificationId:t,verificationCode:r,phoneNumber:n,temporaryProof:i}):null}}class xv{constructor(e){const t=oV(oF(e)),r=t.apiKey??null,n=t.oobCode??null,i=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(t.mode??null);w7(r&&n&&i,"argument-error"),this.apiKey=r,this.operation=i,this.code=n,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){let t,r,n,i=(r=(t=oV(oF(e)).link)?oV(oF(t)).deep_link_id:null,((n=oV(oF(e)).deep_link_id)?oV(oF(n)).link:null)||n||r||t||e);try{return new xv(i)}catch{return null}}}class xw{constructor(){this.providerId=xw.PROVIDER_ID}static credential(e,t){return xu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){let r=xv.parseLink(t);return w7(r,"argument-error"),xu._fromEmailAndCode(e,r.code,r.tenantId)}}xw.PROVIDER_ID="password",xw.EMAIL_PASSWORD_SIGN_IN_METHOD="password",xw.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class xb{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class xx extends xb{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class xI extends xx{constructor(){super("facebook.com")}static credential(e){return xc._fromParams({providerId:xI.PROVIDER_ID,signInMethod:xI.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return xI.credentialFromTaggedObject(e)}static credentialFromError(e){return xI.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return xI.credential(e.oauthAccessToken)}catch{return null}}}xI.FACEBOOK_SIGN_IN_METHOD="facebook.com",xI.PROVIDER_ID="facebook.com";class xT extends xx{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return xc._fromParams({providerId:xT.PROVIDER_ID,signInMethod:xT.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return xT.credentialFromTaggedObject(e)}static credentialFromError(e){return xT.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return xT.credential(t,r)}catch{return null}}}xT.GOOGLE_SIGN_IN_METHOD="google.com",xT.PROVIDER_ID="google.com";class xE extends xx{constructor(){super("github.com")}static credential(e){return xc._fromParams({providerId:xE.PROVIDER_ID,signInMethod:xE.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return xE.credentialFromTaggedObject(e)}static credentialFromError(e){return xE.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return xE.credential(e.oauthAccessToken)}catch{return null}}}xE.GITHUB_SIGN_IN_METHOD="github.com",xE.PROVIDER_ID="github.com";class xS extends xx{constructor(){super("twitter.com")}static credential(e,t){return xc._fromParams({providerId:xS.PROVIDER_ID,signInMethod:xS.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return xS.credentialFromTaggedObject(e)}static credentialFromError(e){return xS.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return xS.credential(t,r)}catch{return null}}}async function x_(e,t){return bc(e,"POST","/v1/accounts:signUp",bl(e,t))}xS.TWITTER_SIGN_IN_METHOD="twitter.com",xS.PROVIDER_ID="twitter.com";class xk{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,n=!1){return new xk({user:await bO._fromIdTokenResponse(e,r,n),providerId:xC(r),_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){return await e._updateTokensIfNecessary(r,!0),new xk({user:e,providerId:xC(r),_tokenResponse:r,operationType:t})}}function xC(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}async function xA(e){if(lv(e.app))return Promise.reject(w4(e));let t=oz(e);if(await t._initializationPromise,t.currentUser?.isAnonymous)return new xk({user:t.currentUser,providerId:null,operationType:"signIn"});let r=await x_(t,{returnSecureToken:!0}),n=await xk._fromIdTokenResponse(t,"signIn",r,!0);return await t._updateCurrentUser(n.user),n}class xD extends oN{constructor(e,t,r,n){super(t.code,t.message),this.operationType=r,this.user=n,Object.setPrototypeOf(this,xD.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,n){return new xD(e,t,r,n)}}function xN(e,t,r,n){return("reauthenticate"===t?r._getReauthenticationResolver(e):r._getIdTokenResponse(e)).catch(r=>{if("auth/multi-factor-auth-required"===r.code)throw xD._fromErrorAndOperation(e,r,t,n);throw r})}async function xP(e,t,r=!1){let n=await bS(e,t._linkToIdToken(e.auth,await e.getIdToken()),r);return xk._forOperation(e,"link",n)}async function xR(e,t,r=!1){let{auth:n}=e;if(lv(n.app))return Promise.reject(w4(n));let i="reauthenticate";try{let s=await bS(e,xN(n,i,t,e),r);w7(s.idToken,n,"internal-error");let a=bT(s.idToken);w7(a,n,"internal-error");let{sub:o}=a;return w7(e.uid===o,n,"user-mismatch"),xk._forOperation(e,i,s)}catch(e){throw e?.code==="auth/user-not-found"&&w5(n,"user-mismatch"),e}}async function xM(e,t,r=!1){if(lv(e.app))return Promise.reject(w4(e));let n="signIn",i=await xN(e,n,t),s=await xk._fromIdTokenResponse(e,n,i);return r||await e._updateCurrentUser(s.user),s}class xO{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?xL._fromServerResponse(e,t):"totpInfo"in t?xV._fromServerResponse(e,t):w5(e,"internal-error")}}class xL extends xO{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new xL(t)}}class xV extends xO{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new xV(t)}}function xF(e,t){return bu(e,"POST","/v2/accounts/mfaEnrollment:start",bl(e,t))}new WeakMap;let xj="__sak";class xU{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{if(!this.storage)return Promise.resolve(!1);return this.storage.setItem(xj,"1"),this.storage.removeItem(xj),Promise.resolve(!0)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class xB extends xU{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=bJ(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(let t of Object.keys(this.listeners)){let r=this.storage.getItem(t),n=this.localCache[t];r!==n&&e(t,n,r)}}onStorageEvent(e,t=!1){let r;if(!e.key)return void this.forAllChangedKeys((e,t,r)=>{this.notifyListeners(e,r)});let n=e.key;t?this.detachListener():this.stopPolling();let i=()=>{let e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},s=this.storage.getItem(n);((r=oI()).indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0)&&10===document.documentMode&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,10):i()}notifyListeners(e,t){this.localCache[e]=t;let r=this.listeners[e];if(r)for(let e of Array.from(r))e(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){let t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}xB.type="LOCAL";class xz extends xU{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}xz.type="SESSION";class xq{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){let t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;let r=new xq(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){let{eventId:t,eventType:r,data:n}=e.data,i=this.handlersMap[r];if(!i?.size)return;e.ports[0].postMessage({status:"ack",eventId:t,eventType:r});let s=Array.from(i).map(async t=>t(e.origin,n)),a=await Promise.all(s.map(async e=>{try{let t=await e;return{fulfilled:!0,value:t}}catch(e){return{fulfilled:!1,reason:e}}}));e.ports[0].postMessage({status:"done",eventId:t,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function x$(e="",t=10){let r="";for(let e=0;e<t;e++)r+=Math.floor(10*Math.random());return e+r}xq.receivers=[];class xG{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){let n,i,s="u">typeof MessageChannel?new MessageChannel:null;if(!s)throw Error("connection_unavailable");return new Promise((a,o)=>{let l=x$("",20);s.port1.start();let u=setTimeout(()=>{o(Error("unsupported_event"))},r);i={messageChannel:s,onMessage(e){if(e.data.eventId===l)switch(e.data.status){case"ack":clearTimeout(u),n=setTimeout(()=>{o(Error("timeout"))},3e3);break;case"done":clearTimeout(n),a(e.data.response);break;default:clearTimeout(u),clearTimeout(n),o(Error("invalid_response"))}}},this.handlers.add(i),s.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[s.port2])}).finally(()=>{i&&this.removeMessageHandler(i)})}}function xK(){return window}function xH(){return void 0!==xK().WorkerGlobalScope&&"function"==typeof xK().importScripts}async function xW(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}let xQ="firebaseLocalStorageDb",xJ="firebaseLocalStorage",xY="fbase_key";class xX{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function xZ(e,t){return e.transaction([xJ],t?"readwrite":"readonly").objectStore(xJ)}function x0(){let e=indexedDB.open(xQ,1);return new Promise((t,r)=>{e.addEventListener("error",()=>{r(e.error)}),e.addEventListener("upgradeneeded",()=>{let t=e.result;try{t.createObjectStore(xJ,{keyPath:xY})}catch(e){r(e)}}),e.addEventListener("success",async()=>{let r=e.result;r.objectStoreNames.contains(xJ)?t(r):(r.close(),await new xX(indexedDB.deleteDatabase(xQ)).toPromise(),t(await x0()))})})}async function x1(e,t,r){return new xX(xZ(e,!0).put({[xY]:t,value:r})).toPromise()}async function x2(e,t){let r=xZ(e,!1).get(t),n=await new xX(r).toPromise();return void 0===n?null:n.value}function x5(e,t){return new xX(xZ(e,!0).delete(t)).toPromise()}class x6{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await x0()),this.db}async _withRetries(e){let t=0;for(;;)try{let t=await this._openDb();return await e(t)}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return xH()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=xq._getInstance(xH()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await xW(),!this.activeServiceWorker)return;this.sender=new xG(this.activeServiceWorker);let e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&(navigator?.serviceWorker?.controller||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;let e=await x0();return await x1(e,xj,"1"),await x5(e,xj),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>x1(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){let t=await this._withRetries(t=>x2(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>x5(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){let e=await this._withRetries(e=>new xX(xZ(e,!1).getAll()).toPromise());if(!e||0!==this.pendingWrites)return[];let t=[],r=new Set;if(0!==e.length)for(let{fbase_key:n,value:i}of e)r.add(n),JSON.stringify(this.localCache[n])!==JSON.stringify(i)&&(this.notifyListeners(n,i),t.push(n));for(let e of Object.keys(this.localCache))this.localCache[e]&&!r.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;let r=this.listeners[e];if(r)for(let e of Array.from(r))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}function x3(e,t){return bu(e,"POST","/v2/accounts/mfaSignIn:start",bl(e,t))}x6.type="LOCAL",b6("rcb"),new br(3e4,6e4);let x4="recaptcha";async function x8(e,t,r){if(!e._getRecaptchaConfig())try{await xt(e)}catch(e){console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let n;if(n="string"==typeof t?{phoneNumber:t}:t,"session"in n){let t=n.session;if("phoneNumber"in n){w7("enroll"===t.type,e,"internal-error");let i={idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:n.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},s=async(e,t)=>{if(t.phoneEnrollmentInfo.captchaResponse===b8){w7(r?.type===x4,e,"argument-error");let n=await x7(e,t,r);return xF(e,n)}return xF(e,t)},a=xe(e,i,"mfaSmsEnrollment",s,"PHONE_PROVIDER");return(await a.catch(e=>Promise.reject(e))).phoneSessionInfo.sessionInfo}{w7("signin"===t.type,e,"internal-error");let i=n.multiFactorHint?.uid||n.multiFactorUid;w7(i,e,"missing-multi-factor-info");let s={mfaPendingCredential:t.credential,mfaEnrollmentId:i,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},a=async(e,t)=>{if(t.phoneSignInInfo.captchaResponse===b8){w7(r?.type===x4,e,"argument-error");let n=await x7(e,t,r);return x3(e,n)}return x3(e,t)},o=xe(e,s,"mfaSmsSignIn",a,"PHONE_PROVIDER");return(await o.catch(e=>Promise.reject(e))).phoneResponseInfo.sessionInfo}}{let t={phoneNumber:n.phoneNumber,clientType:"CLIENT_TYPE_WEB"},i=async(e,t)=>{if(t.captchaResponse===b8){w7(r?.type===x4,e,"argument-error");let n=await x7(e,t,r);return xd(e,n)}return xd(e,t)},s=xe(e,t,"sendVerificationCode",i,"PHONE_PROVIDER");return(await s.catch(e=>Promise.reject(e))).sessionInfo}}finally{r?._reset()}}async function x7(e,t,r){w7(r.type===x4,e,"argument-error");let n=await r.verify();w7("string"==typeof n,e,"argument-error");let i={...t};if("phoneEnrollmentInfo"in i){let e=i.phoneEnrollmentInfo.phoneNumber,t=i.phoneEnrollmentInfo.captchaResponse,r=i.phoneEnrollmentInfo.clientType,s=i.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(i,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:n,captchaResponse:t,clientType:r,recaptchaVersion:s}}),i}if(!("phoneSignInInfo"in i))return Object.assign(i,{recaptchaToken:n}),i;{let e=i.phoneSignInInfo.captchaResponse,t=i.phoneSignInInfo.clientType,r=i.phoneSignInInfo.recaptchaVersion;return Object.assign(i,{phoneSignInInfo:{recaptchaToken:n,captchaResponse:e,clientType:t,recaptchaVersion:r}}),i}}class x9{constructor(e){this.providerId=x9.PROVIDER_ID,this.auth=oz(e)}verifyPhoneNumber(e,t){return x8(this.auth,e,oz(t))}static credential(e,t){return xy._fromVerification(e,t)}static credentialFromResult(e){return x9.credentialFromTaggedObject(e)}static credentialFromError(e){return x9.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{phoneNumber:t,temporaryProof:r}=e;return t&&r?xy._fromTokenResponse(t,r):null}}x9.PROVIDER_ID="phone",x9.PHONE_SIGN_IN_METHOD="phone";class Ie extends xi{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return xh(e,this._buildIdpRequest())}_linkToIdToken(e,t){return xh(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return xh(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function It(e){return xM(e.auth,new Ie(e),e.bypassAuthState)}function Ir(e){let{auth:t,user:r}=e;return w7(r,t,"internal-error"),xR(r,new Ie(e),e.bypassAuthState)}async function In(e){let{auth:t,user:r}=e;return w7(r,t,"internal-error"),xP(r,new Ie(e),e.bypassAuthState)}class Ii{constructor(e,t,r,n,i=!1){this.auth=e,this.resolver=r,this.user=n,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}})}async onAuthEvent(e){let{urlResponse:t,sessionId:r,postBody:n,tenantId:i,error:s,type:a}=e;if(s)return void this.reject(s);let o={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:n||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(o))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return It;case"linkViaPopup":case"linkViaRedirect":return In;case"reauthViaPopup":case"reauthViaRedirect":return Ir;default:w5(this.auth,"internal-error")}}resolve(e){var t,r;t=this.pendingPromise,r="Pending promise was never set",t||w9(r),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){var t,r;t=this.pendingPromise,r="Pending promise was never set",t||w9(r),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}let Is=new br(2e3,1e4);class Ia extends Ii{constructor(e,t,r,n,i){super(e,t,n,i),this.provider=r,this.authWindow=null,this.pollId=null,Ia.currentPopupAction&&Ia.currentPopupAction.cancel(),Ia.currentPopupAction=this}async executeNotNull(){let e=await this.execute();return w7(e,this.auth,"internal-error"),e}async onExecution(){var e,t;e=1===this.filter.length,t="Popup operations only handle one event",e||w9(t);let r=x$();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],r),this.authWindow.associatedEvent=r,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(w6(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(w6(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ia.currentPopupAction=null}pollUserCancellation(){let e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(w6(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Is.get())};e()}}Ia.currentPopupAction=null;let Io=new Map;class Il extends Ii{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Io.get(this.auth._key());if(!e){try{let t=await Iu(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}Io.set(this.auth._key(),e)}return this.bypassAuthState||Io.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"===e.type)return void this.resolve(null);if(e.eventId){let t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Iu(e,t){var r;let n=bj("pendingRedirect",(r=t).config.apiKey,r.name),i=bV(e._redirectPersistence);if(!await i._isAvailable())return!1;let s=await i._get(n)==="true";return await i._remove(n),s}function Ih(e,t){Io.set(e._key(),t)}async function Ic(e,t,r=!1){if(lv(e.app))return Promise.reject(w4(e));let n=oz(e),i=t?bV(t):(w7(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver),s=new Il(n,i,r),a=await s.execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,t)),a}class Id{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Ip(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Ip(e)){let r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(w6(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(If(e))}saveEventToCache(e){this.cachedEventUids.add(If(e)),this.lastProcessedEventTime=Date.now()}}function If(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function Ip({type:e,error:t}){return"unknown"===e&&t?.code==="auth/no-auth-event"}async function Im(e,t={}){return bu(e,"GET","/v1/projects",t)}let Ig=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Iy=/^https?/;async function Iv(e){if(e.config.emulator)return;let{authorizedDomains:t}=await Im(e);for(let e of t)try{if(function(e){let t=be(),{protocol:r,hostname:n}=new URL(t);if(e.startsWith("chrome-extension://")){let i=new URL(e);return""===i.hostname&&""===n?"chrome-extension:"===r&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===r&&i.hostname===n}if(!Iy.test(r))return!1;if(Ig.test(e))return n===e;let i=e.replace(/\./g,"\\.");return RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}(e))return}catch{}w5(e,"unauthorized-domain")}let Iw=new br(3e4,6e4);function Ib(){let e=xK().___jsl;if(e?.H){for(let t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}}let Ix=null,II=new br(5e3,15e3),IT={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},IE=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);async function IS(e){let t,r,n,i,s,a=await (Ix=Ix||new Promise((t,r)=>{function n(){Ib(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Ib(),r(w6(e,"network-request-failed"))},timeout:Iw.get()})}if(xK().gapi?.iframes?.Iframe)t(gapi.iframes.getContext());else if(xK().gapi?.load)n();else{var i;let t=b6("iframefcb");return xK()[t]=()=>{gapi.load?n():r(w6(e,"network-request-failed"))},(i=`${b5.gapiScript}?onload=${t}`,b5.loadJS(i)).catch(e=>r(e))}}).catch(e=>{throw Ix=null,e})),o=xK().gapi;return w7(o,e,"internal-error"),a.open({where:document.body,url:(w7((t=e.config).authDomain,e,"auth-domain-config-required"),r=t.emulator?bn(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,n={apiKey:t.apiKey,appName:e.name,v:lE},(i=IE.get(e.config.apiHost))&&(n.eid=i),(s=e._getFrameworks()).length&&(n.fw=s.join(",")),`${r}?${oL(n).slice(1)}`),messageHandlersFilter:o.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:IT,dontclear:!0},t=>new Promise(async(r,n)=>{await t.restyle({setHideOnLeave:!1});let i=w6(e,"network-request-failed"),s=xK().setTimeout(()=>{n(i)},II.get());function a(){xK().clearTimeout(s),r(t)}t.ping(a).then(a,()=>{n(i)})}))}let I_={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Ik{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}let IC=encodeURIComponent("fac");async function IA(e,t,r,n,i,s){w7(e.config.authDomain,e,"auth-domain-config-required"),w7(e.config.apiKey,e,"invalid-api-key");let a={apiKey:e.config.apiKey,appName:e.name,authType:r,redirectUrl:n,v:lE,eventId:i};if(t instanceof xb)for(let[r,n]of(t.setDefaultLanguage(e.languageCode),a.providerId=t.providerId||"",!function(e){for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())&&(a.customParameters=JSON.stringify(t.getCustomParameters())),Object.entries(s||{})))a[r]=n;if(t instanceof xx){let e=t.getScopes().filter(e=>""!==e);e.length>0&&(a.scopes=e.join(","))}for(let t of(e.tenantId&&(a.tid=e.tenantId),Object.keys(a)))void 0===a[t]&&delete a[t];let o=await e._getAppCheckToken(),l=o?`#${IC}=${encodeURIComponent(o)}`:"";return`${function({config:e}){return e.emulator?bn(e,"emulator/auth/handler"):`https://${e.authDomain}/__/auth/handler`}(e)}?${oL(a).slice(1)}${l}`}let ID="webStorageSupport",IN=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=xz,this._completeRedirectFn=Ic,this._overrideRedirectResult=Ih}async _openPopup(e,t,r,n){var i,s;i=this.eventManagers[e._key()]?.manager,s="_initialize() not called before _openPopup()",i||w9(s);let a=await IA(e,t,r,be(),n);return function(e,t,r,n=500,i=600){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString(),o="",l={...I_,width:n.toString(),height:i.toString(),top:s,left:a},u=oI().toLowerCase();r&&(o=b$(u)?"_blank":r),bz(u)&&(t=t||"http://localhost",l.scrollbars="yes");let h=Object.entries(l).reduce((e,[t,r])=>`${e}${t}=${r},`,"");if(function(e=oI()){return bQ(e)&&!!window.navigator?.standalone}(u)&&"_self"!==o){var c,d;let e,r;return c=t||"",d=o,(e=document.createElement("a")).href=c,e.target=d,(r=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),e.dispatchEvent(r),new Ik(null)}let f=window.open(t||"",o,h);w7(f,e,"popup-blocked");try{f.focus()}catch(e){}return new Ik(f)}(e,a,x$())}async _openRedirect(e,t,r,n){var i;return await this._originValidation(e),i=await IA(e,t,r,be(),n),xK().location.href=i,new Promise(()=>{})}_initialize(e){let t=e._key();if(this.eventManagers[t]){var r;let{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(r="If manager is not set, promise should be",n||w9(r),n)}let n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){let t=await IS(e),r=new Id(e);return t.register("authEvent",t=>(w7(t?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(t.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(ID,{type:ID},r=>{let n=r?.[0]?.[ID];void 0!==n&&t(!!n),w5(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Iv(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return bJ()||bq()||bQ()}};var IP="@firebase/auth",IR="1.12.0";class IM{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return(this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser)?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(t=>{e(t?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){w7(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}let IO=om("authIdTokenMaxAge")||300,IL=null;b5={loadJS:e=>new Promise((t,r)=>{let n=document.createElement("script");n.setAttribute("src",e),n.onload=t,n.onerror=e=>{let t=w6("internal-error");t.customData=e,r(t)},n.type="text/javascript",n.charset="UTF-8",(document.getElementsByTagName("head")?.[0]??document).appendChild(n)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},f="Browser",lf(new oq("auth",(e,{options:t})=>{let r,n,i=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=i.options;w7(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});let u=new b1(i,s,a,{apiKey:o,authDomain:l,clientPlatform:f,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:bY(f)});return n=(Array.isArray(r=t?.persistence||[])?r:[r]).map(bV),t?.errorMap&&u._updateErrorMap(t.errorMap),u._initializeWithPersistence(n,t?.popupRedirectResolver),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),lf(new oq("auth-internal",e=>new IM(oz(e.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),lD(IP,IR,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(f)),lD(IP,IR,"esm2020"),e.s([],58556),e.i(58556),lD("firebase","12.8.0","app"),e.i(92953);let IV="@firebase/installations",IF="0.6.19",Ij=`w:${IF}`,IU="FIS_v2",IB=new oP("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function Iz(e){return e instanceof oN&&e.code.includes("request-failed")}function Iq({projectId:e}){return`https://firebaseinstallations.googleapis.com/v1/projects/${e}/installations`}function I$(e){return{token:e.token,requestStatus:2,expiresIn:Number(e.expiresIn.replace("s","000")),creationTime:Date.now()}}async function IG(e,t){let r=(await t.json()).error;return IB.create("request-failed",{requestName:e,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function IK({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}async function IH(e){let t=await e();return t.status>=500&&t.status<600?e():t}async function IW({appConfig:e,heartbeatServiceProvider:t},{fid:r}){let n=Iq(e),i=IK(e),s=t.getImmediate({optional:!0});if(s){let e=await s.getHeartbeatsHeader();e&&i.append("x-firebase-client",e)}let a={method:"POST",headers:i,body:JSON.stringify({fid:r,authVersion:IU,appId:e.appId,sdkVersion:Ij})},o=await IH(()=>fetch(n,a));if(o.ok){let e=await o.json();return{fid:e.fid||r,registrationStatus:2,refreshToken:e.refreshToken,authToken:I$(e.authToken)}}throw await IG("Create Installation",o)}function IQ(e){return new Promise(t=>{setTimeout(t,e)})}let IJ=/^[cdef][\w-]{21}$/;function IY(e){return`${e.appName}!${e.appId}`}let IX=new Map;function IZ(e,t){var r,n;let i,s=IY(e);I0(s,t),r=s,n=t,(i=(!I1&&"BroadcastChannel"in self&&((I1=new BroadcastChannel("[Firebase] FID Change")).onmessage=e=>{I0(e.data.key,e.data.fid)}),I1))&&i.postMessage({key:r,fid:n}),0===IX.size&&I1&&(I1.close(),I1=null)}function I0(e,t){let r=IX.get(e);if(r)for(let e of r)e(t)}let I1=null,I2="firebase-installations-store",I5=null;function I6(){return I5||(I5=o8("firebase-installations-database",1,{upgrade:(e,t)=>{0===t&&e.createObjectStore(I2)}})),I5}async function I3(e,t){let r=IY(e),n=(await I6()).transaction(I2,"readwrite"),i=n.objectStore(I2),s=await i.get(r);return await i.put(t,r),await n.done,s&&s.fid===t.fid||IZ(e,t.fid),t}async function I4(e){let t=IY(e),r=(await I6()).transaction(I2,"readwrite");await r.objectStore(I2).delete(t),await r.done}async function I8(e,t){let r=IY(e),n=(await I6()).transaction(I2,"readwrite"),i=n.objectStore(I2),s=await i.get(r),a=t(s);return void 0===a?await i.delete(r):await i.put(a,r),await n.done,a&&(!s||s.fid!==a.fid)&&IZ(e,a.fid),a}async function I7(e){let t,r=await I8(e.appConfig,r=>{let n=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(IB.create("app-offline"))};let r={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},n=I9(e,r);return{installationEntry:r,registrationPromise:n}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:Te(e)}:{installationEntry:t}}(e,Tr(r||{fid:function(){try{var e;let t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;let r=(e=t,btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_").substr(0,22));return IJ.test(r)?r:""}catch{return""}}(),registrationStatus:0}));return t=n.registrationPromise,n.installationEntry});return""===r.fid?{installationEntry:await t}:{installationEntry:r,registrationPromise:t}}async function I9(e,t){try{let r=await IW(e,t);return I3(e.appConfig,r)}catch(r){throw Iz(r)&&409===r.customData.serverCode?await I4(e.appConfig):await I3(e.appConfig,{fid:t.fid,registrationStatus:0}),r}}async function Te(e){let t=await Tt(e.appConfig);for(;1===t.registrationStatus;)await IQ(100),t=await Tt(e.appConfig);if(0===t.registrationStatus){let{installationEntry:t,registrationPromise:r}=await I7(e);return r||t}return t}function Tt(e){return I8(e,e=>{if(!e)throw IB.create("installation-not-found");return Tr(e)})}function Tr(e){var t;return 1===(t=e).registrationStatus&&t.registrationTime+1e4<Date.now()?{fid:e.fid,registrationStatus:0}:e}async function Tn({appConfig:e,heartbeatServiceProvider:t},r){let n=function(e,{fid:t}){return`${Iq(e)}/${t}/authTokens:generate`}(e,r),i=function(e,{refreshToken:t}){var r;let n=IK(e);return n.append("Authorization",(r=t,`${IU} ${r}`)),n}(e,r),s=t.getImmediate({optional:!0});if(s){let e=await s.getHeartbeatsHeader();e&&i.append("x-firebase-client",e)}let a={method:"POST",headers:i,body:JSON.stringify({installation:{sdkVersion:Ij,appId:e.appId}})},o=await IH(()=>fetch(n,a));if(o.ok)return I$(await o.json());throw await IG("Generate Auth Token",o)}async function Ti(e,t=!1){let r,n=await I8(e.appConfig,n=>{var i,s,a;let o;if(!Tl(n))throw IB.create("not-registered");let l=n.authToken;if(!t&&2===(i=l).requestStatus&&(s=i,!((o=Date.now())<s.creationTime)&&!(s.creationTime+s.expiresIn<o+36e5)))return n;if(1===l.requestStatus)return r=Ts(e,t),n;{let t;if(!navigator.onLine)throw IB.create("app-offline");let i=(a=n,t={requestStatus:1,requestTime:Date.now()},{...a,authToken:t});return r=To(e,i),i}});return r?await r:n.authToken}async function Ts(e,t){let r=await Ta(e.appConfig);for(;1===r.authToken.requestStatus;)await IQ(100),r=await Ta(e.appConfig);let n=r.authToken;return 0===n.requestStatus?Ti(e,t):n}function Ta(e){return I8(e,e=>{var t;if(!Tl(e))throw IB.create("not-registered");return 1===(t=e.authToken).requestStatus&&t.requestTime+1e4<Date.now()?{...e,authToken:{requestStatus:0}}:e})}async function To(e,t){try{let r=await Tn(e,t),n={...t,authToken:r};return await I3(e.appConfig,n),r}catch(r){if(Iz(r)&&(401===r.customData.serverCode||404===r.customData.serverCode))await I4(e.appConfig);else{let r={...t,authToken:{requestStatus:0}};await I3(e.appConfig,r)}throw r}}function Tl(e){return void 0!==e&&2===e.registrationStatus}async function Tu(e){let{installationEntry:t,registrationPromise:r}=await I7(e);return r?r.catch(console.error):Ti(e).catch(console.error),t.fid}async function Th(e,t=!1){return await Tc(e),(await Ti(e,t)).token}async function Tc(e){let{registrationPromise:t}=await I7(e);t&&await t}function Td(e){return IB.create("missing-app-config-values",{valueName:e})}let Tf="installations";lf(new oq(Tf,e=>{let t=e.getProvider("app").getImmediate(),r=function(e){if(!e||!e.options)throw Td("App Configuration");if(!e.name)throw Td("App Name");for(let t of["projectId","apiKey","appId"])if(!e.options[t])throw Td(t);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t),n=lp(t,"heartbeat");return{app:t,appConfig:r,heartbeatServiceProvider:n,_delete:()=>Promise.resolve()}},"PUBLIC")),lf(new oq("installations-internal",e=>{let t=lp(e.getProvider("app").getImmediate(),Tf).getImmediate();return{getId:()=>Tu(t),getToken:e=>Th(t,e)}},"PRIVATE")),lD(IV,IF),lD(IV,IF,"esm2020");let Tp="analytics",Tm="https://www.googletagmanager.com/gtag/js",Tg=new oX("@firebase/analytics"),Ty=new oP("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function Tv(e){if(!e.startsWith(Tm)){let t=Ty.create("invalid-gtag-resource",{gtagURL:e});return Tg.warn(t.message),""}return e}function Tw(e){return Promise.all(e.map(e=>e.catch(e=>e)))}async function Tb(e,t,r,n,i,s){let a=n[i];try{if(a)await t[a];else{let e=(await Tw(r)).find(e=>e.measurementId===i);e&&await t[e.appId]}}catch(e){Tg.error(e)}e("config",i,s)}async function Tx(e,t,r,n,i){try{let s=[];if(i&&i.send_to){let e=i.send_to;Array.isArray(e)||(e=[e]);let n=await Tw(r);for(let r of e){let e=n.find(e=>e.measurementId===r),i=e&&t[e.appId];if(i)s.push(i);else{s=[];break}}}0===s.length&&(s=Object.values(t)),await Promise.all(s),e("event",n,i||{})}catch(e){Tg.error(e)}}let TI=new class{constructor(e={},t=1e3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};async function TT(e){let{appId:t,apiKey:r}=e,n={method:"GET",headers:new Headers({Accept:"application/json","x-goog-api-key":r})},i="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",t),s=await fetch(i,n);if(200!==s.status&&304!==s.status){let e="";try{let t=await s.json();t.error?.message&&(e=t.error.message)}catch(e){}throw Ty.create("config-fetch-failed",{httpStatus:s.status,responseMessage:e})}return s.json()}async function TE(e,t=TI,r){let{appId:n,apiKey:i,measurementId:s}=e.options;if(!n)throw Ty.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:n};throw Ty.create("no-api-key")}let a=t.getThrottleMetadata(n)||{backoffCount:0,throttleEndTimeMillis:Date.now()},o=new T_;return setTimeout(async()=>{o.abort()},void 0!==r?r:6e4),TS({appId:n,apiKey:i,measurementId:s},a,o,t)}async function TS(e,{throttleEndTimeMillis:t,backoffCount:r},n,i=TI){let{appId:s,measurementId:a}=e;try{var o,l;await (o=n,l=t,new Promise((e,t)=>{let r=setTimeout(e,Math.max(l-Date.now(),0));o.addEventListener(()=>{clearTimeout(r),t(Ty.create("fetch-throttle",{throttleEndTimeMillis:l}))})}))}catch(e){if(a)return Tg.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${e?.message}]`),{appId:s,measurementId:a};throw e}try{let t=await TT(e);return i.deleteThrottleMetadata(s),t}catch(l){if(!function(e){if(!(e instanceof oN)||!e.customData)return!1;let t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(l)){if(i.deleteThrottleMetadata(s),a)return Tg.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${l?.message}]`),{appId:s,measurementId:a};throw l}let t=503===Number(l?.customData?.httpStatus)?oB(r,i.intervalMillis,30):oB(r,i.intervalMillis),o={throttleEndTimeMillis:Date.now()+t,backoffCount:r+1};return i.setThrottleMetadata(s,o),Tg.debug(`Calling attemptFetch again in ${t} millis`),TS(e,o,n,i)}}class T_{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function Tk(e,t,r,n,i){if(i&&i.global)return void e("event",r,n);{let i=await t;e("event",r,{...n,send_to:i})}}async function TC(e,t,r,n){if(n&&n.global){let t={};for(let e of Object.keys(r))t[`user_properties.${e}`]=r[e];return e("set",t),Promise.resolve()}e("config",await t,{update:!0,user_properties:r})}async function TA(){if(!oC())return Tg.warn(Ty.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await oA()}catch(e){return Tg.warn(Ty.create("indexeddb-unavailable",{errorInfo:e?.toString()}).message),!1}return!0}async function TD(e,t,r,n,a,o,l){var u,h;let c,d,f,p,m=TE(e);m.then(t=>{r[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&Tg.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${t.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(e=>Tg.error(e)),t.push(m);let g=TA().then(e=>e?n.getId():void 0),[y,v]=await Promise.all([m,g]);!function(e){for(let t of Object.values(window.document.getElementsByTagName("script")))if(t.src&&t.src.includes(Tm)&&t.src.includes(e))return t;return null}(o)&&(u=y.measurementId,h={createScriptURL:Tv},window.trustedTypes&&(c=window.trustedTypes.createPolicy("firebase-js-sdk-policy",h)),d=c,f=document.createElement("script"),p=`${Tm}?l=${o}&id=${u}`,f.src=d?d?.createScriptURL(p):p,f.async=!0,document.head.appendChild(f)),s&&(a("consent","default",s),s=void 0),a("js",new Date);let w=l?.config??{};return w.origin="firebase",w.update=!0,null!=v&&(w.firebase_id=v),a("config",y.measurementId,w),i&&(a("set",i),i=void 0),y.measurementId}class TN{constructor(e){this.app=e}_delete(){return delete TP[this.app.options.appId],Promise.resolve()}}let TP={},TR=[],TM={},TO="dataLayer",TL=!1;async function TV(){if(oS()||!oD()||!oC())return!1;try{return await oA()}catch(e){return!1}}let TF="@firebase/analytics",Tj="0.10.19";lf(new oq(Tp,(e,{options:t})=>(function(e,t,r){let n=[];if(oS()&&n.push("This is a browser extension environment."),oD()||n.push("Cookies are not available."),n.length>0){let e=n.map((e,t)=>`(${t+1}) ${e}`).join(" "),t=Ty.create("invalid-analytics-context",{errorInfo:e});Tg.warn(t.message)}let i=e.options.appId;if(!i)throw Ty.create("no-app-id");if(!e.options.apiKey)if(e.options.measurementId)Tg.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Ty.create("no-api-key");if(null!=TP[i])throw Ty.create("already-exists",{id:i});if(!TL){var s,l;let e,t;e=[],Array.isArray(window[TO])?e=window[TO]:window[TO]=e;let{wrappedGtag:r,gtagCore:n}=(s="gtag",t=function(){window[TO].push(arguments)},window[s]&&"function"==typeof window[s]&&(t=window[s]),window[s]=(l=t,async function(e,...t){try{if("event"===e){let[e,r]=t;await Tx(l,TP,TR,e,r)}else if("config"===e){let[e,r]=t;await Tb(l,TP,TR,TM,e,r)}else if("consent"===e){let[e,r]=t;l("consent",e,r)}else if("get"===e){let[e,r,n]=t;l("get",e,r,n)}else if("set"===e){let[e]=t;l("set",e)}else l(e,...t)}catch(e){Tg.error(e)}}),{gtagCore:t,wrappedGtag:window[s]});o=r,a=n,TL=!0}return TP[i]=TD(e,TR,TM,t,a,TO,r),new TN(e)})(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),t),"PUBLIC")),lf(new oq("analytics-internal",function(e){try{let t=e.getProvider(Tp).getImmediate();return{logEvent:(e,r,n)=>{var i;return i=t,void(i=oz(i),Tk(o,TP[i.app.options.appId],e,r,n).catch(e=>Tg.error(e)))},setUserProperties:(e,r)=>{var n;return n=t,void(n=oz(n),TC(o,TP[n.app.options.appId],e,r).catch(e=>Tg.error(e)))}}}catch(e){throw Ty.create("interop-component-reg-failed",{reason:e})}},"PRIVATE")),lD(TF,Tj),lD(TF,Tj,"esm2020");let TU=lC().length>0?lk():lS({apiKey:"AIzaSyA6d4LG_HVGFgJ5NkTiBnayGoz7UvUy-Ow",authDomain:"secret-talk-9745f.firebaseapp.com",projectId:"secret-talk-9745f",storageBucket:"secret-talk-9745f.firebasestorage.app",messagingSenderId:"744311589927",appId:"1:744311589927:web:39d8cbb79f7106b6a29202",measurementId:"G-1X4P0KFHXC"}),TB=function(e,t){let r=lp("object"==typeof e?e:lk(),"firestore").getImmediate({identifier:"string"==typeof e?e:cp});if(!r._initialized){let e=(e=>{let t=of(e);if(!t)return;let r=t.lastIndexOf(":");if(r<=0||r+1===t.length)throw Error(`Invalid host ${t} with no separate hostname and port!`);let n=parseInt(t.substring(r+1),10);return"["===t[0]?[t.substring(1,r-1),n]:[t.substring(0,r),n]})("firestore");e&&function(e,t,r,n={}){e=uI(e,yB);let i=oy(t),s=e._getSettings(),a={...s,emulatorOptions:e._getEmulatorOptions()},o=`${t}:${r}`;i&&(ov(`https://${o}`),ox("Firestore",!0)),s.host!==yj&&s.host!==o&&l0("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let l={...s,host:o,ssl:i,emulatorOptions:n};if(!oM(l,a)&&(e._setSettings(l),n.mockUserToken)){let t,r;if("string"==typeof n.mockUserToken)t=n.mockUserToken,r=lW.MOCK_USER;else{t=function(e,t){if(e.uid)throw Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let r=t||"demo-project",n=e.iat||0,i=e.sub||e.user_id;if(!i)throw Error("mockUserToken must contain 'sub' or 'user_id' field!");let s={iss:`https://securetoken.google.com/${r}`,aud:r,iat:n,exp:n+3600,auth_time:n,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...e};return[ou(JSON.stringify({alg:"none",type:"JWT"})),ou(JSON.stringify(s)),""].join(".")}(n.mockUserToken,e._app?.options.projectId);let i=n.mockUserToken.sub||n.mockUserToken.user_id;if(!i)throw new l4(l3.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");r=new lW(i)}e._authCredentials=new ue(new l7(t,r))}}(r,...e)}return r}(TU),Tz=function(e=lk()){let t=lp(e,"auth");if(t.isInitialized())return t.getImmediate();let r=function(e,t){let r=lp(e,"auth");if(r.isInitialized()){let e=r.getImmediate();if(oM(r.getOptions(),t??{}))return e;w5(e,"already-initialized")}return r.initialize({options:t})}(e,{popupRedirectResolver:IN,persistence:[x6,xB,xz]}),n=om("authTokenSyncURL");if(n&&"boolean"==typeof isSecureContext&&isSecureContext){let e=new URL(n,location.origin);if(location.origin===e.origin){let t,n=(t=e.toString(),async e=>{let r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>IO)return;let i=r?.token;IL!==i&&(IL=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});oz(r).beforeAuthStateChanged(n,()=>n(r.currentUser)),oz(r).onIdTokenChanged(e=>n(e),void 0,void 0)}}let i=of("auth");return i&&function(e,t,r){let n=oz(e);w7(/^https?:\/\//.test(t),n,"invalid-emulator-scheme");let i=xr(t),{host:s,port:a}=function(e){let t=xr(e),r=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!r)return{host:"",port:null};let n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){let e=i[1];return{host:e,port:xn(n.substr(e.length+1))}}{let[e,t]=n.split(":");return{host:e,port:xn(t)}}}(t),o=null===a?"":`:${a}`,l={url:`${i}//${s}${o}/`},u=Object.freeze({host:s,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:!1})});if(!n._canInitEmulator){w7(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),w7(oM(l,n.config.emulator)&&oM(u,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=l,n.emulatorConfig=u,n.settings.appVerificationDisabledForTesting=!0,oy(s)?(ov(`${i}//${s}${o}`),ox("Auth",!0)):function(){function e(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"u">typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"u">typeof window&&"u">typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}(r,`http://${i}`),r}(TU);async function Tq(e,t){let r=new TextEncoder().encode(e+t);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",r))).map(e=>e.toString(16).padStart(2,"0")).join("")}async function T$(e,t,r){await xA(Tz);let n=Tz.currentUser;if(!n)throw Error("Auth failed");let i=Math.random().toString(36).substr(2,8).toUpperCase(),s=Math.random().toString(36).substr(2,8),a=await Tq(r,s),o=Date.now()+60*t*6e4,l={id:i,name:e||i,createdAt:vx(),expiresAt:u_.fromMillis(o),passwordHash:a,salt:s,status:"active",creatorId:n.uid,extendCount:0};return await wN(yK(TB,"rooms",i),l),{roomId:i,expiresAt:o}}async function TG(e,t){await xA(Tz);let r=await wS(yK(TB,"rooms",e));if(!r.exists())throw Error("   .");let n=r.data();if(await Tq(t,n.salt)!==n.passwordHash)throw Error("  .");if("expired"===n.status||n.expiresAt.toMillis()<Date.now())throw Error("  .");return{id:e,name:n.name,expiresAt:n.expiresAt.toMillis()}}async function TK(e,t,r){let n=Tz.currentUser;if(!n)throw Error("Not authenticated");await wM(yG(TB,"rooms",e,"messages"),{text:t,senderId:n.uid,nickname:r,createdAt:vx()})}async function TH(e){let t=yK(TB,"rooms",e),r=await wS(t);if(!r.exists())return;let n=r.data().expiresAt.toMillis();await wP(t,{expiresAt:u_.fromMillis(n+144e5),extendCount:new va("increment",1),lastExtendedAt:vx()})}function TW(){let[e,t]=(0,D.useState)("HOME"),[r,n]=(0,D.useState)(null),[i,s]=(0,D.useState)([]),[a,o]=(0,D.useState)(!1),[l,u]=(0,D.useState)(null),[h,c]=(0,D.useState)({id:"",nickname:""});(0,D.useEffect)(()=>{let e=localStorage.getItem("chat-nickname"),t=e||" "+Math.floor(1e4*Math.random()).toString().padStart(4,"0");e||localStorage.setItem("chat-nickname",t),c(e=>({...e,nickname:t}))},[]),(0,D.useEffect)(()=>{if("CHAT"===e&&r?.id){var t,n;let e=(t=r.id,n=e=>{s(e)},wO(vP(yG(TB,"rooms",t,"messages"),vj("createdAt","asc")),e=>{n(e.docs.map(e=>({id:e.id,...e.data(),createdAt:e.data().createdAt?.toMillis()||Date.now()})))}));return()=>e()}},[e,r?.id]);let d=async e=>{o(!0),u(null);try{let{roomId:r,expiresAt:i}=await T$(e.name,e.expiresHours,e.password);n({id:r,name:e.name||r,expiresAt:i}),t("CHAT")}catch(e){console.error(e),u("  . (Firebase   )"),alert("  : "+e.message)}finally{o(!1)}},f=async(e,r)=>{o(!0),u(null);try{let i=await TG(e,r);n(i),t("CHAT")}catch(e){console.error(e),alert(" : "+e.message)}finally{o(!1)}},p=async e=>{if(r)try{await TK(r.id,e,h.nickname)}catch(e){console.error(e)}},m=async()=>{if(r)try{await TH(r.id),n(e=>({...e,expiresAt:e.expiresAt+144e5}))}catch(e){console.error(e)}};return(0,A.jsxs)("main",{className:"min-h-screen bg-[#0a0a0a] text-white flex flex-col items-center justify-center p-4 md:p-8",children:[a&&(0,A.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center",children:(0,A.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}),(0,A.jsx)("div",{className:"w-full max-w-5xl",children:(0,A.jsxs)(Q,{mode:"wait",children:["HOME"===e&&(0,A.jsx)(s1,{onCreateClick:()=>t("CREATE"),onJoinClick:()=>t("JOIN")},"home"),"CREATE"===e&&(0,A.jsx)(a5,{onBack:()=>t("HOME"),onCreate:d},"create"),"JOIN"===e&&(0,A.jsx)(a3,{onBack:()=>t("HOME"),onJoin:f},"join"),"CHAT"===e&&r&&(0,A.jsx)(sK.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"w-full",children:(0,A.jsx)(or,{room:r,messages:i,currentUser:h,onSendMessage:p,onExtend:m,onLeave:()=>{confirm(" ?")&&(t("HOME"),n(null),s([]))}})},"chat")]})}),(0,A.jsxs)("footer",{className:"mt-12 text-gray-600 text-sm flex flex-col items-center space-y-2",children:[(0,A.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,A.jsx)("span",{children:"  "}),(0,A.jsx)("span",{children:""}),(0,A.jsx)("span",{children:"   "}),(0,A.jsx)("span",{children:""}),(0,A.jsx)("span",{children:"  "})]}),(0,A.jsx)("p",{children:" 2026 Anonymous Secret Chat. All rights reserved."})]})]})}TV().then(e=>{e&&function(e=lk()){let t=lp(e=oz(e),Tp);t.isInitialized()?t.getImmediate():function(e,t={}){let r=lp(e,Tp);if(r.isInitialized()){if(r.getImmediate(),oM(t,r.getOptions()))return;throw Ty.create("already-initialized")}r.initialize({options:t})}(e)}(TU)}),e.s(["default",()=>TW],52683)}]);